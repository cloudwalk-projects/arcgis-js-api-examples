//>>built
define(["./kernel","../has","./lang"],function(x,u,v){function q(e,c){throw Error("declare"+(c?" "+c:"")+": "+e);}function C(e,c){for(var a=[],b=[{cls:0,refs:[]}],d={},g=1,k=e.length,h=0,f,l,m,n,p;h<k;++h){(f=e[h])?"[object Function]"!=s.call(f)&&q("mixin #"+h+" is not a callable constructor.",c):q("mixin #"+h+" is unknown. Did you use dojo.require to pull it in?",c);l=f._meta?f._meta.bases:[f];m=0;for(f=l.length-1;0<=f;--f)n=l[f].prototype,n.hasOwnProperty("declaredClass")||(n.declaredClass="uniqName_"+
D++),n=n.declaredClass,d.hasOwnProperty(n)||(d[n]={count:0,refs:[],cls:l[f]},++g),n=d[n],m&&m!==n&&(n.refs.push(m),++m.count),m=n;++m.count;b[0].refs.push(m)}for(;b.length;){m=b.pop();a.push(m.cls);for(--g;p=m.refs,1==p.length;){m=p[0];if(!m||--m.count){m=0;break}a.push(m.cls);--g}if(m){h=0;for(k=p.length;h<k;++h)m=p[h],--m.count||b.push(m)}}g&&q("can't build consistent linearization",c);f=e[0];a[0]=f?f._meta&&f===a[a.length-f._meta.bases.length]?f._meta.bases.length:1:0;return a}function A(e,c,a){var b,
d,g,k,h,f,l,m=this._inherited=this._inherited||{};"string"==typeof e&&(b=e,e=c,c=a);a=0;k=e.callee;(b=b||k.nom)||q("can't deduce a name to call inherited()",this.declaredClass);h=this.constructor._meta;g=h.bases;l=m.p;if(b!=p){if(m.c!==k&&(l=0,f=g[0],h=f._meta,h.hidden[b]!==k)){(d=h.chains)&&"string"==typeof d[b]&&q("calling chained method with inherited: "+b,this.declaredClass);do if(h=f._meta,d=f.prototype,h&&(d[b]===k&&d.hasOwnProperty(b)||h.hidden[b]===k))break;while(f=g[++l]);l=f?l:-1}if(f=g[++l])if(d=
f.prototype,f._meta&&d.hasOwnProperty(b))a=d[b];else{k=r[b];do if(d=f.prototype,(a=d[b])&&(f._meta?d.hasOwnProperty(b):a!==k))break;while(f=g[++l])}a=f&&a||r[b]}else{if(m.c!==k&&(l=0,(h=g[0]._meta)&&h.ctor!==k)){d=h.chains;for((!d||"manual"!==d.constructor)&&q("calling chained constructor with inherited",this.declaredClass);(f=g[++l])&&!((h=f._meta)&&h.ctor===k););l=f?l:-1}for(;(f=g[++l])&&!(a=(h=f._meta)?h.ctor:f););a=f&&a}m.c=a;m.p=l;if(a)return!0===c?a:a.apply(this,c||e)}function E(e,c){return"string"==
typeof e?this.__inherited(e,c,!0):this.__inherited(e,!0)}function F(e,c,a){var b=this.getInherited(e,c);if(b)return b.apply(this,a||c||e)}function G(e){for(var c=this.constructor._meta.bases,a=0,b=c.length;a<b;++a)if(c[a]===e)return!0;return this instanceof e}function H(e,c){for(var a in c)a!=p&&c.hasOwnProperty(a)&&(e[a]=c[a]);if(u("bug-for-in-skips-shadowed"))for(var b=v._extraNames,d=b.length;d;)a=b[--d],a!=p&&c.hasOwnProperty(a)&&(e[a]=c[a])}function I(e){t.safeMixin(this.prototype,e);return this}
function J(e,c){e instanceof Array||"function"==typeof e||(c=e,e=void 0);c=c||{};e=e||[];return t([this].concat(e),c)}function K(e,c){return function(){var a=arguments,b=a,d=a[0],g,k;k=e.length;var h;if(!(this instanceof a.callee))return y(a);if(c&&(d&&d.preamble||this.preamble)){h=Array(e.length);h[0]=a;for(g=0;;){if(d=a[0])(d=d.preamble)&&(a=d.apply(this,a)||a);d=e[g].prototype;(d=d.hasOwnProperty("preamble")&&d.preamble)&&(a=d.apply(this,a)||a);if(++g==k)break;h[g]=a}}for(g=k-1;0<=g;--g)d=e[g],
(d=(k=d._meta)?k.ctor:d)&&d.apply(this,h?h[g]:a);(d=this.postscript)&&d.apply(this,b)}}function L(e,c){return function(){var a=arguments,b=a,d=a[0];if(!(this instanceof a.callee))return y(a);c&&(d&&(d=d.preamble)&&(b=d.apply(this,b)||b),(d=this.preamble)&&d.apply(this,b));e&&e.apply(this,a);(d=this.postscript)&&d.apply(this,a)}}function M(e){return function(){var c=arguments,a=0,b,d;if(!(this instanceof c.callee))return y(c);for(;b=e[a];++a)if(b=(d=b._meta)?d.ctor:b){b.apply(this,c);break}(b=this.postscript)&&
b.apply(this,c)}}function N(e,c,a){return function(){var b,d,g=0,k=1;a&&(g=c.length-1,k=-1);for(;b=c[g];g+=k)d=b._meta,(b=(d?d.hidden:b.prototype)[e])&&b.apply(this,arguments)}}function B(e){w.prototype=e.prototype;e=new w;w.prototype=null;return e}function y(e){var c=e.callee,a=B(c);c.apply(a,e);return a}function t(e,c,a){"string"!=typeof e&&(a=c,c=e,e="");a=a||{};var b,d,g,k,h,f,l,m=1,n=c;"[object Array]"==s.call(c)?(f=C(c,e),g=f[0],m=f.length-g,c=f[m]):(f=[0],c?"[object Function]"==s.call(c)?(g=
c._meta,f=f.concat(g?g.bases:c)):q("base class is not a callable constructor.",e):null!==c&&q("unknown base class. Did you use dojo.require to pull it in?",e));if(c)for(d=m-1;;--d){b=B(c);if(!d)break;g=f[d];(g._meta?H:z)(b,g.prototype);k=u("csp-restrictions")?function(){}:new Function;k.superclass=c;k.prototype=b;c=b.constructor=k}else b={};t.safeMixin(b,a);g=a.constructor;g!==r.constructor&&(g.nom=p,b.constructor=g);for(d=m-1;d;--d)(g=f[d]._meta)&&g.chains&&(l=z(l||{},g.chains));b["-chains-"]&&(l=
z(l||{},b["-chains-"]));g=!l||!l.hasOwnProperty(p);f[0]=k=l&&"manual"===l.constructor?M(f):1==f.length?L(a.constructor,g):K(f,g);k._meta={bases:f,hidden:a,chains:l,parents:n,ctor:a.constructor};k.superclass=c&&c.prototype;k.extend=I;k.createSubclass=J;k.prototype=b;b.constructor=k;b.getInherited=E;b.isInstanceOf=G;b.inherited=O;b.__inherited=A;e&&(b.declaredClass=e,v.setObject(e,k));if(l)for(h in l)b[h]&&("string"==typeof l[h]&&h!=p)&&(g=b[h]=N(h,f,"after"===l[h]),g.nom=h);return k}var z=v.mixin,
r=Object.prototype,s=r.toString,w,D=0,p="constructor";w=u("csp-restrictions")?function(){}:new Function;var O=x.config.isDebug?F:A;x.safeMixin=t.safeMixin=function(e,c){var a,b;for(a in c)if(b=c[a],(b!==r[a]||!(a in r))&&a!=p)"[object Function]"==s.call(b)&&(b.nom=a),e[a]=b;if(u("bug-for-in-skips-shadowed")&&c)for(var d=v._extraNames,g=d.length;g;)if(a=d[--g],b=c[a],(b!==r[a]||!(a in r))&&a!=p)"[object Function]"==s.call(b)&&(b.nom=a),e[a]=b;return e};return x.declare=t});