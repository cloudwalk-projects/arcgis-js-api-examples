// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define("require exports ../Scheduler ../ArrayPool ../lang ./utils ./get ./wire".split(" "),function(B,h,y,m,r,k,g,s){function t(a){if(!a.removed){var b=a.callback,c=a.propertyName,d=a.oldValue,e=a.target,f=g.valueOf(e,c,!0);r.equals(d,f)||(a.oldValue=f,b.call(e,f,d,c,e))}}function u(){if(q){q=null;var a=e;l={};f={};e=v.acquire();for(var b=0;b<a.length;b++)t(a[b]);v.release(a)}}function z(a,b,c){return k.parse(a,b,c,function(a,b,c){var h=g.valueOf(a,b,!0),n,p=s.wire(a,b,function(a,b){n||(n={uid:k.uid(),
target:a,propertyName:b,oldValue:h,callback:c,removed:!1});var d=n,p=d.uid,g=k.uid(d.target),m=l[p];m?e.splice(e.indexOf(m),1):(l[p]=d,f[g]||(f[g]=w.acquire()),f[g].push(p));e.push(d);q||(q=y.schedule(u))});return{remove:k.once(function(){p.remove();n&&(n.removed=!0)})}})}function A(a,b,c){return k.parse(a,b,c,function(a,b,c){var e=g.valueOf(a,b,!0),f=!1;return s.wire(a,b,function(a,b){if(!f){f=!0;var d=g.valueOf(a,b,!0);r.equals(e,d)||c.call(a,d,e,b,a);e=g.valueOf(a,b,!0);f=!1}})})}function x(a,
b,c,d){void 0===d&&(d=!1);return d?A(a,b,c):z(a,b,c)}var v=new m,w=new m,l={},f={},e=[],q;h.dispatchTarget=function(a){var b="string"!==typeof a?k.uid(a):a;if(a=f[b]){delete f[b];for(b=0;b<a.length;b++){var c=a[b],d=l[c];delete l[c];e.splice(e.indexOf(d),1);t(d)}w.release(a)}};h.removeTarget=function(a){var b="string"!==typeof a?k.uid(a):a;if(a=f[b]){delete f[b];for(b=0;b<a.length;b++){var c=a[b],d=l[c];delete l[c];e.splice(e.indexOf(d),1)}}};h.dispatch=u;h.watch=x;Object.defineProperty(h,"__esModule",
{value:!0});h.default=x});