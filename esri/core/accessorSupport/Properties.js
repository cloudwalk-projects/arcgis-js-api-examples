// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define("require exports dojo/has ./Store ./PropertyOrigin ./extensions ../Logger".split(" "),function(f,g,n,h,e,k,l){l.getLogger("esri.core.Accessor");var m=0;f=function(){function d(a){this.host=a;this._origin=e.OriginId.USER;this.cursors={};this.ctorArgs=null;this.destroyed=!1;this.dirties={};this.initialized=!1;this.metadatas=this.host.constructor.__accessorMetadata__;this.overridden=null;this.store=new h.default;Object.defineProperty(this,"uid",{value:m++})}d.prototype.initialize=function(){this.initialized=
!0;k.instanceCreated(this.host,this.metadatas)};d.prototype.destroy=function(){this.destroyed=!0;for(var a=this.cursors,b=0,c=Object.getOwnPropertyNames(a);b<c.length;b++){var d=c[b],e=a[d];if(e){for(;0<e.length;)e.pop().propertyDestroyed(this,d);a[d]=null}}};d.prototype.clearOverride=function(a){this.isOverridden(a)&&(this.overridden[a]=!1,this.propertyInvalidated(a))};d.prototype.get=function(a){var b=this.metadatas[a];if(this.store.has(a)&&!0===!this.dirties[a])return this.store.get(a);var c=b.get;
return c?(b=c.call(this.host),this.store.set(a,b,e.OriginId.COMPUTED),this.propertyCommitted(a),b):b.value};d.prototype.originOf=function(a){var b=this.store.originOf(a);return void 0===b&&(a=this.metadatas[a])&&a.hasOwnProperty("value")?"defaults":e.idToName(b)};d.prototype.has=function(a){return!this.metadatas[a]?!1:this.store.has(a)};d.prototype.internalGet=function(a){if(this.metadatas[a]){var b=this.store;return b.has(a)?b.get(a):this.metadatas[a].value}};d.prototype.internalSet=function(a,b){this.metadatas[a]&&
(this.propertyInvalidated(a),this.initialized?this.store.set(a,b,this._origin):this.store.set(a,b,e.OriginId.DEFAULTS),this.propertyCommitted(a))};d.prototype.isOverridden=function(a){return null!=this.overridden&&!0===this.overridden[a]};d.prototype.keys=function(){return this.store.keys()};d.prototype.override=function(a,b){this.metadatas[a]&&(this.overridden||(this.overridden={}),this.overridden[a]=!0,this.internalSet(a,b))};d.prototype.set=function(a,b){if(this.metadatas[a]){var c=this.metadatas[a],
d=c.set;(c=c.cast)&&(b=c.call(this.host,b));d?d.call(this.host,b):this.internalSet(a,b)}};d.prototype.setDefaultOrigin=function(a){this._origin=e.nameToId(a)};d.prototype.propertyInvalidated=function(a){var b=this.cursors[a];if(b)for(var c=0;c<b.length;c++)b[c].propertyInvalidated(this,a);this.isOverridden(a)||(this.dirties[a]=!0)};d.prototype.propertyCommitted=function(a){this.dirties[a]=!1;var b=this.cursors[a];if(b)for(var c=0;c<b.length;c++)b[c].propertyCommitted(this,a)};d.prototype.addCursor=
function(a,b){var c=this.cursors[a];c||(this.cursors[a]=c=[]);c.push(b)};d.prototype.removeCursor=function(a,b){var c=this.cursors[a];this.cursors[a]&&(c.splice(c.indexOf(b),1),0===c.length&&(this.cursors[a]=null))};return d}();Object.defineProperty(g,"__esModule",{value:!0});g.default=f});