// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define("dojo/_base/lang ../core/lang ./SpatialReference ./Geometry ./Point ./Extent ./support/coordsUtils ./support/mathUtils ./support/webMercatorUtils".split(" "),function(K,L,M,N,m,I,s,t,u){var v=function(a){return function(c,b){return null==c?b:null==b?c:a(c,b)}},p=v(Math.min),r=v(Math.max),q=N.createSubclass({declaredClass:"esri.geometry.Polygon",type:"polygon",getDefaults:function(a){return{rings:[]}},normalizeCtorArgs:function(a,c){var b=null,d,e,l=null;a&&!Array.isArray(a)?(b=a.rings?a.rings:
null,c||(a.spatialReference?c=a.spatialReference:a.rings||(c=a)),d=a.hasZ,e=a.hasM):b=a;b=b||[];c=c||M.WGS84;b.length&&(b[0]&&null!=b[0][0]&&"number"==typeof b[0][0])&&(b=[b]);if(l=b[0]&&b[0][0])void 0===d&&void 0===e?(d=2<l.length,e=!1):void 0===d?d=!e&&3<l.length:void 0===e&&(e=!d&&3<l.length);return{rings:b,spatialReference:c,hasZ:d,hasM:e}},_ring:0,properties:{cache:{dependsOn:["hasM","hasZ","rings"]},centroid:{readOnly:!0,dependsOn:["cache"],get:function(a){var c=s.centroid([],this.rings,this.hasZ);
if(isNaN(c[0])||isNaN(c[1])||this.hasZ&&isNaN(c[2]))return null;a=a||new m;a.x=c[0];a.y=c[1];a.spatialReference=this.spatialReference;this.hasZ&&(a.z=c[2]);return a}},extent:{dependsOn:["cache"],readOnly:!0,get:function(){var a=this.rings,c=a.length;if(!c||!a[0].length)return null;var b,d,e,l,g,f,h,k,n,y,q,m=g=a[0][0][0],s=f=a[0][0][1],z,t,u=this.spatialReference,E=[],A,B,C,D,w,x,F,G,H=this.hasZ,v=this.hasM,J=H?3:2;for(n=0;n<c;n++){b=a[n];A=B=b[0]&&b[0][0];C=D=b[0]&&b[0][1];q=b.length;F=G=w=x=void 0;
for(y=0;y<q;y++)d=b[y],e=d[0],l=d[1],m=p(m,e),s=p(s,l),g=r(g,e),f=r(f,l),A=p(A,e),C=p(C,l),B=r(B,e),D=r(D,l),H&&2<d.length&&(e=d[2],z=p(z,e),h=r(h,e),w=p(w,e),x=r(x,e)),v&&d.length>J&&(d=d[J],t=p(z,d),k=r(h,d),F=p(w,d),G=r(x,d));E.push(new I({xmin:A,ymin:C,zmin:w,mmin:F,xmax:B,ymax:D,zmax:x,mmax:G,spatialReference:u}))}a=new I;a.xmin=m;a.ymin=s;a.xmax=g;a.ymax=f;a.spatialReference=u;H&&(a.zmin=z,a.zmax=h);v&&(a.mmin=t,a.mmax=k);a.cache._partwise=1<E.length?E:null;return a}},isSelfIntersecting:{dependsOn:["cache"],
readOnly:!0,get:function(){var a=this.rings,c=a.length,b,d,e,l,g,f,h,k,n;for(l=0;l<c;l++){b=a[l];for(d=0;d<b.length-1;d++){f=[[b[d][0],b[d][1]],[b[d+1][0],b[d+1][1]]];for(e=l+1;e<c;e++)for(g=0;g<a[e].length-1;g++)if(h=[[a[e][g][0],a[e][g][1]],[a[e][g+1][0],a[e][g+1][1]]],(k=t._getLineIntersection2(f,h))&&!(k[0]===f[0][0]&&k[1]===f[0][1]||k[0]===h[0][0]&&k[1]===h[0][1]||k[0]===f[1][0]&&k[1]===f[1][1]||k[0]===h[1][0]&&k[1]===h[1][1]))return!0}g=b.length;if(!(4>=g))for(d=0;d<g-3;d++){n=g-1;0===d&&(n=
g-2);f=[[b[d][0],b[d][1]],[b[d+1][0],b[d+1][1]]];for(e=d+2;e<n;e++)if(h=[[b[e][0],b[e][1]],[b[e+1][0],b[e+1][1]]],(k=t._getLineIntersection2(f,h))&&!(k[0]===f[0][0]&&k[1]===f[0][1]||k[0]===h[0][0]&&k[1]===h[0][1]||k[0]===f[1][0]&&k[1]===f[1][1]||k[0]===h[1][0]&&k[1]===h[1][1]))return!0}}return!1}},rings:null},addRing:function(a){if(a){this.clearCache();var c=this.rings,b=c.length;if(Array.isArray(a[0]))c[b]=a.concat();else{var d=[];c[b]=d;c=0;for(b=a.length;c<b;c++)d[c]=a[c].toArray()}return this}},
clone:function(){var a=new q;a.spatialReference=this.spatialReference;a.rings=K.clone(this.rings);a.hasZ=this.hasZ;a.hasM=this.hasM;return a},contains:function(a){if(!a)return!1;u.canProject(a,this.spatialReference)&&(a=u.project(a,this.spatialReference));return s.contains(this.rings,s.fromGeom(a))},isClockwise:function(a){var c=0,b=0,d=0,e,l=a.length,g,f,h,k=this.hasZ,n=this.hasM;for(e=0;e<l;e++)g=a[e],f=a[(e+1)%l],Array.isArray(g)?(c+=g[0]*f[1]-f[0]*g[1],h=2,2<g.length&&(2<f.length&&k)&&(b+=g[0]*
f[2]-f[0]*g[2],h=3),g.length>h&&(f.length>h&&n)&&(d+=g[0]*f[h]-f[0]*g[h])):(c+=g.x*f.y-f.x*g.y,g.hasZ&&f.hasZ&&(b+=g.x*f.z-f.x*g.z),g.hasM&&f.hasM&&(d+=g.x*f.m-f.x*g.m));return 0>=c&&0>=b&&0>=d},getPoint:function(a,c){if(this._validateInputs(a,c)){var b=this.rings[a][c],d=this.hasZ,e=this.hasM;return d&&!e?new m(b[0],b[1],b[2],void 0,this.spatialReference):e&&d?new m(b[0],b[1],void 0,b[2],this.spatialReference):d&&e?new m(b[0],b[1],b[2],b[3],this.spatialReference):new m(b[0],b[1],this.spatialReference)}},
insertPoint:function(a,c,b){if(this._validateInputs(a)&&L.isDefined(c)&&0<=c&&c<=this.rings[a].length)return this.clearCache(),this.rings[a].splice(c,0,b),this},removePoint:function(a,c){if(this._validateInputs(a,c))return this.clearCache(),new m(this.rings[a].splice(c,1)[0],this.spatialReference)},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var c,b=a.length,d=this.spatialReference;for(c=0;c<b;c++)a[c]=new m(a[c],d);return a}},setPoint:function(a,
c,b){if(this._validateInputs(a,c))return this.clearCache(),Array.isArray(b)||(b=b.toArray()),this.rings[a][c]=b,this},toJSON:function(){var a=this.spatialReference,a={rings:this.rings,spatialReference:a&&a.toJSON()};this.hasZ&&(a.hasZ=!0);this.hasM&&(a.hasM=!0);return a},_insertPoints:function(a,c){this.clearCache();this._ring=c;this.rings[this._ring]||(this.rings[this._ring]=[]);a.forEach(this._addPoint,this)},_validateInputs:function(a,c){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||
null!==c&&void 0!==a&&(0>c||c>=this.rings[a].length)?!1:!0}});q.createEllipse=function(a){var c=a.center.x,b=a.center.y,d=a.center.z,e=a.center.m,l=a.longAxis,g=a.shortAxis,f=a.numberOfPoints;a=a.map;var h,k,n,m=[],p=2*Math.PI/f;for(k=0;k<f;k++)h=Math.cos(k*p),n=Math.sin(k*p),h=a.toMap({x:l*h+c,y:g*n+b}),null!=d&&!h.hasZ&&(h.z=d),null!=e&&!h.hasM&&(h.m=e),m.push(h);m.push(m[0]);return new q({rings:[m],spatialReference:a.spatialReference})};q.createCircle=function(a){return q.createEllipse({center:a.center,
longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};q.fromExtent=function(a){var c=a.clone().normalize();a=a.spatialReference;var b=!1,d=!1;c.map(function(a){a.hasZ&&(b=!0);a.hasM&&(d=!0)});c={rings:c.map(function(a){var c=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(b&&a.hasZ)for(var g=(a.zmax-a.zmin)/2,f=0;f<c.length;f++)c[f].push(g);if(d&&a.hasM){a=(a.mmax-a.mmin)/2;for(f=0;f<c.length;f++)c[f].push(a)}return c}),spatialReference:a?a.toJSON():
null};b&&(c.hasZ=!0);d&&(c.hasM=!0);return new q(c)};return q});