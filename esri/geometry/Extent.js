// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define("dojo/_base/lang ../core/lang ./SpatialReference ./Geometry ./Point ./support/webMercatorUtils ./support/mathUtils ./support/spatialReferenceUtils".split(" "),function(w,x,u,y,k,t,z,v){var q=y.createSubclass({declaredClass:"esri.geometry.Extent",type:"extent",normalizeCtorArgs:function(a,b,c,e,d){return this.isSR(a)?{spatialReference:a,xmin:0,ymin:0,xmax:0,ymax:0}:w.isObject(a)?(a.spatialReference=a.spatialReference||u.WGS84,a):{xmin:a,ymin:b,xmax:c,ymax:e,spatialReference:d||u.WGS84}},properties:{cache:{dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax".split(" ")},
center:{readOnly:!0,dependsOn:["cache"],get:function(a){a||(a=new k({spatialReference:this.spatialReference}));a.x=0.5*(this.xmin+this.xmax);a.y=0.5*(this.ymin+this.ymax);this.hasZ&&(a.z=0.5*(this.zmin+this.zmax));this.hasM&&(a.m=0.5*(this.mmin+this.mmax));return a}},extent:{readOnly:!0,dependsOn:["cache"],get:function(){return this.clone()}},hasM:{readOnly:!0,dependsOn:["mmin","mmax"],get:function(){return null!=this.mmin&&null!=this.mmax}},hasZ:{readOnly:!0,dependsOn:["zmin","zmax"],get:function(){return null!=
this.zmin&&null!=this.zmax}},height:{readOnly:!0,dependsOn:["ymin","ymax"],get:function(){return Math.abs(this.ymax-this.ymin)}},width:{readOnly:!0,dependsOn:["xmin","xmax"],get:function(){return Math.abs(this.xmax-this.xmin)}},xmin:0,ymin:0,mmin:void 0,zmin:void 0,xmax:0,ymax:0,mmax:void 0,zmax:void 0},centerAt:function(a){var b=this.center;return null!=a.z&&this.hasZ?this.offset(a.x-b.x,a.y-b.y,a.z-b.z):this.offset(a.x-b.x,a.y-b.y)},clone:function(){var a=new q;a.xmin=this.xmin;a.ymin=this.ymin;
a.xmax=this.xmax;a.ymax=this.ymax;a.spatialReference=this.spatialReference;null!=this.zmin&&(a.zmin=this.zmin,a.zmax=this.zmax);null!=this.mmin&&(a.mmin=this.mmin,a.mmax=this.mmax);return a},contains:function(a){if(!a)return!1;var b=a.type;if("point"===b){var c=this.spatialReference,e=a.spatialReference,b=a.x,d=a.y;a=a.z;c&&(e&&!c.equals(e)&&t.canProject(c,e))&&(c=c.isWebMercator?k.lngLatToXY(b,d):k.xyToLngLat(b,d,!0),b=c[0],d=c[1]);if(b>=this.xmin&&b<=this.xmax&&d>=this.ymin&&d<=this.ymax)return null!=
a&&this.hasZ?a>=this.zmin&&a<=this.zmax:!0}else if("extent"===b)return this._containsExtent(a);return!1},equals:function(a){if(!a)return!1;var b=this.spatialReference;if(!b.equals(a.spatialReference))if(t.canProject(a.spatialReference,b))a=t.project(a,b);else return!1;return this.xmin===a.xmin&&this.ymin===a.ymin&&this.zmin===a.zmin&&this.mmin===a.mmin&&this.xmax===a.xmax&&this.ymax===a.ymax&&this.zmax===a.zmax&&this.mmax===a.mmax},expand:function(a){a=0.5*(1-a);var b=this.width*a,c=this.height*a;
this.xmin+=b;this.ymin+=c;this.xmax-=b;this.ymax-=c;this.hasZ&&(b=(this.zmax-this.zmin)*a,this.zmin+=b,this.zmax-=b);this.hasM&&(a*=this.mmax-this.mmin,this.mmin+=a,this.mmax-=a);return this},intersects:function(a){if(!a)return!1;var b=a.type,c=this.spatialReference,e=a.spatialReference;c&&(e&&!c.equals(e)&&t.canProject(c,e))&&(a=c.isWebMercator?t.geographicToWebMercator(a):t.webMercatorToGeographic(a,!0));switch(b){case "point":return this.contains(a);case "multipoint":return this._intersectsMultipoint(a);
case "extent":return this._intersectsExtent(a);case "polygon":return this._intersectsPolygon(a);case "polyline":return this._intersectsPolyline(a)}},normalize:function(){var a=this._normalize(!1,!0);Array.isArray(a)||(a=[a]);return a},offset:function(a,b,c){this.xmin+=a;this.ymin+=b;this.xmax+=a;this.ymax+=b;null!=c&&(this.zmin+=c,this.zmax+=c);return this},shiftCentralMeridian:function(){return this._normalize(!0)},toJSON:function(){var a=this.spatialReference,a={xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,
ymax:this.ymax,spatialReference:a&&a.toJSON()};this.hasZ&&(a.zmin=this.zmin,a.zmax=this.zmax);this.hasM&&(a.mmax=this.mmax,a.mmin=this.mmin);return a},union:function(a){function b(a,b,d){return null==b?d:null==d?b:a(b,d)}this.xmin=Math.min(this.xmin,a.xmin);this.ymin=Math.min(this.ymin,a.ymin);this.xmax=Math.max(this.xmax,a.xmax);this.ymax=Math.max(this.ymax,a.ymax);if(this.hasZ||a.hasZ)this.zmin=b(Math.min,this.zmin,a.zmin),this.zmax=b(Math.max,this.zmax,a.zmax);if(this.hasM||a.hasM)this.mmin=b(Math.min,
this.mmin,a.mmin),this.mmax=b(Math.max,this.mmax,a.mmax);return this},intersection:function(a){function b(a,b,d){return null==b?d:null==d?b:a(b,d)}if(!this._intersectsExtent(a))return null;this.xmin=Math.max(this.xmin,a.xmin);this.ymin=Math.max(this.ymin,a.ymin);this.xmax=Math.min(this.xmax,a.xmax);this.ymax=Math.min(this.ymax,a.ymax);if(this.hasZ||a.hasZ)this.zmin=b(Math.max,this.zmin,a.zmin),this.zmax=b(Math.min,this.zmax,a.zmax);if(this.hasM||a.hasM)this.mmin=b(Math.max,this.mmin,a.mmin),this.mmax=
b(Math.min,this.mmax,a.mmax);return this},_containsExtent:function(a){var b=a.xmin,c=a.ymin,e=a.zmin,d=a.xmax,f=a.ymax,g=a.zmax;a=a.spatialReference;return null!=e&&this.hasZ?this.contains(new k(b,c,e,a))&&this.contains(new k(b,f,e,a))&&this.contains(new k(d,f,e,a))&&this.contains(new k(d,c,e,a))&&this.contains(new k(b,c,g,a))&&this.contains(new k(b,f,g,a))&&this.contains(new k(d,f,g,a))&&this.contains(new k(d,c,g,a)):this.contains(new k(b,c,a))&&this.contains(new k(b,f,a))&&this.contains(new k(d,
f,a))&&this.contains(new k(d,c,a))},_intersectsMultipoint:function(a){var b=a.points.length,c;for(c=0;c<b;c++)if(this.contains(a.getPoint(c)))return!0;return!1},_intersectsExtent:function(a){var b,c;c=this.hasZ&&a.hasZ;if(this.xmin<=a.xmin){if(b=a.xmin,this.xmax<b)return!1}else if(b=this.xmin,a.xmax<b)return!1;if(this.ymin<=a.ymin){if(b=a.ymin,this.ymax<b)return!1}else if(b=this.ymin,a.ymax<b)return!1;if(c&&a.hasZ)if(this.zmin<=a.zmin){if(c=a.zmin,this.zmax<c)return!1}else if(c=this.zmin,a.zmax<c)return!1;
return!0},_intersectsPolygon:function(a){var b=[this.xmin,this.ymax],c=[this.xmax,this.ymax],e=[this.xmin,this.ymin],d=[this.xmax,this.ymin],f=[b,c,e,d],b=[[e,b],[b,c],[c,d],[d,e]],e=a.rings,d=e.length,g,h=new k(0,0,this.spatialReference);g=f.length;for(c=0;c<g;c++)if(h.x=f[c][0],h.y=f[c][1],a.contains(h))return!0;for(var h={x:0,y:0,spatialReference:a.spatialReference,type:"point"},p,m,c=0;c<d;c++)if(f=e[c],g=f.length){p=f[0];h.x=p[0];h.y=p[1];if(this.contains(h))return!0;for(a=1;a<g;a++){m=f[a];
h.x=m[0];h.y=m[1];if(this.contains(h)||this._intersectsLine([p,m],b))return!0;p=m}}return!1},_intersectsPolyline:function(a){var b=[[[this.xmin,this.ymin],[this.xmin,this.ymax]],[[this.xmin,this.ymax],[this.xmax,this.ymax]],[[this.xmax,this.ymax],[this.xmax,this.ymin]],[[this.xmax,this.ymin],[this.xmin,this.ymin]]],c,e=a.paths,d=e.length,f,g,h,p,m={x:0,y:0,spatialReference:a.spatialReference,type:"point"};for(a=0;a<d;a++)if(f=e[a],g=f.length){h=f[0];m.x=h[0];m.y=h[1];if(this.contains(m))return!0;
for(c=1;c<g;c++){p=f[c];m.x=p[0];m.y=p[1];if(this.contains(m)||this._intersectsLine([h,p],b))return!0;h=p}}return!1},_intersectsLine:function(a,b){var c=z._getLineIntersection2,e,d=b.length;for(e=0;e<d;e++)if(c(a,b[e]))return!0;return!1},_shiftCM:function(a){var b=this.spatialReference;if(a=a||v.getInfo(b)){var c=this._getCM(a);if(c){var e=b.isWebMercator?t.webMercatorToGeographic(c):c;this.xmin-=c.x;this.xmax-=c.x;b.isWebMercator||(e.x=this._normalizeX(e.x,a).x);this.spatialReference=new u(x.substitute({Central_Meridian:e.x},
4326===b.wkid?a.altTemplate:a.wkTemplate))}}return this},_getCM:function(a){var b,c=a.valid[0];a=a.valid[1];var e=this.xmin,d=this.xmax;if(!(e>=c&&e<=a)||!(d>=c&&d<=a))b=this.center;return b},_normalize:function(a,b,c){var e=this.spatialReference;if(e&&(c=c||v.getInfo(e))){var d=this._getParts(c).map(function(a){return a.extent});if(2<d.length)return a?this._shiftCM(c):this.set({xmin:c.valid[0],xmax:c.valid[1]});if(2===d.length){if(a)return this._shiftCM(c);if(b)return d;var f=!0,g=!0;d.map(function(a){a.hasZ||
(f=!1);a.hasM||(g=!1)});return{rings:d.map(function(a){var b=[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]];if(f)for(var c=(a.zmax-a.zmin)/2,d=0;d<b.length;d++)b[d].push(c);if(g){a=(a.mmax-a.mmin)/2;for(d=0;d<b.length;d++)b[d].push(a)}return b}),hasZ:f,hasM:g,spatialReference:e}}return d[0]||this}return this},_getParts:function(a){var b=this.cache._parts;if(!b){var b=[],c=this.xmin,e=this.xmax,d=this.ymin,f=this.ymax,g=this.spatialReference,h=this.width,k=c,m=e,
n=0,l=0,r,s;a=a||v.getInfo(g);r=a.valid[0];s=a.valid[1];l=this._normalizeX(c,a);c=l.x;n=l.frameId;l=this._normalizeX(e,a);e=l.x;l=l.frameId;a=c===e&&0<h;if(h>2*s){h=new q(k<m?c:e,d,s,f,g);c=new q(r,d,k<m?e:c,f,g);s=new q(0,d,s,f,g);d=new q(r,d,0,f,g);g=[];r=[];h.contains(s)&&g.push(n);h.contains(d)&&r.push(n);c.contains(s)&&g.push(l);c.contains(d)&&r.push(l);for(f=n+1;f<l;f++)g.push(f),r.push(f);b.push({extent:h,frameIds:[n]},{extent:c,frameIds:[l]},{extent:s,frameIds:g},{extent:d,frameIds:r})}else c>
e||a?b.push({extent:new q(c,d,s,f,g),frameIds:[n]},{extent:new q(r,d,e,f,g),frameIds:[l]}):b.push({extent:new q(c,d,e,f,g),frameIds:[n]});this.cache._parts=b}l=this.hasZ;d=this.hasM;if(l||d){n={};l&&(n.zmin=this.zmin,n.zmax=this.zmax);d&&(n.mmin=this.mmin,n.mmax=this.mmax);for(l=0;l<b.length;l++)b[l].extent.set(n)}return b},_normalizeX:function(a,b){var c=0,e=b.valid[0],d=b.valid[1],f=2*d;a>d?(c=Math.ceil(Math.abs(a-d)/f),a-=c*f):a<e&&(c=Math.ceil(Math.abs(a-e)/f),a+=c*f,c=-c);return{x:a,frameId:c}}});
return q});