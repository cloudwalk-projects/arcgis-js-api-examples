// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.19/esri/copyright.txt for details.
//>>built
define("esri/urlUtils","dojo/_base/lang dojo/_base/array dojo/_base/url dojo/io-query ./kernel ./lang ./config ./sniff dojo/i18n!./nls/jsapi".split(" "),function(k,v,n,r,l,s,t,q,w){var m=function(){return this}(),b={},p=t.defaults.io,x=/^[a-z][a-z0-9\+\-\.]*:/i,u=/^\s*http:/i;b.isHTTP=function(a){var d=m.location.protocol;return null==a?"http:"===d||"https:"===d:a?"https:"===d:"http:"===d};b.getProtocolForWebResource=function(a){return b.isHTTP()?m.location.protocol:a?"https:":"http:"};b.urlToObject=
function(a){var d={},c=new n(a),b=a.indexOf("?");null===c.query?d={path:a,query:null}:(d.path=a.substring(0,b),d.query=r.queryToObject(c.query));c.fragment&&(d.hash=c.fragment,null===c.query&&(d.path=d.path.substring(0,d.path.length-(c.fragment.length+1))));return d};b.getProxyUrl=function(a,d){var c=k.isString(a)?0===k.trim(a).toLowerCase().indexOf("https:"):a,e=p.proxyUrl,f,g,h=w.io.proxyNotSet;if(k.isString(a)&&(g=b.getProxyRule(a)))e=g.proxyUrl;if(!e)throw console.log(h),Error(h);c&&(!1!==d&&
0!==m.location.href.toLowerCase().indexOf("https:"))&&(c=e,0!==c.toLowerCase().indexOf("http")&&(c=b.getAbsoluteUrl(c)),c=c.replace(/^http:/i,"https:"),b.canUseXhr(c)&&(e=c,f=1));e=b.urlToObject(e);e._xo=f;return e};b.addProxy=function(a){var d=b.getProxyRule(a),c;d?c=b.urlToObject(d.proxyUrl):p.alwaysUseProxy&&(c=b.getProxyUrl());c&&(d=b.urlToObject(a),a=c.path+"?"+d.path,(c=r.objectToQuery(k.mixin(c.query||{},d.query)))&&(a+="?"+c));return a};b.addProxyRule=function(a){var d=a.urlPrefix=b.urlToObject(a.urlPrefix).path.replace(/([^\/])$/,
"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),c=p.proxyRules,e,f=c.length,g,h=f;for(e=0;e<f;e++)if(g=c[e].urlPrefix,0===d.indexOf(g)){if(d.length===g)return-1;h=e;break}else 0===g.indexOf(d)&&(h=e+1);c.splice(h,0,a);return h};b.getProxyRule=function(a){var d=p.proxyRules,c=d.length,e=b.urlToObject(a).path.replace(/([^\/])$/,"$1/").replace(/^https?:\/\//ig,"").toLowerCase(),f;for(a=0;a<c;a++)if(0===e.indexOf(d[a].urlPrefix)){f=d[a];break}return f};b.hasSameOrigin=function(a,d,c){a=a.toLowerCase();
d=d.toLowerCase();var b=m.location.href.toLowerCase();a=0===a.indexOf("http")?new n(a):b=new n(b);d=0===d.indexOf("http")?new n(d):k.isString(b)?new n(b):b;return(c||a.scheme===d.scheme)&&a.host===d.host&&a.port===d.port};b.canUseXhr=function(a,d){var c=q("esri-phonegap")?!0:!1,e=b.hasSameOrigin,f=p.corsEnabledServers,g,h=-1;!c&&(q("esri-cors")&&f&&f.length)&&(c=v.some(f,function(b,d){var c=b&&"object"===typeof b?b.host:b;return c&&(g=0!==k.trim(c).toLowerCase().indexOf("http"),e(a,g?"http://"+c:
c)||g&&e(a,"https://"+c))?(h=d,!0):!1}));return d?h:c};b.getAbsoluteUrl=function(a){var d=b.getProtocolForWebResource();return k.isString(a)&&!x.test(a)?0===a.indexOf("//")?d+a:0===a.indexOf("/")?d+"//"+m.location.host+a:l._appBaseUrl+a:a};b.fixUrl=function(a){a=b.getAbsoluteUrl(a);a=b.upgradeToHTTPS(a);return a=a.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")};b.normalize=function(a){return b.fixUrl(a)};b.upgradeToHTTPS=function(a){var d=t.defaults.io.httpsDomains,c=b.isHTTP(!1),e=b.isHTTP(!0);
if(!u.test(a)||c)return a;var c=a.indexOf("/",7),c=-1===c?a:a.slice(0,c),f=!1;if(e&&m.location&&s.endsWith(c,m.location.host))f=!0;else if(d)for(e=0;e<d.length;e++)if(s.endsWith(c,d[e])){f=!0;break}f&&(a=a.replace(u,"https:"));return a};q("extend-esri")&&(k.mixin(l,b),l._getProxyUrl=b.getProxyUrl,l._getProxiedUrl=b.addProxy,l._hasSameOrigin=b.hasSameOrigin,l._canDoXOXHR=b.canUseXhr,l._getAbsoluteUrl=b.getAbsoluteUrl,l.fixUrl=b.fixUrl);return b});