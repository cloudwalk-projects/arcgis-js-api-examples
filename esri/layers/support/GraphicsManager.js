// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define(["../../core/Accessoire"],function(h){return h.createSubclass({classMetadata:{properties:{indexById:{dependsOn:["graphics","objectIdField"]}}},destroy:function(){this.removeAll()},graphics:null,objectIdField:null,indexById:null,_indexByIdGetter:function(){return this._createIndexById(this.graphics&&this.graphics.toArray(),this.objectIdField)},_oldIndex:null,beginUpdate:function(){this._oldIndex=this.indexById;this.indexById=null},add:function(a){a&&a.length&&(this.indexById=this.indexById||
{},a=this._updateAndExtractNew(a,this.indexById,this._oldIndex),this.graphics.addMany(a))},revertUpdate:function(){var a=this._extractLeftOnly(this.indexById,this._oldIndex);this.indexById=this._oldIndex;this._oldIndex=null;this.graphics.removeMany(a)},endUpdate:function(){var a=this._extractLeftOnly(this._oldIndex,this.indexById);this._oldIndex=null;this.graphics.removeMany(a)},find:function(a){return null!=a&&this.indexById&&this.indexById[a]},removeAll:function(){this.indexById=this._oldIndex=
null;this.graphics.removeAll()},_createIndexById:function(a,f){var d;if(a&&a.length&&f){var c,b,e;d={};for(c=0;b=a[c];c++)e=b.attributes&&b.attributes[f],null!=e&&(d[e]=b)}return d},_updateAndExtractNew:function(a,f,d){var c,b,e,g,k=[],h=a?a.length:0,l=this.objectIdField;for(c=0;c<h;c++)b=a[c],e=b.attributes&&b.attributes[l],null!=e?(g=d&&d[e])?(f[e]=g,g.geometry=b.geometry,g.attributes=b.attributes):(f[e]=b,k.push(b)):k.push(b);return k},_extractLeftOnly:function(a,f){var d,c,b=[];for(d in a)(c=
a[d])&&(!f||!f[d])&&b.push(c);return b}})});