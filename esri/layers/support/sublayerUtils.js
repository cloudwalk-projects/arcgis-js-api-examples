// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define(["require","exports","./layerSourceUtils"],function(m,f,k){function l(b,e){function d(a){var b=a.sublayers;c.unshift(a.id);b&&b.forEach(d)}if(!b||!b.length)return!0;var c=[];e.forEach(d);if(b.length>c.length)return!1;for(var a=0,h=c.length,g=0;g<b.length;g++){for(var f=b[g].id;a<h&&c[a]!==f;)a++;if(a>=h)return!1}return!0}f.isExportDynamic=function(b,e,d){return b.some(function(c){var a=c.source;return!(!a||a.type===k.MAPLAYER&&a.mapLayerId===c.id&&(!a.gdbVersion||a.gdbVersion===d.gdbVersion))||
null!=c.renderer||null!=c.labelingInfo||c.hasOwnProperty("opacity")&&null!=c.opacity||c.hasOwnProperty("labelsVisible")&&null!=c.labelsVisible})?!0:!l(b,e)};f.sameStructureAsService=function(b,e){return e.flatten(function(b){return(b=b.sublayers)&&b.toArray().reverse()}).toArray().reverse().every(function(d,c){var a=b[c];return a&&d.id===a.id&&(null==d.sublayers&&null==a.sublayers||null!=d.sublayers&&null!=a.sublayers&&d.sublayers.map(function(a){return a.id}).join(",")===a.sublayers.map(function(a){return a.id}).join(","))})}});