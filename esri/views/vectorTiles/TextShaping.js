// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define(["require","exports","./Placement"],function(u,v,t){return function(){function k(g,e,d,a,f,l,b,c){this._glyphItems=g;this._maxWidth=e;this._lineHeight=d;this._letterSpacing=a;this._offset=f;this._hAnchor=l;this._vAnchor=b;this._justify=c}k.prototype.getShaping=function(g,e){for(var d=this._glyphItems,a=this._letterSpacing,f=this._offset[0],l=this._offset[1],b=[],c=0,m=g.length;c<m;c++){var h=g.charCodeAt(c),r=d[h];r&&(b.push(new t.ShapedGlyph(h,f,l)),f+=r.metrics.advance+a)}if(0<b.length){r=
this._maxWidth;d=this._lineHeight;f=this._justify;m=b.length;h=l=a=0;if(0!==r)for(var n=0,k=0,c=0;c<m;c++){var p=b[c];p.x-=k;p.y=e?p.y-d*a:p.y+d*a;if(p.x>r&&0<n){for(var s=b[n+1].x,h=Math.max(s,h),q=n+1;q<=c;q++)b[q].y=e?b[q].y-d:b[q].y+d,b[q].x-=s;f&&this._applyJustification(b,l,n-1);l=n+1;n=0;k+=s;a++}32===p.glyph&&(n=c)}c=b[m-1];h=Math.max(h,c.x+this._glyphItems[c.glyph].metrics.advance);f&&this._applyJustification(b,l,m-1);m=(f-this._hAnchor)*h;c=(-this._vAnchor*(a+1)+0.5)*d;e&&a&&(c+=a*d);for(d=
0;d<b.length;d++)a=b[d],a.x+=m,a.y+=c}return b};k.prototype._applyJustification=function(g,e,d){for(var a=g[d],a=(a.x+this._glyphItems[a.glyph].metrics.advance)*this._justify;e<=d;e++)g[e].x-=a};return k}()});