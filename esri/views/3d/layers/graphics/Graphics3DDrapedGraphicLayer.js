// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../webgl-engine/Stage ../../webgl-engine/lib/Util ../../support/aaBoundingBox ../../support/aaBoundingRect".split(" "),function(h,p,q,g,l,f,m){var n=l.assert;h=function(){function b(a,c,d,b,e){this.graphics3DSymbolLayer=a;this.renderGeometries=c;this.uniqueMaterials=d;this.uniqueTextures=b;this.boundingBox=e;this.stage=null;this._visibilityFlags={};this._shown=!1}b.prototype.initialize=function(a,c){this.stage=c;if(this.uniqueMaterials)for(var d=
0;d<this.uniqueMaterials.length;d++)c.add(g.ModelContentType.MATERIAL,this.uniqueMaterials[d]);if(this.uniqueTextures)for(d=0;d<this.uniqueTextures.length;d++)c.add(g.ModelContentType.TEXTURE,this.uniqueTextures[d])};b.prototype.isDraped=function(){return!0};b.prototype.areVisibilityFlagsSet=function(a,c){for(var d=!0,b=Object.keys(this._visibilityFlags),e=0;e<b.length;e++){var f=b[e];if(f!==c){if(f===a)return this._visibilityFlags[f];d=d&&this._visibilityFlags[f]}}return d};b.prototype.setVisibilityFlag=
function(a,c){this._visibilityFlags[a]=c;return this._calcAndSetVisibility()};b.prototype._calcAndSetVisibility=function(){var a=this.areVisibilityFlagsSet();return this._shown!==a?(this._shown=a,n(!!this.stage,"Graphics3DDrapedGraphicLayer must be initialized first"),this._shown?this.stage.getTextureGraphicsRenderer().addRenderGeometries(this.renderGeometries):this.stage.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries),!0):!1};b.prototype.destroy=function(){if(this.stage){var a=
this.stage;this._shown&&a.getTextureGraphicsRenderer().removeRenderGeometries(this.renderGeometries);this._shown=!1;if(this.uniqueMaterials)for(var c=0;c<this.uniqueMaterials.length;c++)a.remove(g.ModelContentType.MATERIAL,this.uniqueMaterials[c].getId());if(this.uniqueTextures)for(c=0;c<this.uniqueTextures.length;c++)a.remove(g.ModelContentType.TEXTURE,this.uniqueTextures[c].getId());this.stage=null}};b.prototype.mustAlignToTerrain=function(){return!1};b.prototype.alignWithElevation=function(a,c){};
b.prototype.setDrawOrder=function(a,c,d){var b=this;this.uniqueMaterials&&this.uniqueMaterials.forEach(function(d){d.setRenderPriority(a);b._shown&&(c[d.getId()]=!0)})};b.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,c){return Math.max(a,c.bsRadius)},0)};b.prototype.getCenterObjectSpace=function(){return[0,0,0]};b.prototype.getProjectedBoundingBox=function(a,c){f.set(c,f.NEGATIVE_INFINITY);for(var d=0;d<this.renderGeometries.length;d++)this._getRenderGeometryProjectedBoundingRect(this.renderGeometries[d],
k,a),f.expand(c,k);return c};b.prototype._getRenderGeometryProjectedBoundingRect=function(a,c,d){if(this.boundingBox)f.set(e,this.boundingBox);else{var b=a.center;a=a.bsRadius;e[0]=b[0]-a;e[1]=b[1]-a;e[2]=b[2]-a;e[3]=b[0]+a;e[4]=b[1]+a;e[5]=b[2]+a}d(e,0,2);return f.toRect(e,c)};return b}();var k=m.create(),e=[0,0,0,0,0,0];return h});