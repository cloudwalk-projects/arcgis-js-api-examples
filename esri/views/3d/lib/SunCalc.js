// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define([],function(){function w(a){return new Date((a+0.5-s)*t)}function A(a,b){return n(d(b)*e(k)+e(b)*d(k)*d(a))}function u(a,b){var c=f*(357.5291+0.98560028*a),g=f*(1.9148*d(c)+0.02*d(2*c)+3E-4*d(3*c)),c=c+g+102.9372*f+p;b||(b={dec:0,ra:0});b.dec=A(c,0);b.ra=l(d(c)*e(k)-m(0)*d(k),e(c));return b}function v(a){var b=f*(134.963+13.064993*a),c=f*(93.272+13.22935*a);a=f*(218.316+13.176396*a)+6.289*f*d(b);c=5.128*f*d(c);b=385001-20905*e(b);return{ra:l(d(a)*e(k)-m(c)*d(k),e(a)),dec:A(a,c),dist:b}}var p=
Math.PI,d=Math.sin,e=Math.cos,m=Math.tan,n=Math.asin,l=Math.atan2,D=Math.acos,f=p/180,t=864E5,s=2440588,q=2451545,E={dec:0,ra:0},k=23.4397*f,h={POLAR_EXCEPTION:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(a,b,c,g){c=f*-c;b*=f;var h=a.valueOf()/t-0.5+s-q;a=u(h,E);c=f*(280.16+360.9856235*h)-c-a.ra;g||(g={azimuth:0,altitude:0});g.azimuth=l(d(c),e(c)*d(b)-m(a.dec)*e(b));g.altitude=n(d(b)*d(a.dec)+e(b)*e(a.dec)*e(c));return g}},x=[[-0.83,"sunrise","sunset"]];h.addTime=function(a,b,c){x.push([a,
b,c])};var B=9E-4;h.getTimes=function(a,b,c){function g(a){a=D((d(a)-d(l)*d(y))/(e(l)*e(y)));return q+(B+(a+k)/(2*p)+m)+0.0053*d(r)-0.0069*d(2*n)}var k=f*-c,l=f*b,m=Math.round(a.valueOf()/t-0.5+s-q-B-k/(2*p));a=B+(0+k)/(2*p)+m;var r=f*(357.5291+0.98560028*a);b=f*(1.9148*d(r)+0.02*d(2*r)+3E-4*d(3*r));var n=r+b+102.9372*f+p,y=A(n,0);a=q+a+0.0053*d(r)-0.0069*d(2*n);b={solarNoon:w(a),nadir:w(a-0.5),polarException:h.POLAR_EXCEPTION.NORMAL};var u,z,C,v;c=0;for(u=x.length;c<u;c+=1)z=x[c],C=g(z[0]*f),v=a-
(C-a),b[z[1]]=w(v),b[z[2]]=w(C);b.polarException=function(a){a=(d(a)-d(l)*d(y))/(e(l)*e(y));return-1>a?h.POLAR_EXCEPTION.MIDNIGHT_SUN:1<a?h.POLAR_EXCEPTION.POLAR_NIGHT:h.POLAR_EXCEPTION.NORMAL}(x[0][0]*f);return b};h.getMoonPosition=function(a,b,c){c=f*-c;b*=f;var g=a.valueOf()/t-0.5+s-q;a=v(g);c=f*(280.16+360.9856235*g)-c-a.ra;g=n(d(b)*d(a.dec)+e(b)*e(a.dec)*e(c));g+=0.017*f/m(g+10.26*f/(g+5.1*f));return{azimuth:l(d(c),e(c)*d(b)-m(a.dec)*e(b)),altitude:g,distance:a.dist}};h.getMoonFraction=function(a){var b=
a.valueOf()/t-0.5+s-q;a=u(b);b=v(b);a=D(d(a.dec)*d(b.dec)+e(a.dec)*e(b.dec)*e(a.ra-b.ra));a=l(149598E3*d(a),b.dist-149598E3*e(a));return(1+e(a))/2};return h});