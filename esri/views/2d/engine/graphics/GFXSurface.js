// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper dojo/_base/lang ../../math/mat2d ../../math/common ../../viewpointUtils ../Container ./Projector ./gfx ../cssUtils".split(" "),function(y,z,p,q,d,f,r,s,t,u,g){function l(b){return{xx:b[0],yx:b[1],xy:b[2],yy:b[3],dx:b[4],dy:b[5]}}function v(b,a,c){if(m){if(!b.attached)return null;a=m(a,c);b=b.surface.rawNode;for(c=0;c<a.length;c++){var n=a[c];if(n.ownerSVGElement===b)return n}return null}w||(a+=window.pageXOffset,c+=window.pageYOffset);
return document.elementFromPoint(a,c)}var x=l([1,0,0,1,0,0]),m=function(){if(document.elementsFromPoint)return function(b,a){return document.elementsFromPoint(b,a)};document.msElementsFromPoint&&function(b,a){return document.msElementsFromPoint(b,a)};return null}(),w=function(){var b=window.pageXOffset?window.pageXOffset+window.innerWidth-1:0,a=window.pageYOffset?window.pageYOffset+window.innerHeight-1:0;return 0===b&&0===a?!0:!document.elementFromPoint(b,a)}();return function(b){function a(){b.apply(this,
arguments);this._transform=d.create();this._projector=new t}p(a,b);a.prototype.createElement=function(){var c=document.createElement("div");c.setAttribute("class","esri-display-object");return c};a.prototype.setElement=function(c){this.surface&&(this.surface.destroy(),this.surface=null);if(this.element=c)this.surface=u.createSurface(this.element,400,400)};a.prototype.render=function(c){var a=this.element.style;if(this.visible){a.display="block";a.opacity=""+this.opacity;var h=this._transform,e=c.state;
if(c.stationary)r.getMatrix(h,e.center,e.size,e.resolution,f.toRadian(e.rotation)),this.surface.setDimensions(e.size[0],e.size[1]),this._projector.update(h,e.resolution),this.children.forEach(function(a){a.g&&a.g.setTransform(x)}),b.prototype.render.call(this,c);else{var k=d.invert(d.create(),h);d.multiply(k,e.transform,k);this.children.forEach(function(a){a.g&&a.g.setTransform(l(k))})}g.clip(a,e.clipRect);a.transform=g.cssMatrix3d(d.fromRotation(d.create(),f.toRadian(e.rotation)));this.surface.rawNode.style.transform=
g.cssMatrix(d.fromRotation(d.create(),f.toRadian(-e.rotation)))}else a.display="none"};a.prototype.hitTest=function(a,b){var d=v(this,a,b);return d&&d.gfxObject||null};a.prototype.prepareChildrenRenderParameters=function(a){return q.mixin({},a,{projector:this._projector,surface:this.surface})};a.prototype.beforeRenderChildren=function(a,b){this.surface.openBatch()};a.prototype.attachChild=function(a,b){return a.attach(b)};a.prototype.detachChild=function(a,b){return a.detach()};a.prototype.renderChild=
function(a,b){return a.render(b)};a.prototype.afterRenderChildren=function(a,b){this.surface.closeBatch()};return a}(s)});