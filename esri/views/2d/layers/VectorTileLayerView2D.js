// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/layers/support/TileInfoViewPOT":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/decorateHelper ./TileKey ./TileInfoView".split(" "),function(m,e,a,b,c,d){return function(b){function d(){b.apply(this,arguments)}a(d,b);d.prototype.getTileParentId=function(a){a=c.from(a);return 0===a.level?null:c.getId(a.level-1,a.row>>1,a.col>>1,a.world)};d.prototype.getTileIdAtParent=function(a,b){var d=c.from(b),f=this._infoByLevel[d.level];
if(a.resolution<f.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+f.resolution);if(a.resolution===f.resolution)return d.id;f=d.level-a.level;if(0>f)throw Error("Wrong way...!");return c.getId(a.level,d.row>>f,d.col>>f,d.world)};return d}(d)})},"esri/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../request ../2d/layers/support/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),
function(m,e,a,b,c,d,f,h,g,n,k,l,p,q,v,r,s){return function(){function e(a,b,c,d){void 0===d&&(d=!1);this.devicePixelRatio=c;this.allowUpdates=d;this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._ongoingRequests={};this._vectorTileLayer=a;this._requestUpdate=b}e.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=null};Object.defineProperty(e.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"glyphMosaic",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});e.prototype.start=function(){var f=this;this.stop();var g=this._vectorTileLayer.styleRepository,k=new p(g.sprite,this.devicePixelRatio);k.devicePixelRatio=devicePixelRatio;var n=k.load().then(function(){f._spriteMosaic=new l(1024,1024);f._spriteMosaic.setSpriteSource(k)}),e=new v(g.glyphs);this._glyphMosaic=new q(1024,1024,e);var r=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),
s=d.open(this,h.getAbsMid("./WorkerTileHandler",m,a)).then(function(a){f._connection=a}),t=new b(function(a){n.isFulfilled()||n.cancel();r.isFulfilled()||r.cancel();s.isFulfilled()||s.cancel()});c([n,r,s]).then(function(a){c(f._connection.broadcast("setLayers",g.styleJSON)).then(function(){t.resolve()})});return this._broadcastPromise=t.promise};e.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();this._connection&&(this._connection.close(),
this._connection=null)};e.prototype.updateTile=function(a,b){if(this.allowUpdates){if(!this._broadcastPromise.isFulfilled()||!this._connection)return f.reject(Error("no connection"));var c=Math.round(s.degToByte(b.state.rotation));if(a.rotation===c)return null;a.rotation=c;return this._connection.invoke("update",{key:a.id,rotation:c},[],{id:a.workerID}).then(function(b){a.updateSymbolData(b);return a})}};e.prototype.getVectorTileWithLRC=function(a,b,c,d){void 0===d&&(d=0);return this.getVectorTile(n.from(a,
b,c,0),{state:{rotation:d}})};e.prototype.getVectorTile=function(a,b){var c=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return f.reject(Error("no connection"));var d=this._vectorTileLayer.tileInfo,h=Math.round(b?b.state.rotation:0);if(d.lods.length<=a.level)return f.reject("Cannot create tile for the requested level");var g=this._tileIndex?this._tileIndex.dataKey(a):a;return!g?f.reject(Error("no data")):this._getTileData(this._connection,a,g,h).then(function(b){if(!b||!b.tileData)return f.reject("No data");
var k=d.size[0]*d.lods[a.level].resolution,l=d.origin,p=l.x+a.col*k+a.world*c._vectorTileLayer.fullExtent.width,n=p+k,l=l.y-a.row*k,k=l-k;c._requestUpdate();return new r(a,g,[p,l,n,k],c._vectorTileLayer.tileInfo.size[1],4096,h,b.tileData,c._vectorTileLayer.styleRepository,c._glyphMosaic,c.allowUpdates?b.workerId:-1,c._connection)})};e.prototype.fetchTileData=function(a){a=n.fromId(a);a=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);return g(a,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},
buffers:[a.data]}})};e.prototype.getSprites=function(a){return f.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})};e.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})};e.prototype.getStyleRepository=function(){return this._vectorTileLayer.styleRepository};e.prototype.getTileIndex=function(){return this._tileIndex};e.prototype._getTileData=function(a,b,c,d){var h=this,g={id:null};
if(a=this._ongoingRequests[b.id])return a;a=this._connection.invoke("getTile",{key:b.id,refKey:c.id,rotation:d,cacheTile:this.allowUpdates},[],g).then(function(a){delete h._ongoingRequests[b.id];return{tileData:a,workerId:g.id}}).otherwise(function(a){delete h._ongoingRequests[b.id];h.allowUpdates&&h._connection.invoke("destructTileData",{key:b.id},[],g);return f.reject(a)});return this._ongoingRequests[b.id]=a};e.prototype._fetchTileMap=function(a){var b=this;return!a?null:g(a,{callbackParamName:"callback",
responseType:"json"}).then(function(a){b._tileIndex=new k(a.data)})};return e}()})},"esri/core/workers":function(){define(["require","exports","./workers/workers"],function(m,e,a){for(var b in a)e.hasOwnProperty(b)||(e[b]=a[b])})},"esri/core/workers/workers":function(){define("require exports dojo/Deferred dojo/promise/all ../promiseUtils ./Connection ./JobProxy".split(" "),function(m,e,a,b,c,d,f){function h(a,c){for(var d=[],f=0,h=p.length;f<h;f++)d.push(p[f].openConnection(a,c));return b(d).then(function(a){})}
function g(a){q[a]=!0;if(!l&&q.every(function(a){return a})){for(var b in t)(a=s[b])&&t[b].resolve(a);t={};l=!0}}function n(b){var c=r++;b=new d(b,c);var f=new a;s[c]=b;l?f.resolve(b):t[c]=f;return f.promise}var k=Math.max((navigator.hardwareConcurrency||2)-1,2),l=!1,p=[],q=[],v=0,r=0,s={},t={},u=!1;e.open=function(a,b){if(!1===u){for(var d=0;d<k;++d){var l=new f(s,d,g);p.push(l);q.push(!1)}u=!0}return n(a).then(function(a){return h(b,a.id).then(function(){return a}).otherwise(function(a){return c.reject(a)})})};
e.terminate=function(){for(var a=0,b=p.length;a<b;a++)p[a].terminate();p=[];q=[];l=!1};e.closeConnection=function(a){if(a)if(s[a.id]&&delete s[a.id],l)for(var b=0,c=p.length;b<c;b++)p[b].closeConnection(a.id);else if(b=t[a.id])b.promise.cancel(),delete t[a.id]};e.invoke=function(a,b,d,f,h){var g=null;f&&(g=f.id);if(null===g&&(g=v=(v+1)%p.length,!q[g]&&!p.some(function(a,b,c){g=(g+1)%c.length;return q[g]})))return c.reject(Error("No worker available"));a=p[g].invoke(a,b,d,h);f&&(f.id=g);return a};
e.broadcast=function(a,b,c,d){for(var f=[],h=0,g=p.length;h<g;h++)q[h]&&f.push(p[h].invoke(a,b,c,d));return f}})},"esri/core/workers/Connection":function(){define(["require","exports","./workers"],function(m,e,a){return function(){function b(a,b){this.client=a;this.id=b}b.prototype.invoke=function(b,d,f,h){return a.invoke(b,d,f,h,this.id)};b.prototype.broadcast=function(b,d,f){return a.broadcast(b,d,f,this.id)};b.prototype.close=function(){a.closeConnection(this)};return b}()})},"esri/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/lang dojo/_base/url dojo/Deferred ../../kernel ../../config ../../request ../Logger ../urlUtils ./WorkerFallbackImpl".split(" "),
function(m,e,a,b,c,d,f,h,g,n,k,l){function p(){if(!u){var a=void 0;try{a=new Worker(r)}catch(b){v.warn("Failed to create Worker. Fallback to execute module in main thread",event),a=new l}return q(a)}if(!D){var a=new c(r),d=h.defaults?h.defaults.io.corsEnabledServers:h.request.corsEnabledServers;-1===d.indexOf(a.host)&&d.push(a.host);D=g(r,{responseType:"text"})}return D.then(function(a){var b;try{b=new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})))}catch(c){v.warn("Failed to create Worker. Fallback to execute module in main thread",
c),b=new l}return q(b)})}function q(c){function f(d){if(d&&d.data&&d.data.type)if(d=d.data.type,"\x3cworker-loaded\x3e"===d){d=c;var l;null!=h["default"]?(l=b.mixin({},h),delete l["default"],l=JSON.parse(JSON.stringify(l))):l=JSON.parse(JSON.stringify(h));d.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:l,dojoConfig:{async:!0,baseUrl:t,locale:a.locale,has:{"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0},paths:{esri:"esri",dojo:"dojo",dojox:"dojox",dstore:"dstore",
moment:"moment"}},loaderUrl:s}})}else"\x3cworker-configured\x3e"===d&&(c.removeEventListener("message",f),c.removeEventListener("error",g),k.resolve(c))}function g(a){a.preventDefault();c.removeEventListener("message",f);c.removeEventListener("error",g);v.warn("Failed to create Worker. Fallback to execute module in main thread",a);c=new l;c.addEventListener("message",f);c.addEventListener("error",g)}var k=new d;c.addEventListener("message",f);c.addEventListener("error",g);return k.promise}var v=n.getLogger("esri.core.workers"),
r=k.makeAbsolute(m.toUrl("./worker.js")),s=k.makeAbsolute(m.toUrl("dojo/dojo.js")),t=k.makeAbsolute("../../",s)+"/",u=!k.hasSameOrigin(r,location.href),D=null;return function(){function a(b,c,d){var f=this;this.connections=b;this.index=c;this.workerInitCallback=d;this.msgCount=0;this.outgoingJobs={};this.incomingJobs={};this.incomingStaticJobs={};p().then(function(a){f.worker=a;f.worker.addEventListener("message",f.message.bind(f));f.worker.addEventListener("error",function(a){a.preventDefault();
v.error(a)});f.workerInitCallback(f.index)})}a.prototype.terminate=function(){this.worker.terminate()};a.prototype.openConnection=function(a,b){return this.invoke("\x3copen-connection\x3e",{path:a},void 0,b)};a.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)};a.prototype.invoke=function(a,b,c,f){var h=this,g=++this.msgCount,k=new d(function(a){h.worker.postMessage({type:"\x3ccancel\x3e",id:g,connection:f,data:{reason:a}});h.outgoingJobs[g]&&delete h.outgoingJobs[g]});
this.outgoingJobs[g]=k;this.worker.postMessage({type:a,id:g,connection:f,data:b},c);return k.promise};a.prototype.message=function(a){var b=this;if(a&&a.data){var c=a.data.type;if(c){var d=a.data,h=a.data.id;if("\x3cresponse\x3e"===c&&h){if(a=this.outgoingJobs[h])delete this.outgoingJobs[h],d.error?a.reject(d.error):a.resolve(d.data)}else if("\x3ccancel\x3e"===c&&h)(a=this.incomingJobs[h])&&a.cancel(d.data.reason),d.staticMsg&&(a=this.incomingStaticJobs[h])&&a.cancel(d.data.reason);else if("\x3cstatic-message\x3e"===
c){var g=d.staticMsg;a=f.workerMessages[g];!a||"function"!==typeof a?this.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:g,id:h,error:a+" message type is not available on the kernel!"}):(d=a.call(this,d.data),this.incomingStaticJobs[h]=d,d.then(function(a){b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:g,id:h,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+g);(!a.dojoType||"cancel"!==a.dojoType)&&b.worker.postMessage({type:"\x3cstatic-message\x3e",
staticMsg:g,id:h,error:a})}).always(function(){delete b.incomingStaticJobs[h]}))}else{var k=d.connection;if(a=this.connections[k])if(a=a.client){var l=a[c];"function"===typeof l&&(d=l.call(a,d.data),this.incomingJobs[h]=d,d.then(function(a){b.worker.postMessage({type:"\x3cresponse\x3e",id:h,connection:k,error:a.error,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+c);(!a.dojoType||"cancel"!==a.dojoType)&&b.worker.postMessage({type:"\x3cresponse\x3e",id:h,connection:k,
error:a})}).always(function(){delete b.incomingJobs[h]}))}}}}};return a}()})},"esri/core/workers/WorkerFallbackImpl":function(){define(["require","exports"],function(m,e){var a=function(){return this}(),b=function(){return function(){var a=this,b=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(c){a[c]=function(){for(var a=[],d=0;d<arguments.length;d++)a[d-0]=arguments[d];return b[c].apply(b,a)}})}}(),c=a.MutationObserver||a.WebKitMutationObserver,
d=function(){var b;if(a.process&&a.process.nextTick)b=function(b){a.process.nextTick(b)};else if(a.Promise)b=function(b){a.Promise.resolve().then(b)};else if(c){var d=[],g=document.createElement("div");(new c(function(){for(;0<d.length;)d.shift()()})).observe(g,{attributes:!0});b=function(a){d.push(a);g.setAttribute("queueStatus","1")}}return b}();return function(){function a(){this._dispatcher=new b;this._connections={};this._outgoingStaticMessages={};this._isInitialized=!1;this._workerPostMessage({type:"\x3cworker-loaded\x3e"})}
a.prototype.terminate=function(){this._connections={}};Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(a){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=a)&&this.addEventListener("message",a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(a){this._onerrorHandler&&this.removeEventListener("error",
this._onerrorHandler);(this._onerrorHandler=a)&&this.addEventListener("error",a)},enumerable:!0,configurable:!0});a.prototype.postMessage=function(a,b){var c=this;d(function(){c._workerMessageHandler(new MessageEvent("message",{data:a}))})};a.prototype.dispatchEvent=function(a){return this._dispatcher.dispatchEvent(a)};a.prototype.addEventListener=function(a,b,c){this._dispatcher.addEventListener(a,b,c)};a.prototype.removeEventListener=function(a,b,c){this._dispatcher.removeEventListener(a,b,c)};
a.prototype._workerPostMessage=function(a,b){var c=this;d(function(){c.dispatchEvent(new MessageEvent("message",{data:a}))})};a.prototype._workerMessageHandler=function(a){var b=this,c=a.data;if(c){var d=c.connection,f=c.type;if("\x3cconfigure\x3e"===f)this._isInitialized||this._workerPostMessage({type:"\x3cworker-configured\x3e"});else if("\x3copen-connection\x3e"===f){a=c.data.path;var p=c.id;this._connections[d]?this._workerPostMessage({type:"\x3cresponse\x3e",id:p,connection:d}):m(["./WorkerConnection",
a],function(a,c){b._connections[d]=new a(c,{postMessage:function(a,c){return b._workerPostMessage(a,c)}},d);b._workerPostMessage({type:"\x3cresponse\x3e",id:p,data:{connection:d},error:void 0})})}else"\x3cclose-connection\x3e"===f?this._connections[d]&&delete this._connections[d]:"\x3cstatic-message\x3e"===f?(a=c.id,this._outgoingStaticMessages[a]&&(f=this._outgoingStaticMessages[a],delete this._outgoingStaticMessages[a],c.error?f.reject(c.error):f.resolve(c.data))):f&&(c=this._connections[d])&&c.proxy.message(a)}};
return a}()})},"esri/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/layers/support/TileKey"],function(m,e,a){return function(){function b(a){if(!("index"in a))throw Error("The tilemap is missing the 'index' property.");this._tilemap=a.index}b.prototype.dataKey=function(b){var d=[b];if(0>b.level||0>b.row||0>b.col||0<b.row>>b.level||0<b.col>>b.level)return null;for(;0!==b.level;)b=new a(b.level-1,b.row>>1,b.col>>1,b.world),d.push(b);b=this._tilemap;var f=d.pop(),h,g;if(1===
b)return f;for(;d.length;){h=d.pop();g=f.level+1;var n=2*f.row,k=2*f.col;g=[a.getId(g,n,k,h.world),a.getId(g,n,k+1,h.world),a.getId(g,n+1,k,h.world),a.getId(g,n+1,k+1,h.world)].indexOf(h.id);if(b)if(0===b[g]){f=null;break}else if(1===b[g]){f=h;break}else f=h,b=b[g]}return f};b.prototype.forEach=function(a,b,f,h,g){this._callback=g;this._maxLevel=b+a;this._forEach(this._tilemap,b,f,h)};b.prototype._forEach=function(a,b,f,h){0!==a&&(this._callback(b,f,h),b!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],
b+1,2*f,2*h),this._forEach(a[1],b+1,2*f,2*h+1),this._forEach(a[2],b+1,2*f+1,2*h),this._forEach(a[3],b+1,2*f+1,2*h+1)))};return b}()})},"esri/views/vectorTiles/SpriteMosaic":function(){define(["require","exports","./Rect","./RectangleBinPack","../webgl/Texture"],function(m,e,a,b,c){return function(){function d(a,c){this._height=this._width=0;this._mosaicRects={};this._dirty=!1;this.pixelRatio=1;(0>=a||0>=c)&&console.error("Sprites mosaic width and height must be greater than zero!");this._width=a;
this._height=c;this._binPack=new b(a,c)}Object.defineProperty(d.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});d.prototype.setSpriteSource=function(a){this._dispose();this.pixelRatio=a.devicePixelRatio;this._mosaicData||(this._binPack=new b(this._width,this._height),this._mosaicData=new Uint32Array(Math.floor(this._width)*Math.floor(this._height)));
this._sprites=a};d.prototype.getSpriteItem=function(a,b){void 0===b&&(b=!1);var c=this._mosaicRects[a];if(c)return c;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var d=this._sprites.getSpritePosition(a);if(!d||!d.width||!d.height)return null;var k=this._allocateImage(d.width,d.height);if(0>=k.width)return null;c={rect:k,width:d.width,height:d.height,sdf:d.sdf,pixelRatio:d.pixelRatio};this._copy(k,d,b);return this._mosaicRects[a]=c};d.prototype.getSpriteItems=function(a){for(var b=
{},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};d.prototype.getMosaicItemPosition=function(a,b){var c=this.getSpriteItem(a,b),d=c&&c.rect;if(!d)return null;d.width=c.width;d.height=c.height;return{size:[c.width,c.height],tl:[(d.x+1)/this._width,(d.y+1)/this._height],br:[(d.x+1+c.width)/this._width,(d.y+1+c.height)/this._height]}};d.prototype.bind=function(a,b,d){void 0===d&&(d=0);this._texture||(this._texture=new c(a,{pixelFormat:6408,dataType:5121,width:this._width,height:this._height},
new Uint8Array(this._mosaicData.buffer)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,d);this._dirty&&this._texture.setData(new Uint8Array(this._mosaicData.buffer));this._dirty=!1};d._copyBits=function(a,b,c,d,k,l,p,q,e,r,s){var t=d*b+c;p=q*l+p;if(s){p-=l;for(s=-1;s<=r;s++,t=((s+r)%r+d)*b+c,p+=l)for(q=-1;q<=e;q++)k[p+q]=a[t+(q+e)%e]}else for(s=0;s<r;s++){for(q=0;q<e;q++)k[p+q]=a[t+q];t+=b;p+=l}};d.prototype._copy=function(a,b,c){if(this._sprites&&"loaded"===this._sprites.loadStatus){var e=
new Uint32Array(this._sprites.image.buffer),k=this._mosaicData;(!k||!e)&&console.error("Source or target images are uninitialized!");d._copyBits(e,this._sprites.width,b.x,b.y,k,this._width,a.x+1,a.y+1,b.width,b.height,c);this._dirty=!0}};d.prototype._allocateImage=function(b,c){b+=2;c+=2;var d=this._binPack.allocate(b+(b%4?4-b%4:0),c+(c%4?4-c%4:0));0>=d.width&&(console.warn("Out of sprite mosaic space!"),d=new a(0,0,0,0));return d};d.prototype._dispose=function(){this._binPack=this._mosaicData=null;
this._mosaicRects={};this._dirty=!0};return d}()})},"esri/views/vectorTiles/Rect":function(){define(["require","exports"],function(m,e){return function(){function a(a,c,d,f){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===f&&(f=0);this.x=a;this.y=c;this.width=d;this.height=f}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return a}()})},"esri/views/vectorTiles/RectangleBinPack":function(){define(["require",
"exports","./Rect"],function(m,e,a){return function(){function b(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new a(0,0,b,d))}b.prototype.allocate=function(b,d){for(var f=null,h=-1,g=0;g<this._free.length;++g){var e=this._free[g];if(b<=e.width&&d<=e.height&&(null===f||e.y<=f.y&&e.x<=f.x))f=e,h=g}if(null===f)return new a;this._free.splice(h,1);f.width<f.height?(f.width>b&&this._free.push(new a(f.x+b,f.y,f.width-b,d)),f.height>d&&this._free.push(new a(f.x,
f.y+d,f.width,f.height-d))):(f.width>b&&this._free.push(new a(f.x+b,f.y,f.width-b,f.height)),f.height>d&&this._free.push(new a(f.x,f.y+d,b,f.height-d)));return new a(f.x,f.y,b,d)};b.prototype.release=function(a){for(var b=0;b<this._free.length;++b){var f=this._free[b];if(f.y===a.y&&f.height===a.height&&f.x+f.width===a.x)f.width+=a.width;else if(f.x===a.x&&f.width===a.width&&f.y+f.height===a.y)f.height+=a.height;else if(a.y===f.y&&a.height===f.height&&a.x+a.width===f.x)f.x=a.x,f.width+=a.width;else if(a.x===
f.x&&a.width===f.width&&a.y+a.height===f.y)f.y=a.y,f.height+=a.height;else continue;this._free.splice(b,1);this.release(a)}this._free.push(a)};return b}()})},"esri/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../kernel ../../core/promiseUtils".split(" "),function(m,e,a,b,c,d,f,h,g){return function(){function a(b,c){this.baseURL=b;this.devicePixelRatio=c;this._isRetina=
!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}a.prototype.getSpritePosition=function(a){return this._spritesData[a]};a.prototype.load=function(){var a=this;this.loadStatus="loading";return!this.baseURL?g.resolve(this):this._loadSprites().then(function(){a.loadStatus="loaded";return a}).otherwise(function(b){a.loadStatus="failed";return a})};a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var b=this.baseURL,
g=this._isRetina?"@2x":"",e=f(b+g+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){a._spritesData=b.data}),n=new c,r=new Image;r.crossOrigin="anonymous";r.onload=function(){r.onload=null;a.width=r.width;a.height=r.height;var b=document.createElement("canvas");b.width=r.width;b.height=r.height;b=b.getContext("2d");b.drawImage(r,0,0,r.width,r.height);for(var b=b.getImageData(0,0,r.width,r.height),b=new Uint8Array(b.data),c,d=0;d<b.length;d+=4)c=b[d+3]/255,b[d]*=c,b[d+1]*=
c,b[d+2]*=c;a.image=b;n.resolve()};b=""+b+g+".png";h.id&&(g=h.id.findCredential(b))&&g.token&&(b+="?token\x3d"+g.token);r.src=b;return d([e,n.promise])};return a}()})},"esri/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/Deferred ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),function(m,e,a,b,c,d,f){return function(){function h(a,b,c){this.height=this.width=0;this._dirty=!1;this._glyphIndex={};this._rangePromises={};(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");
this.width=a;this.height=b;this._glyphSource=c;this._binPack=new f(a,b);this._glyphData=new Uint8Array(a*b)}h.prototype.getGlyphItems=function(d,f,h){for(var l=this,p=[],e=this._glyphSource,v=new Set,r=1/256,s=0;s<h.length;s++)v.add(Math.floor(h[s]*r));var t=[];v.forEach(function(a){if(256>=a){var c=new b;t.push(c.promise);var d=f+a,h=l._rangePromises[d];h?h.push(c):(l._rangePromises[d]=[c],e.getRange(f,a).then(function(){var a=l._rangePromises[d];delete l._rangePromises[d];for(var b=0;b<a.length;b++)a[b].resolve()}))}});
return a(t).then(function(a){a=l._glyphIndex[f];a||(a={},l._glyphIndex[f]=a);for(var b=0;b<h.length;b++){var r=h[b],s=a[r];if(s)s.tileIDs.add(d),p[r]={rect:s.rect,metrics:s.metrics};else{var v=e.getGlyph(f,r);if(v&&v.metrics){var s=v.metrics,t=void 0;if(0===s.width)t=new c(0,0,0,0);else{var m=s.width+6,B=s.height+6,t=l._binPack.allocate(m+(m%4?4-m%4:0),B+(B%4?4-B%4:0));0>=t.width&&(t=new c(0,0,0,0));var v=v.bitmap,F=void 0,I=void 0;if(v)for(var G=0;G<B;G++)for(var F=m*G,I=l.width*(t.y+G)+t.x,L=0;L<
m;L++)l._glyphData[I+L]=v[F+L]}m=new Set;m.add(d);a[r]={rect:t,metrics:s,tileIDs:m};p[r]={rect:t,metrics:s};l._dirty=!0}}}return p})};h.prototype.removeGlyphs=function(a){for(var b in this._glyphIndex){var c=this._glyphIndex[b];if(c){var d=void 0,f;for(f in c)if(d=c[f],d.tileIDs["delete"](a),0===d.tileIDs.size){for(var d=d.rect,h=void 0,e=void 0,r=0;r<d.height;r++){h=this.width*(d.y+r)+d.x;for(e=0;e<d.width;e++)this._glyphData[h+e]=0}delete c[f];this._dirty=!0}}}};h.prototype.bind=function(a,b,c){void 0===
c&&(c=0);this._texture||(this._texture=new d(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,c);this._dirty&&this._texture.setData(this._glyphData);this._dirty=!1};return h}()})},"esri/views/vectorTiles/GlyphSource":function(){define(["require","exports","../../core/promiseUtils","../../request","../../core/pbf"],function(m,e,a,b,c){var d=function(){function a(b){this._metrics=
[];for(this._bitmaps=[];b.next();)switch(b.tag()){case 1:for(var c=b.getMessage();c.next();)switch(c.tag()){case 3:for(var d=c.getMessage(),f=void 0,h=void 0,e=void 0,v=void 0,r=void 0,s=void 0,t=void 0;d.next();)switch(d.tag()){case 1:f=d.getUInt32();break;case 2:h=d.getBytes();break;case 3:e=d.getUInt32();break;case 4:v=d.getUInt32();break;case 5:r=d.getSInt32();break;case 6:s=d.getSInt32();break;case 7:t=d.getUInt32();break;default:d.skip()}f&&(this._metrics[f]={width:e,height:v,left:r,top:s,advance:t},
this._bitmaps[f]=h);break;default:c.skip()}break;default:b.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),f=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function h(a){this._glyphInfo={};this._baseURL=a}h.prototype.getRange=function(f,h){var k=this._getFontStack(f);if(k.getRange(h))return a.resolve();
var l=256*h,p=l+255,l=this._baseURL.replace("{fontstack}",f).replace("{range}",l+"-"+p);return b(l,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){k.addRange(h,new d(new c(new Uint8Array(a.data),new DataView(a.data))))})};h.prototype.getGlyph=function(a,b){var c=this._getFontStack(a);if(c){var d=Math.floor(b/256);if(!(256<d))return c=c.getRange(d),!c?void 0:{metrics:c.getMetrics(b),bitmap:c.getBitmap(b)}}};h.prototype._getFontStack=function(a){var b=this._glyphInfo[a];
b||(b=this._glyphInfo[a]=new f);return b};return h}()})},"esri/core/pbf":function(){define(["require","exports"],function(m,e){return function(){function a(a,c,d,f){this._tag=0;this._dataType=99;this._data=a;this._dataView=c;this._pos=d||0;this._end=f||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var c=this._decodeVarint();this._tag=c>>3;this._dataType=c&7;if(!a||a===this._tag)break;
this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=function(){return this._decodeVarint()};a.prototype.getUInt32=function(){return this._decodeVarint()};a.prototype.getUInt64=function(){return this._decodeVarint()};a.prototype.getSInt32=function(){return this._decodeSVarint()};a.prototype.getSInt64=function(){return this._decodeSVarint()};a.prototype.getBool=
function(){var a=0!==this._data[this._pos];this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getUint32(c+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getInt32(c+4,!0);this._skip(8);return a};a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);
return a};a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=function(){var a=this._getLength(),c=this._pos,c=this._toString(this._data,c,c+a);this._skip(a);return c};a.prototype.getBytes=function(){var a=this._getLength(),
c=this._pos,c=this._toBytes(this._data,c,c+a);this._skip(a);return c};a.prototype.getMessage=function(){var b=this._getLength(),c=this._pos,c=new a(this._data,this._dataView,c,c+b);this._skip(b);return c};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");
this._pos+=a};a.prototype._decodeVarint=function(){var a=this._data,c=this._pos,d=0,f;if(10<=this._end-c){if(f=a[c++],d|=f&127,0!==(f&128)&&(f=a[c++],d|=(f&127)<<7,0!==(f&128)&&(f=a[c++],d|=(f&127)<<14,0!==(f&128)&&(f=a[c++],d|=(f&127)<<21,0!==(f&128)&&(f=a[c++],d+=268435456*(f&127),0!==(f&128)&&(f=a[c++],d+=34359738368*(f&127),0!==(f&128)&&(f=a[c++],d+=4398046511104*(f&127),0!==(f&128)&&(f=a[c++],d+=562949953421312*(f&127),0!==(f&128)&&(f=a[c++],d+=72057594037927936*(f&127),0!==(f&128)&&(f=a[c++],
d+=9223372036854775E3*(f&127),0!==(f&128)))))))))))throw Error("Varint too long!");}else{for(var h=1;c!==this._end;){f=a[c];if(0===(f&128))break;++c;d+=(f&127)*h;h*=128}if(c===this._end)throw Error("Varint overrun!");++c;d+=f*h}this._pos=c;return d};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};a.prototype._toString=function(a,c,
d){var f="",h="";for(d=Math.min(this._end,d);c<d;++c){var g=a[c];g&128?h+="%"+g.toString(16):(f+=decodeURIComponent(h)+String.fromCharCode(g),h="")}h.length&&(f+=decodeURIComponent(h));return f};a.prototype._toBytes=function(a,c,d){d=Math.min(this._end,d);return new Uint8Array(a.buffer,c,d-c)};return a}()})},"esri/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),
function(m,e,a,b,c,d,f,h){return function(c){function e(a,b,h,q,n,r,s,t,u,m,w){c.call(this);this._renderBuckets=[];this._symbolUpdateData=this._vectorTileData=null;this.topLeft=[0,0];this.bottomRight=[0,0];this.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};this.stencilData={mask:0,reference:0};this.key=a;this.refKey=b;this.topLeft[0]=h[0];this.topLeft[1]=h[1];this.bottomRight[0]=h[2];this.bottomRight[1]=h[3];this.widthInPixels=q;this.coordRange=n;this.rotation=r;this._vectorTileData=
s;this.styleLayers=t;this._glyphsMosaic=u;this.workerID=m;this._connection=w;this.id=a.id;this.status=3;this.tileTransform.transform=f.create();this.tileTransform.displayCoord=d.create()}a(e,c);e.prototype.updateSymbolData=function(a){a&&(this._symbolUpdateData=a,this.requestRender())};e.prototype.dispose=function(){-1!==this.workerID&&(this._connection&&6!==this.status&&7!==this.status)&&this._connection.broadcast("destructTileData",{key:this.id,worker:this.workerID},[]);this.polygonTrianglesVertexArrayObject&&
(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),
this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&
(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),
this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);this._renderBuckets=[];this.status=7};e.prototype.attach=function(a){this.status=3;if(!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var c=new Uint32Array(this._vectorTileData.bucketDataInfo),d=c.length,f=0;f<d;){var g=c[f],e=c[f+1];0===e?(e=new h.BackgroundRenderBucket,e.layerID=g,this._renderBuckets.push(e),
f+=2):1===e?(e=new h.FillRenderBucket,e.layerID=g,e.triangleElementStart=c[f+2],e.triangleElementCount=c[f+3],e.outlineElementStart=c[f+4],e.outlineElementCount=c[f+5],this._renderBuckets.push(e),f+=6):2===e?(e=new h.LineRenderBucket,e.layerID=g,e.triangleElementStart=c[f+2],e.triangleElementCount=c[f+3],e.joinStart=c[f+4],e.joinCount=c[f+5],this._renderBuckets.push(e),f+=6):3===e?(e=new h.SymbolRenderBucket,e.layerID=g,e.markerElementStart=c[f+2],e.marketElementCount=c[f+3],e.textElementStart=c[f+
4],e.textElementCount=c[f+5],e.isSDF=0!==c[f+6],this._renderBuckets.push(e),f+=7):console.error("Bad bucket type!")}c=a.context;a=a.budget;d=new Uint32Array(this._vectorTileData.bufferDataInfo);f=d.length;for(e=g=0;e<f;e+=2,g++){var n=d[e],t=d[e+1];if(!(0>=t||0===this._vectorTileData.bufferData[g].byteLength)){if(a&&a.done)return!1;switch(n){case 2:this.polygonTrianglesVertexBuffer||(this.polygonTrianglesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[g]));break;case 6:this.polygonTrianglesIndexBuffer||
(this.polygonTrianglesIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,t/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[g]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,t/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[g]));
break;case 8:this.lineTrianglesIndexBuffer||(this.lineTrianglesIndexBuffer=b.createIndex(c,35044,this._vectorTileData.bufferData[g]));break;case 1:this.lineJoinVertexBuffer||(this.lineJoinVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[g]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[g]));break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[g],
0,t/4)));break;case 5:this.textVertexBuffer||(this.textVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[g]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[g],0,t/4)))}}}this.status=4;return!0};e.prototype.detach=function(a){};e.prototype.render=function(a){if(this.visible&&4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,
this.stencilData.reference,this.stencilData.mask);var f=this.styleLayers,h=void 0!==a.layerOpacity?a.layerOpacity:1;if(0!==h){var g,e=this._renderBuckets.length,n=0;if(0===d)for(n=e-1;0<=n;n--)g=this._renderBuckets[n],3!==g.type&&g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,f.layers[g.layerID],h);else for(n=0;n<e;n++)g=this._renderBuckets[n],g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,f.layers[g.layerID],h)}}}};e.prototype._updateSymbolData=function(a){var c=
new Uint32Array(this._symbolUpdateData.bucketDataInfo),d=c.length;if(0===d)return this._symbolUpdateData=null,!0;if(1>a.budget.remaining)return this.requestRender(),!1;a=a.context;a.bindVAO(null);for(var f=new Uint32Array(this._symbolUpdateData.bufferDataInfo),g=f.length,e=0,n=0;n<g;n+=2,e++){var t=f[n],u=f[n+1];if(!(0>=u||0===this._symbolUpdateData.bufferData[e].byteLength))switch(t){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=
b.createVertex(a,35044,this._symbolUpdateData.bufferData[e]);break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[e],0,u/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=b.createVertex(a,35044,this._symbolUpdateData.bufferData[e]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),
this.textIndexBuffer=null),this.textIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[e],0,u/4))}}a=0;for(f=this._renderBuckets.length;a<f;a++)this._renderBuckets[a]instanceof h.SymbolRenderBucket&&(g=this._renderBuckets[a],g.markerElementStart=0,g.marketElementCount=0,g.textElementStart=0,g.textElementCount=0);for(g=0;g<d;){n=c[g];e=-1;a=0;for(f=this._renderBuckets.length;a<f;a++)if(this._renderBuckets[a].layerID===n){e=a;break}-1===e&&console.log("bucket not found");
if(a=this._renderBuckets[e])a.markerElementStart=c[g+2],a.marketElementCount=c[g+3],a.textElementStart=c[g+4],a.textElementCount=c[g+5];g+=7}this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this._symbolUpdateData=null;return!0};return e}(c)})},"esri/core/libs/gl-matrix/vec2":function(){define(["./common"],function(m){var e={create:function(){var a=new m.ARRAY_TYPE(2);
a[0]=0;a[1]=0;return a},clone:function(a){var b=new m.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new m.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};e.mul=e.multiply;e.divide=
function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};e.div=e.divide;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=
b[1]*c;return a};e.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};e.dist=e.distance;e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};e.sqrDist=e.squaredDistance;e.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};e.len=e.length;e.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};e.sqrLen=e.squaredLength;e.negate=function(a,b){a[0]=-b[0];a[1]=
-b[1];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};e.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};e.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};e.lerp=function(a,b,c,d){var f=b[0];b=b[1];a[0]=f+d*(c[0]-f);a[1]=b+d*(c[1]-b);return a};e.random=function(a,b){b=b||1;var c=2*m.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};
e.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};e.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};e.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};e.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};e.forEach=function(){var a=e.create();return function(b,c,d,f,h,g){c||(c=2);
d||(d=0);for(f=f?Math.min(f*c+d,b.length):b.length;d<f;d+=c)a[0]=b[d],a[1]=b[d+1],h(a,a,g),b[d]=a[0],b[d+1]=a[1];return b}}();e.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};e.equals=function(a,b){var c=a[0],d=a[1],f=b[0],h=b[1];return Math.abs(c-f)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(f))&&Math.abs(d-h)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))};return e})},"esri/core/libs/gl-matrix/common":function(){define([],function(){var m=
{EPSILON:1E-6};m.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;m.RANDOM=Math.random;m.ENABLE_SIMD=!1;m.SIMD_AVAILABLE=m.ARRAY_TYPE===Float32Array&&"SIMD"in this;m.USE_SIMD=m.ENABLE_SIMD&&m.SIMD_AVAILABLE;m.setMatrixArrayType=function(a){m.ARRAY_TYPE=a};var e=Math.PI/180;m.toRadian=function(a){return a*e};m.equals=function(a,b){return Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return m})},"esri/core/libs/gl-matrix/mat4":function(){define(["./common"],function(m){var e=
{scalar:{},SIMD:{},create:function(){var a=new m.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new m.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=
b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},fromValues:function(a,b,c,d,f,h,g,e,k,l,p,q,v,r,s,t){var u=new m.ARRAY_TYPE(16);u[0]=a;u[1]=b;u[2]=c;u[3]=d;u[4]=f;u[5]=h;u[6]=g;u[7]=e;u[8]=k;u[9]=l;u[10]=p;u[11]=q;u[12]=v;u[13]=r;u[14]=s;u[15]=t;return u},set:function(a,b,c,d,f,h,g,e,k,l,p,q,v,r,s,t,u){a[0]=b;a[1]=c;a[2]=d;a[3]=f;a[4]=h;a[5]=g;a[6]=e;a[7]=k;a[8]=l;a[9]=p;a[10]=q;a[11]=v;a[12]=r;a[13]=s;a[14]=t;a[15]=u;return a},
identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};e.scalar.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],f=b[3],h=b[6],g=b[7],e=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=h;a[11]=b[14];a[12]=f;a[13]=g;a[14]=e}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],
a[14]=b[11],a[15]=b[15];return a};e.SIMD.transpose=function(a,b){var c,d,f,h,g,e,k;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);f=SIMD.Float32x4.load(b,8);h=SIMD.Float32x4.load(b,12);g=SIMD.Float32x4.shuffle(c,d,0,1,4,5);e=SIMD.Float32x4.shuffle(f,h,0,1,4,5);k=SIMD.Float32x4.shuffle(g,e,0,2,4,6);g=SIMD.Float32x4.shuffle(g,e,1,3,5,7);SIMD.Float32x4.store(a,0,k);SIMD.Float32x4.store(a,4,g);g=SIMD.Float32x4.shuffle(c,d,2,3,6,7);e=SIMD.Float32x4.shuffle(f,h,2,3,6,7);c=SIMD.Float32x4.shuffle(g,
e,0,2,4,6);d=SIMD.Float32x4.shuffle(g,e,1,3,5,7);SIMD.Float32x4.store(a,8,c);SIMD.Float32x4.store(a,12,d);return a};e.transpose=m.USE_SIMD?e.SIMD.transpose:e.scalar.transpose;e.scalar.invert=function(a,b){var c=b[0],d=b[1],f=b[2],h=b[3],g=b[4],e=b[5],k=b[6],l=b[7],p=b[8],q=b[9],v=b[10],r=b[11],s=b[12],t=b[13],u=b[14],m=b[15],w=c*e-d*g,x=c*k-f*g,z=c*l-h*g,y=d*k-f*e,C=d*l-h*e,B=f*l-h*k,F=p*t-q*s,I=p*u-v*s,G=p*m-r*s,L=q*u-v*t,H=q*m-r*t,J=v*m-r*u,A=w*J-x*H+z*L+y*G-C*I+B*F;if(!A)return null;A=1/A;a[0]=
(e*J-k*H+l*L)*A;a[1]=(f*H-d*J-h*L)*A;a[2]=(t*B-u*C+m*y)*A;a[3]=(v*C-q*B-r*y)*A;a[4]=(k*G-g*J-l*I)*A;a[5]=(c*J-f*G+h*I)*A;a[6]=(u*z-s*B-m*x)*A;a[7]=(p*B-v*z+r*x)*A;a[8]=(g*H-e*G+l*F)*A;a[9]=(d*G-c*H-h*F)*A;a[10]=(s*C-t*z+m*w)*A;a[11]=(q*z-p*C-r*w)*A;a[12]=(e*I-g*L-k*F)*A;a[13]=(c*L-d*I+f*F)*A;a[14]=(t*x-s*y-u*w)*A;a[15]=(p*y-q*x+v*w)*A;return a};e.SIMD.invert=function(a,b){var c,d,f,h,g,e,k,l,p;e=SIMD.Float32x4.load(b,0);k=SIMD.Float32x4.load(b,4);l=SIMD.Float32x4.load(b,8);p=SIMD.Float32x4.load(b,
12);g=SIMD.Float32x4.shuffle(e,k,0,1,4,5);d=SIMD.Float32x4.shuffle(l,p,0,1,4,5);c=SIMD.Float32x4.shuffle(g,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,g,1,3,5,7);g=SIMD.Float32x4.shuffle(e,k,2,3,6,7);h=SIMD.Float32x4.shuffle(l,p,2,3,6,7);f=SIMD.Float32x4.shuffle(g,h,0,2,4,6);h=SIMD.Float32x4.shuffle(h,g,1,3,5,7);g=SIMD.Float32x4.mul(f,h);g=SIMD.Float32x4.swizzle(g,1,0,3,2);e=SIMD.Float32x4.mul(d,g);k=SIMD.Float32x4.mul(c,g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,g),
e);k=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);g=SIMD.Float32x4.mul(d,f);g=SIMD.Float32x4.swizzle(g,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),e);p=SIMD.Float32x4.mul(c,g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(h,g));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);g=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,3,0,1),h);g=SIMD.Float32x4.swizzle(g,1,0,3,2);f=SIMD.Float32x4.swizzle(f,
2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),e);l=SIMD.Float32x4.mul(c,g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(f,g));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);g=SIMD.Float32x4.mul(c,d);g=SIMD.Float32x4.swizzle(g,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),l);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,g),p);g=SIMD.Float32x4.swizzle(g,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,g),l);p=SIMD.Float32x4.sub(p,
SIMD.Float32x4.mul(f,g));g=SIMD.Float32x4.mul(c,h);g=SIMD.Float32x4.swizzle(g,1,0,3,2);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(f,g));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),l);g=SIMD.Float32x4.swizzle(g,2,3,0,1);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),k);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(d,g));g=SIMD.Float32x4.mul(c,f);g=SIMD.Float32x4.swizzle(g,1,0,3,2);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,g),k);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(d,g));g=SIMD.Float32x4.swizzle(g,2,
3,0,1);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(h,g));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),p);c=SIMD.Float32x4.mul(c,e);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c);g=SIMD.Float32x4.reciprocalApproximation(c);c=SIMD.Float32x4.sub(SIMD.Float32x4.add(g,g),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(g,g)));c=SIMD.Float32x4.swizzle(c,0,0,0,0);if(!c)return null;SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(c,e));SIMD.Float32x4.store(a,
4,SIMD.Float32x4.mul(c,k));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(c,l));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(c,p));return a};e.invert=m.USE_SIMD?e.SIMD.invert:e.scalar.invert;e.scalar.adjoint=function(a,b){var c=b[0],d=b[1],f=b[2],h=b[3],g=b[4],e=b[5],k=b[6],l=b[7],p=b[8],q=b[9],v=b[10],r=b[11],s=b[12],t=b[13],u=b[14],m=b[15];a[0]=e*(v*m-r*u)-q*(k*m-l*u)+t*(k*r-l*v);a[1]=-(d*(v*m-r*u)-q*(f*m-h*u)+t*(f*r-h*v));a[2]=d*(k*m-l*u)-e*(f*m-h*u)+t*(f*l-h*k);a[3]=-(d*(k*r-l*v)-e*(f*r-h*v)+q*(f*
l-h*k));a[4]=-(g*(v*m-r*u)-p*(k*m-l*u)+s*(k*r-l*v));a[5]=c*(v*m-r*u)-p*(f*m-h*u)+s*(f*r-h*v);a[6]=-(c*(k*m-l*u)-g*(f*m-h*u)+s*(f*l-h*k));a[7]=c*(k*r-l*v)-g*(f*r-h*v)+p*(f*l-h*k);a[8]=g*(q*m-r*t)-p*(e*m-l*t)+s*(e*r-l*q);a[9]=-(c*(q*m-r*t)-p*(d*m-h*t)+s*(d*r-h*q));a[10]=c*(e*m-l*t)-g*(d*m-h*t)+s*(d*l-h*e);a[11]=-(c*(e*r-l*q)-g*(d*r-h*q)+p*(d*l-h*e));a[12]=-(g*(q*u-v*t)-p*(e*u-k*t)+s*(e*v-k*q));a[13]=c*(q*u-v*t)-p*(d*u-f*t)+s*(d*v-f*q);a[14]=-(c*(e*u-k*t)-g*(d*u-f*t)+s*(d*k-f*e));a[15]=c*(e*v-k*q)-g*
(d*v-f*q)+p*(d*k-f*e);return a};e.SIMD.adjoint=function(a,b){var c,d,f,h,g,e,k,l,p;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);f=SIMD.Float32x4.load(b,8);h=SIMD.Float32x4.load(b,12);k=SIMD.Float32x4.shuffle(c,d,0,1,4,5);e=SIMD.Float32x4.shuffle(f,h,0,1,4,5);g=SIMD.Float32x4.shuffle(k,e,0,2,4,6);e=SIMD.Float32x4.shuffle(e,k,1,3,5,7);k=SIMD.Float32x4.shuffle(c,d,2,3,6,7);d=SIMD.Float32x4.shuffle(f,h,2,3,6,7);c=SIMD.Float32x4.shuffle(k,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,k,1,3,5,7);k=SIMD.Float32x4.mul(c,
d);k=SIMD.Float32x4.swizzle(k,1,0,3,2);f=SIMD.Float32x4.mul(e,k);h=SIMD.Float32x4.mul(g,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,k),f);h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,k),h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);k=SIMD.Float32x4.mul(e,c);k=SIMD.Float32x4.swizzle(k,1,0,3,2);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,k),f);p=SIMD.Float32x4.mul(g,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(d,k));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,
k),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);k=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),d);k=SIMD.Float32x4.swizzle(k,1,0,3,2);c=SIMD.Float32x4.swizzle(c,2,3,0,1);f=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,k),f);l=SIMD.Float32x4.mul(g,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(c,k));l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,k),l);l=SIMD.Float32x4.swizzle(l,2,3,0,1);k=SIMD.Float32x4.mul(g,e);k=SIMD.Float32x4.swizzle(k,1,0,3,2);l=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,
k),l);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,k),p);k=SIMD.Float32x4.swizzle(k,2,3,0,1);l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,k),l);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(c,k));k=SIMD.Float32x4.mul(g,d);k=SIMD.Float32x4.swizzle(k,1,0,3,2);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(c,k));l=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,k),l);k=SIMD.Float32x4.swizzle(k,2,3,0,1);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,k),h);l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(e,k));k=SIMD.Float32x4.mul(g,c);
k=SIMD.Float32x4.swizzle(k,1,0,3,2);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,k),h);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(e,k));k=SIMD.Float32x4.swizzle(k,2,3,0,1);h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(d,k));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,k),p);SIMD.Float32x4.store(a,0,f);SIMD.Float32x4.store(a,4,h);SIMD.Float32x4.store(a,8,l);SIMD.Float32x4.store(a,12,p);return a};e.adjoint=m.USE_SIMD?e.SIMD.adjoint:e.scalar.adjoint;e.determinant=function(a){var b=a[0],c=a[1],d=a[2],f=a[3],h=a[4],
g=a[5],e=a[6],k=a[7],l=a[8],p=a[9],q=a[10],v=a[11],r=a[12],s=a[13],t=a[14];a=a[15];return(b*g-c*h)*(q*a-v*t)-(b*e-d*h)*(p*a-v*s)+(b*k-f*h)*(p*t-q*s)+(c*e-d*g)*(l*a-v*r)-(c*k-f*g)*(l*t-q*r)+(d*k-f*e)*(l*s-p*r)};e.SIMD.multiply=function(a,b,c){var d=SIMD.Float32x4.load(b,0),f=SIMD.Float32x4.load(b,4),h=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);var g=SIMD.Float32x4.load(c,0),g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,
1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),b))));SIMD.Float32x4.store(a,0,g);g=SIMD.Float32x4.load(c,4);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),b))));SIMD.Float32x4.store(a,
4,g);g=SIMD.Float32x4.load(c,8);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(g,3,3,3,3),b))));SIMD.Float32x4.store(a,8,g);c=SIMD.Float32x4.load(c,12);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,
1,1,1,1),f),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),h),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),b))));SIMD.Float32x4.store(a,12,d);return a};e.scalar.multiply=function(a,b,c){var d=b[0],f=b[1],h=b[2],g=b[3],e=b[4],k=b[5],l=b[6],p=b[7],q=b[8],v=b[9],r=b[10],s=b[11],t=b[12],u=b[13],m=b[14];b=b[15];var w=c[0],x=c[1],z=c[2],y=c[3];a[0]=w*d+x*e+z*q+y*t;a[1]=w*f+x*k+z*v+y*u;a[2]=w*h+x*l+z*r+y*m;a[3]=w*g+x*p+z*s+y*b;w=c[4];x=c[5];z=c[6];y=c[7];a[4]=w*d+x*e+z*q+
y*t;a[5]=w*f+x*k+z*v+y*u;a[6]=w*h+x*l+z*r+y*m;a[7]=w*g+x*p+z*s+y*b;w=c[8];x=c[9];z=c[10];y=c[11];a[8]=w*d+x*e+z*q+y*t;a[9]=w*f+x*k+z*v+y*u;a[10]=w*h+x*l+z*r+y*m;a[11]=w*g+x*p+z*s+y*b;w=c[12];x=c[13];z=c[14];y=c[15];a[12]=w*d+x*e+z*q+y*t;a[13]=w*f+x*k+z*v+y*u;a[14]=w*h+x*l+z*r+y*m;a[15]=w*g+x*p+z*s+y*b;return a};e.multiply=m.USE_SIMD?e.SIMD.multiply:e.scalar.multiply;e.mul=e.multiply;e.scalar.translate=function(a,b,c){var d=c[0],f=c[1];c=c[2];var h,g,e,k,l,p,q,v,r,s,t,u;b===a?(a[12]=b[0]*d+b[4]*f+
b[8]*c+b[12],a[13]=b[1]*d+b[5]*f+b[9]*c+b[13],a[14]=b[2]*d+b[6]*f+b[10]*c+b[14],a[15]=b[3]*d+b[7]*f+b[11]*c+b[15]):(h=b[0],g=b[1],e=b[2],k=b[3],l=b[4],p=b[5],q=b[6],v=b[7],r=b[8],s=b[9],t=b[10],u=b[11],a[0]=h,a[1]=g,a[2]=e,a[3]=k,a[4]=l,a[5]=p,a[6]=q,a[7]=v,a[8]=r,a[9]=s,a[10]=t,a[11]=u,a[12]=h*d+l*f+r*c+b[12],a[13]=g*d+p*f+s*c+b[13],a[14]=e*d+q*f+t*c+b[14],a[15]=k*d+v*f+u*c+b[15]);return a};e.SIMD.translate=function(a,b,c){var d=SIMD.Float32x4.load(b,0),f=SIMD.Float32x4.load(b,4),h=SIMD.Float32x4.load(b,
8),g=SIMD.Float32x4.load(b,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]);d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0));f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(c,1,1,1,1));h=SIMD.Float32x4.mul(h,SIMD.Float32x4.swizzle(c,2,2,2,2));b=SIMD.Float32x4.add(d,SIMD.Float32x4.add(f,SIMD.Float32x4.add(h,g)));SIMD.Float32x4.store(a,12,b);return a};e.translate=m.USE_SIMD?
e.SIMD.translate:e.scalar.translate;e.scalar.scale=function(a,b,c){var d=c[0],f=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*f;a[5]=b[5]*f;a[6]=b[6]*f;a[7]=b[7]*f;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};e.SIMD.scale=function(a,b,c){var d;c=SIMD.Float32x4(c[0],c[1],c[2],0);d=SIMD.Float32x4.load(b,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0)));d=SIMD.Float32x4.load(b,
4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,1,1,1,1)));d=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2)));a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};e.scale=m.USE_SIMD?e.SIMD.scale:e.scalar.scale;e.rotate=function(a,b,c,d){var f=d[0],h=d[1];d=d[2];var g=Math.sqrt(f*f+h*h+d*d),e,k,l,p,q,v,r,s,t,u,D,w,x,z,y,C,B,F,I,G;if(Math.abs(g)<m.EPSILON)return null;g=1/g;f*=g;h*=g;d*=g;e=Math.sin(c);k=Math.cos(c);
l=1-k;c=b[0];g=b[1];p=b[2];q=b[3];v=b[4];r=b[5];s=b[6];t=b[7];u=b[8];D=b[9];w=b[10];x=b[11];z=f*f*l+k;y=h*f*l+d*e;C=d*f*l-h*e;B=f*h*l-d*e;F=h*h*l+k;I=d*h*l+f*e;G=f*d*l+h*e;f=h*d*l-f*e;h=d*d*l+k;a[0]=c*z+v*y+u*C;a[1]=g*z+r*y+D*C;a[2]=p*z+s*y+w*C;a[3]=q*z+t*y+x*C;a[4]=c*B+v*F+u*I;a[5]=g*B+r*F+D*I;a[6]=p*B+s*F+w*I;a[7]=q*B+t*F+x*I;a[8]=c*G+v*f+u*h;a[9]=g*G+r*f+D*h;a[10]=p*G+s*f+w*h;a[11]=q*G+t*f+x*h;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};e.scalar.rotateX=function(a,b,c){var d=
Math.sin(c);c=Math.cos(c);var f=b[4],h=b[5],e=b[6],n=b[7],k=b[8],l=b[9],p=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=f*c+k*d;a[5]=h*c+l*d;a[6]=e*c+p*d;a[7]=n*c+q*d;a[8]=k*c-f*d;a[9]=l*c-h*d;a[10]=p*c-e*d;a[11]=q*c-n*d;return a};e.SIMD.rotateX=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);
var f=SIMD.Float32x4.load(b,4);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(f,d)));return a};e.rotateX=m.USE_SIMD?e.SIMD.rotateX:e.scalar.rotateX;e.scalar.rotateY=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[0],h=b[1],e=b[2],n=b[3],k=b[8],l=b[9],p=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=
b[13],a[14]=b[14],a[15]=b[15]);a[0]=f*c-k*d;a[1]=h*c-l*d;a[2]=e*c-p*d;a[3]=n*c-q*d;a[8]=f*d+k*c;a[9]=h*d+l*c;a[10]=e*d+p*c;a[11]=n*d+q*c;return a};e.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,c),SIMD.Float32x4.mul(b,d)));
SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,d),SIMD.Float32x4.mul(b,c)));return a};e.rotateY=m.USE_SIMD?e.SIMD.rotateY:e.scalar.rotateY;e.scalar.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var f=b[0],h=b[1],e=b[2],n=b[3],k=b[4],l=b[5],p=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=f*c+k*d;a[1]=h*c+l*d;a[2]=e*c+p*d;a[3]=n*c+q*d;a[4]=k*c-f*d;a[5]=l*c-h*d;a[6]=p*c-e*d;a[7]=q*c-n*d;return a};e.SIMD.rotateZ=
function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(f,d)));return a};e.rotateZ=m.USE_SIMD?e.SIMD.rotateZ:e.scalar.rotateZ;
e.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};e.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromRotation=function(a,b,c){var d=c[0],f=c[1];c=c[2];var e=Math.sqrt(d*d+f*f+c*c),g;if(Math.abs(e)<m.EPSILON)return null;e=1/e;d*=e;f*=e;c*=e;e=Math.sin(b);b=Math.cos(b);
g=1-b;a[0]=d*d*g+b;a[1]=f*d*g+c*e;a[2]=c*d*g-f*e;a[3]=0;a[4]=d*f*g-c*e;a[5]=f*f*g+b;a[6]=c*f*g+d*e;a[7]=0;a[8]=d*c*g+f*e;a[9]=f*c*g-d*e;a[10]=c*c*g+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromXRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=d;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromYRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=
0;a[7]=0;a[8]=c;a[9]=0;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromZRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.fromRotationTranslation=function(a,b,c){var d=b[0],f=b[1],e=b[2],g=b[3],n=d+d,k=f+f,l=e+e;b=d*n;var p=d*k,d=d*l,q=f*k,f=f*l,e=e*l,n=g*n,k=g*k,g=g*l;a[0]=1-(q+e);a[1]=p+g;a[2]=d-k;a[3]=0;a[4]=p-g;a[5]=1-(b+e);a[6]=f+n;a[7]=0;a[8]=
d+k;a[9]=f-n;a[10]=1-(b+q);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};e.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};e.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=0.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=0.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=
(b[1]+b[4])/d,a[1]=0.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=0.25*d);return a};e.fromRotationTranslationScale=function(a,b,c,d){var f=b[0],e=b[1],g=b[2],n=b[3],k=f+f,l=e+e,p=g+g;b=f*k;var q=f*l,f=f*p,v=e*l,e=e*p,g=g*p,k=n*k,l=n*l,n=n*p,p=d[0],r=d[1];d=d[2];a[0]=(1-(v+g))*p;a[1]=(q+n)*p;a[2]=(f-l)*p;a[3]=0;a[4]=(q-n)*r;a[5]=(1-(b+g))*r;a[6]=(e+k)*r;a[7]=0;a[8]=(f+l)*d;a[9]=(e-k)*d;a[10]=(1-(b+v))*d;a[11]=0;a[12]=c[0];
a[13]=c[1];a[14]=c[2];a[15]=1;return a};e.fromRotationTranslationScaleOrigin=function(a,b,c,d,f){var e=b[0],g=b[1],n=b[2],k=b[3],l=e+e,p=g+g,q=n+n;b=e*l;var v=e*p,e=e*q,r=g*p,g=g*q,n=n*q,l=k*l,p=k*p,k=k*q,q=d[0],s=d[1];d=d[2];var t=f[0],u=f[1];f=f[2];a[0]=(1-(r+n))*q;a[1]=(v+k)*q;a[2]=(e-p)*q;a[3]=0;a[4]=(v-k)*s;a[5]=(1-(b+n))*s;a[6]=(g+l)*s;a[7]=0;a[8]=(e+p)*d;a[9]=(g-l)*d;a[10]=(1-(b+r))*d;a[11]=0;a[12]=c[0]+t-(a[0]*t+a[4]*u+a[8]*f);a[13]=c[1]+u-(a[1]*t+a[5]*u+a[9]*f);a[14]=c[2]+f-(a[2]*t+a[6]*
u+a[10]*f);a[15]=1;return a};e.fromQuat=function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],g=c+c,n=d+d,k=f+f,c=c*g,l=d*g,d=d*n,p=f*g,q=f*n,f=f*k,g=e*g,n=e*n,e=e*k;a[0]=1-d-f;a[1]=l+e;a[2]=p-n;a[3]=0;a[4]=l-e;a[5]=1-c-f;a[6]=q+g;a[7]=0;a[8]=p+n;a[9]=q-g;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};e.frustum=function(a,b,c,d,f,e,g){var n=1/(c-b),k=1/(f-d),l=1/(e-g);a[0]=2*e*n;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*e*k;a[6]=0;a[7]=0;a[8]=(c+b)*n;a[9]=(f+d)*k;a[10]=(g+e)*l;a[11]=-1;a[12]=0;a[13]=
0;a[14]=2*(g*e)*l;a[15]=0;return a};e.perspective=function(a,b,c,d,f){b=1/Math.tan(b/2);var e=1/(d-f);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(f+d)*e;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*f*d*e;a[15]=0;return a};e.perspectiveFromFieldOfView=function(a,b,c,d){var f=Math.tan(b.upDegrees*Math.PI/180),e=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var n=2/(g+b),k=2/(f+e);a[0]=n;a[1]=0;a[2]=0;a[3]=0;a[4]=
0;a[5]=k;a[6]=0;a[7]=0;a[8]=-(0.5*(g-b)*n);a[9]=0.5*(f-e)*k;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a};e.ortho=function(a,b,c,d,f,e,g){var n=1/(b-c),k=1/(d-f),l=1/(e-g);a[0]=-2*n;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*k;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(b+c)*n;a[13]=(f+d)*k;a[14]=(g+e)*l;a[15]=1;return a};e.lookAt=function(a,b,c,d){var f,h,g,n,k,l,p,q,v=b[0],r=b[1];b=b[2];g=d[0];n=d[1];h=d[2];p=c[0];d=c[1];f=c[2];if(Math.abs(v-p)<m.EPSILON&&Math.abs(r-
d)<m.EPSILON&&Math.abs(b-f)<m.EPSILON)return e.identity(a);c=v-p;d=r-d;p=b-f;q=1/Math.sqrt(c*c+d*d+p*p);c*=q;d*=q;p*=q;f=n*p-h*d;h=h*c-g*p;g=g*d-n*c;(q=Math.sqrt(f*f+h*h+g*g))?(q=1/q,f*=q,h*=q,g*=q):g=h=f=0;n=d*g-p*h;k=p*f-c*g;l=c*h-d*f;(q=Math.sqrt(n*n+k*k+l*l))?(q=1/q,n*=q,k*=q,l*=q):l=k=n=0;a[0]=f;a[1]=n;a[2]=c;a[3]=0;a[4]=h;a[5]=k;a[6]=d;a[7]=0;a[8]=g;a[9]=l;a[10]=p;a[11]=0;a[12]=-(f*v+h*r+g*b);a[13]=-(n*v+k*r+l*b);a[14]=-(c*v+d*r+p*b);a[15]=1;return a};e.str=function(a){return"mat4("+a[0]+", "+
a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};e.add=function(a,b,c){a[0]=b[0]+
c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};e.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-
c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a};e.sub=e.subtract;e.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a};e.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+
c[8]*d;a[9]=b[9]+c[9]*d;a[10]=b[10]+c[10]*d;a[11]=b[11]+c[11]*d;a[12]=b[12]+c[12]*d;a[13]=b[13]+c[13]*d;a[14]=b[14]+c[14]*d;a[15]=b[15]+c[15]*d;return a};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};e.equals=function(a,b){var c=a[0],d=a[1],f=a[2],e=a[3],g=a[4],n=a[5],k=a[6],l=a[7],p=a[8],q=
a[9],v=a[10],r=a[11],s=a[12],t=a[13],u=a[14],D=a[15],w=b[0],x=b[1],z=b[2],y=b[3],C=b[4],B=b[5],F=b[6],I=b[7],G=b[8],L=b[9],H=b[10],J=b[11],A=b[12],E=b[13],K=b[14],M=b[15];return Math.abs(c-w)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(d-x)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(f-z)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(e-y)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(y))&&Math.abs(g-C)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(n-B)<=
m.EPSILON*Math.max(1,Math.abs(n),Math.abs(B))&&Math.abs(k-F)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(F))&&Math.abs(l-I)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(p-G)<=m.EPSILON*Math.max(1,Math.abs(p),Math.abs(G))&&Math.abs(q-L)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(L))&&Math.abs(v-H)<=m.EPSILON*Math.max(1,Math.abs(v),Math.abs(H))&&Math.abs(r-J)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(J))&&Math.abs(s-A)<=m.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(t-E)<=m.EPSILON*
Math.max(1,Math.abs(t),Math.abs(E))&&Math.abs(u-K)<=m.EPSILON*Math.max(1,Math.abs(u),Math.abs(K))&&Math.abs(D-M)<=m.EPSILON*Math.max(1,Math.abs(D),Math.abs(M))};return e})},"esri/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(m,e,a,b){m=function(){return function(a){this.type=a}}();e.RenderBucket=m;b=function(b){function d(){b.call(this,2);this.joinCount=this.joinStart=this.triangleElementCount=
this.triangleElementStart=0}a(d,b);d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinCount};return d}(m);e.LineRenderBucket=b;b=function(b){function d(){b.call(this,1);this.outlineElementCount=this.outlineElementStart=this.triangleElementCount=this.triangleElementStart=0}a(d,b);d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount};return d}(m);e.FillRenderBucket=b;b=function(b){function d(){b.call(this,3);this.textElementCount=this.textElementStart=
this.marketElementCount=this.markerElementStart=0;this.isSDF=!1}a(d,b);d.prototype.hasData=function(){return 0<this.marketElementCount||0<this.textElementCount};return d}(m);e.SymbolRenderBucket=b;m=function(b){function d(){b.call(this,0)}a(d,b);d.prototype.hasData=function(){return!0};return d}(m);e.BackgroundRenderBucket=m})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(m,e){function a(a,b){a%=b;return 0<=a?a:a+b}e.C_INFINITY=Number.POSITIVE_INFINITY;e.C_PI=
Math.PI;e.C_2PI=2*e.C_PI;e.C_PI_BY_2=e.C_PI/2;e.C_RAD_TO_256=128/e.C_PI;e.C_256_TO_RAD=e.C_PI/128;e.C_DEG_TO_256=256/360;e.C_DEG_TO_RAD=e.C_PI/180;e.C_SQRT2=1.414213562;e.C_SQRT2_INV=1/e.C_SQRT2;var b=1/Math.LN2;e.positiveMod=a;e.radToByte=function(b){return a(b*e.C_RAD_TO_256,256)};e.degToByte=function(b){return a(b*e.C_DEG_TO_256,256)};e.log2=function(a){return Math.log(a)*b};e.sqr=function(a){return a*a};e.clamp=function(a,b,f){return Math.min(Math.max(a,b),f)};e.interpolate=function(a,b,f){return a*
(1-f)+b*f};e.between=function(a,b,f){return a>=b&&a<=f||a>=f&&a<=b}})},"esri/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils ./StencilClipGenerator".split(" "),function(m,e,a,b,c,d,f,h,g,n){return function(b){function f(){b.call(this);this.isInitialized=!1;this._displayHeight=this._displayWidth=0;this._clip=
new n;this._tileCoordinateScale=c.create();this._orientationVec=c.create();this._displayScale=c.create();this._orientationVec.set([0,0,1]);this._defaultTransform=d.create()}a(f,b);f.prototype.initialize=function(a,b,c,d){this._renderer=new h(a,b);this._tileInfoView=d;this._tileInfo=c;this.isInitialized=!0};f.prototype.prepareChildrenRenderParameters=function(a){var b=a.state;if(!b||!this._tileInfo||!this.isInitialized)return a;a.displayLevel=this._tileInfo.scaleToZoom(b.scale);a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level;
a.renderer=this._renderer;return a};f.prototype.renderChildren=function(a){if(!(0===this.children.length||!this.isInitialized||!a||!a.state)){this.sortChildren(function(a,b){return b.resolution-a.resolution});this._clip.update(this.children);this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);var c=a.context;c.setDepthWriteEnabled(!0);this._renderer.setStateParams(a.state,a.devicePixelRatio,a.displayLevel);this._renderer.drawClippingMasks(c,this.children);
c.setStencilWriteMask(0);c.setBlendFunctionSeparate(1,771,1,771);c.setStencilOp(7680,7680,7681);c.setDepthFunction(515);c.setBlendingEnabled(!1);c.setStencilTestEnabled(!0);c.setDepthTestEnabled(!0);c.setDepthWriteEnabled(!0);a.drawphase=0;b.prototype.renderChildren.call(this,a);c.setDepthWriteEnabled(!1);c.setBlendingEnabled(!0);a.drawphase=1;b.prototype.renderChildren.call(this,a);a.drawphase=2;b.prototype.renderChildren.call(this,a);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);this._renderer.needsRedraw()&&
this.requestRender()}};f.prototype.attachChild=function(a,b){return a.attach(b)};f.prototype.detachChild=function(a,b){a.detach(b)};f.prototype.renderChild=function(a,b){a.render(b)};f.prototype._updateTilesTransform=function(a,b){var c=1/a.width,d=1/a.height,f=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lods[b].resolution,a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var e=0,g=this.children;e<g.length;e++){var h=g[e];a.toScreen(f,h.topLeft);
f[1]=a.height-f[1];h.tileTransform.displayCoord[0]=2*f[0]*c-1;h.tileTransform.displayCoord[1]=2*f[1]*d-1;h.key.level===b&&4096===h.coordRange?h.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfo.lods[h.key.level].resolution,a.resolution,a.rotation,this._tileInfo.size[1],h.coordRange,a.width,a.height,h.tileTransform.transform)}};f.prototype._calculateRelativeViewProjMat=function(a,b,c,f,e,h,k,l){var n=0.125;512!==f&&4096!==e&&(n=f/e);a=n*(a/b);this._tileCoordinateScale.set([a,
a,1]);if(h!==this._displayWidth||k!==this._displayHeight)this._displayScale.set([2/h,-2/k,1]),this._displayWidth=h,this._displayHeight=k;d.identity(l);d.scale(l,l,this._tileCoordinateScale);d.rotate(l,l,-c*g.C_DEG_TO_RAD,this._orientationVec);d.scale(l,l,this._displayScale);d.transpose(l,l)};return f}(f)})},"esri/core/libs/gl-matrix/vec3":function(){define(["./common"],function(m){var e={create:function(){var a=new m.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new m.ARRAY_TYPE(3);
b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new m.ARRAY_TYPE(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a};e.mul=e.multiply;
e.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};e.div=e.divide;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};
e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};e.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;return a};e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],f=b[2]-a[2];return Math.sqrt(c*c+d*d+f*f)};e.dist=e.distance;e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],f=b[2]-a[2];return c*c+d*d+f*f};e.sqrDist=e.squaredDistance;e.length=
function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};e.len=e.length;e.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};e.sqrLen=e.squaredLength;e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};e.normalize=function(a,b){var c=b[0],d=b[1],f=b[2],c=c*c+d*d+f*f;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*
b[2]};e.cross=function(a,b,c){var d=b[0],f=b[1];b=b[2];var e=c[0],g=c[1];c=c[2];a[0]=f*c-b*g;a[1]=b*e-d*c;a[2]=d*g-f*e;return a};e.lerp=function(a,b,c,d){var f=b[0],e=b[1];b=b[2];a[0]=f+d*(c[0]-f);a[1]=e+d*(c[1]-e);a[2]=b+d*(c[2]-b);return a};e.hermite=function(a,b,c,d,f,e){var g=e*e,n=g*(2*e-3)+1,k=g*(e-2)+e,l=g*(e-1);e=g*(3-2*e);a[0]=b[0]*n+c[0]*k+d[0]*l+f[0]*e;a[1]=b[1]*n+c[1]*k+d[1]*l+f[1]*e;a[2]=b[2]*n+c[2]*k+d[2]*l+f[2]*e;return a};e.bezier=function(a,b,c,d,f,e){var g=1-e,n=g*g,k=e*e,l=n*g,
n=3*e*n,g=3*k*g;e*=k;a[0]=b[0]*l+c[0]*n+d[0]*g+f[0]*e;a[1]=b[1]*l+c[1]*n+d[1]*g+f[1]*e;a[2]=b[2]*l+c[2]*n+d[2]*g+f[2]*e;return a};e.random=function(a,b){b=b||1;var c=2*m.RANDOM()*Math.PI,d=2*m.RANDOM()-1,f=Math.sqrt(1-d*d)*b;a[0]=Math.cos(c)*f;a[1]=Math.sin(c)*f;a[2]=d*b;return a};e.transformMat4=function(a,b,c){var d=b[0],f=b[1];b=b[2];var e=c[3]*d+c[7]*f+c[11]*b+c[15],e=e||1;a[0]=(c[0]*d+c[4]*f+c[8]*b+c[12])/e;a[1]=(c[1]*d+c[5]*f+c[9]*b+c[13])/e;a[2]=(c[2]*d+c[6]*f+c[10]*b+c[14])/e;return a};e.transformMat3=
function(a,b,c){var d=b[0],f=b[1];b=b[2];a[0]=d*c[0]+f*c[3]+b*c[6];a[1]=d*c[1]+f*c[4]+b*c[7];a[2]=d*c[2]+f*c[5]+b*c[8];return a};e.transformQuat=function(a,b,c){var d=b[0],f=b[1],e=b[2];b=c[0];var g=c[1],n=c[2];c=c[3];var k=c*d+g*e-n*f,l=c*f+n*d-b*e,p=c*e+b*f-g*d,d=-b*d-g*f-n*e;a[0]=k*c+d*-b+l*-n-p*-g;a[1]=l*c+d*-g+p*-b-k*-n;a[2]=p*c+d*-n+k*-g-l*-b;return a};e.rotateX=function(a,b,c,d){var f=[],e=[];f[0]=b[0]-c[0];f[1]=b[1]-c[1];f[2]=b[2]-c[2];e[0]=f[0];e[1]=f[1]*Math.cos(d)-f[2]*Math.sin(d);e[2]=
f[1]*Math.sin(d)+f[2]*Math.cos(d);a[0]=e[0]+c[0];a[1]=e[1]+c[1];a[2]=e[2]+c[2];return a};e.rotateY=function(a,b,c,d){var f=[],e=[];f[0]=b[0]-c[0];f[1]=b[1]-c[1];f[2]=b[2]-c[2];e[0]=f[2]*Math.sin(d)+f[0]*Math.cos(d);e[1]=f[1];e[2]=f[2]*Math.cos(d)-f[0]*Math.sin(d);a[0]=e[0]+c[0];a[1]=e[1]+c[1];a[2]=e[2]+c[2];return a};e.rotateZ=function(a,b,c,d){var f=[],e=[];f[0]=b[0]-c[0];f[1]=b[1]-c[1];f[2]=b[2]-c[2];e[0]=f[0]*Math.cos(d)-f[1]*Math.sin(d);e[1]=f[0]*Math.sin(d)+f[1]*Math.cos(d);e[2]=f[2];a[0]=e[0]+
c[0];a[1]=e[1]+c[1];a[2]=e[2]+c[2];return a};e.forEach=function(){var a=e.create();return function(b,c,d,f,e,g){c||(c=3);d||(d=0);for(f=f?Math.min(f*c+d,b.length):b.length;d<f;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],e(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();e.angle=function(a,b){var c=e.fromValues(a[0],a[1],a[2]),d=e.fromValues(b[0],b[1],b[2]);e.normalize(c,c);e.normalize(d,d);c=e.dot(c,d);return 1<c?0:Math.acos(c)};e.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};e.exactEquals=
function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};e.equals=function(a,b){var c=a[0],d=a[1],f=a[2],e=b[0],g=b[1],n=b[2];return Math.abs(c-e)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&Math.abs(d-g)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))&&Math.abs(f-n)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(n))};return e})},"esri/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),
function(m,e,a,b,c,d,f,h,g,n){return function(){function e(a,b,k){void 0===k&&(k=!0);this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._state={rotation:0,width:0,height:0};this._cachedRotation=this._cachedHeight=this._cachedWidth=0;this._pixelRatio=1;this._SpriteMosaic=a;this._glyphMosaic=b;this._ignoreSpeed=!k;this._backgroundRenderer=new c;this._lineRenderer=new d;this._fillRenderer=new f;this._symbolRenderer=new h;this._tileInfoRenderer=
new g;this._fadeRecorder=new n.FadeRecorder(300);this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=new Float32Array([1,0,0,1])}e.prototype.setStateParams=function(c,d,f){this._pixelRatio=d;this._fadeRecorder.recordLevel(f);this._state=c;if(this._state.width!==this._cachedWidth||this._state.height!==this._cachedHeight||this._state.rotation!==this._cachedRotation)this._extrudeScaleVector[0]=2/c.width,this._extrudeScaleVector[1]=-2/c.height,
a.identity(this._extrudeMatrix),a.rotate(this._extrudeMatrix,this._extrudeMatrix,-c.rotation*b.C_DEG_TO_RAD,this._extrudeRotateVector),a.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector),a.transpose(this._extrudeMatrix,this._extrudeMatrix),a.identity(this._extrudeNoRotationMatrix),a.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector),a.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix),this._cachedWidth=this._state.width,
this._cachedHeight=this._state.height,this._cachedRotation=this._state.rotation};e.prototype.drawClippingMasks=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var c=0;c<b.length;c++){var d=b[c];d.attached&&d.visible&&(a.setStencilFunctionSeparate(1032,519,d.stencilData.reference,d.stencilData.mask),
a.setStencilWriteMask(d.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,{u_matrix:d.tileTransform.transform,u_normalized_origin:d.tileTransform.displayCoord,u_coord_range:d.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0);a.setStencilWriteMask(255)}};e.prototype.renderDebug=function(a,b){var c=b.key;this._backgroundColor.set([c.col%2,c.row%2,0===c.col%2&&0===c.row%2?1:0,0.5]);this._backgroundRenderer.renderSolidColor(a,{u_matrix:b.tileTransform.transform,
u_normalized_origin:b.tileTransform.displayCoord,u_coord_range:b.coordRange,u_depth:0,u_color:this._backgroundColor})};e.prototype.renderBucket=function(a,b,c,d,f,e,g,h){switch(b.type){case 0:2!==f&&this._renderBackground(a,c,f,e,g,h);break;case 1:2!==f&&this._renderFill(a,b,c,f,e,g,h);break;case 2:1===f&&this._renderLine(a,b,c,e,g,h);break;case 3:2===f&&this._renderSymbol(a,b,c,d,e,g,h)}};e.prototype.renderTileInfo=function(a,b){this._tileInfoRenderer.render(a,b)};e.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()};
e.prototype._renderBackground=function(a,b,c,d,f,e){this._backgroundRenderer.render(a,b,c,d,f,this._SpriteMosaic,this._SpriteMosaic.pixelRatio,e)};e.prototype._renderLine=function(a,b,c,d,f,e){this._lineRenderer.render(a,b,c,this._state,d,f,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,e)};e.prototype._renderFill=function(a,b,c,d,f,e,g){this._fillRenderer.render(a,b,c,this._state.rotation,d,f,e,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio,g)};e.prototype._renderSymbol=
function(a,b,c,d,f,e,g){var h=!0;d===f.key.level&&(h=!1);a.setStencilTestEnabled(h);this._symbolRenderer.render(a,b,c,this._state.rotation,this._fadeRecorder.getFadeValues(this._ignoreSpeed),f,e,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio,g)};return e}()})},"esri/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject".split(" "),
function(m,e,a,b,c,d,f,h,g,n,k){return function(){function e(){this._patternMatrix=f.create();this._color=h.create();this._initialized=!1}e.prototype.renderSolidColor=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.u_matrix);this._solidProgram.setUniform2fv("u_normalized_origin",b.u_normalized_origin);this._solidProgram.setUniform1f("u_coord_range",b.u_coord_range||
4096);this._solidProgram.setUniform1f("u_depth",b.u_depth||0);this._solidProgram.setUniform4fv("u_color",b.u_color||new Float32Array([1,0,0,1]));a.drawArrays(5,0,4);a.bindVAO()};e.prototype.render=function(a,b,c,d,e,g,h,k){this._initialized||this._initialize(a);var l=e.getPaintValue("background-color",b);k*=e.getPaintValue("background-opacity",b);var n=e.getPaintValue("background-pattern",b),m=void 0!==n,y=l[3]*k,C=m||1>y;if(!(C&&0===c)&&(C||1!==c)){if(m){a.bindVAO(this._patternVertexArrayObject);
a.bindProgram(this._patternProgram);c=g.getMosaicItemPosition(n,!0);if(!c)return;b=d.coordRange/512/Math.pow(2,Math.floor(b)-d.key.level)/h;f.identity(this._patternMatrix);h=1/(c.size[1]*b);this._patternMatrix[0]=1/(c.size[0]*b);this._patternMatrix[4]=h;g.bind(a,9729,0);this._patternProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform);this._patternProgram.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord);this._patternProgram.setUniform1f("u_depth",e.z);this._patternProgram.setUniformMatrix3fv("u_pattern_matrix",
this._patternMatrix);this._patternProgram.setUniform1f("u_opacity",k);this._patternProgram.setUniform2f("u_pattern_tl",c.tl[0],c.tl[1]);this._patternProgram.setUniform2f("u_pattern_br",c.br[0],c.br[1]);this._patternProgram.setUniform1i("u_texture",0)}else this._color[0]=y*l[0],this._color[1]=y*l[1],this._color[2]=y*l[2],this._color[3]=y,a.bindVAO(this._solidVertexArrayObject),a.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",
d.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",d.coordRange),this._solidProgram.setUniform1f("u_depth",e.z||0),this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()}};e.prototype._initialize=function(f){if(this._initialized)return!0;var e={a_pos:0},h=new g(f,a,b,e);if(!h)return!1;var l=new g(f,c,d,e);if(!l)return!1;var s={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},t=new Int8Array([0,0,1,0,
0,1,1,1]),m=k.createVertex(f,35044,t),m=new n(f,e,s,{geometry:m}),t=new Int16Array([0,0,4096,0,0,4096,4096,4096]),t=k.createVertex(f,35044,t);f=new n(f,e,{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:t});this._solidProgram=h;this._patternProgram=l;this._vertexAttributes=s;this._solidVertexArrayObject=m;this._patternVertexArrayObject=f;return this._initialized=!0};return e}()})},"esri/core/libs/gl-matrix/mat3":function(){define(["./common"],function(m){var e=
{create:function(){var a=new m.ARRAY_TYPE(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new m.ARRAY_TYPE(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a},
fromValues:function(a,b,c,d,f,e,g,n,k){var l=new m.ARRAY_TYPE(9);l[0]=a;l[1]=b;l[2]=c;l[3]=d;l[4]=f;l[5]=e;l[6]=g;l[7]=n;l[8]=k;return l},set:function(a,b,c,d,f,e,g,n,k,l){a[0]=b;a[1]=c;a[2]=d;a[3]=f;a[4]=e;a[5]=g;a[6]=n;a[7]=k;a[8]=l;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],f=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=f}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],
a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],g=b[4],n=b[5],k=b[6],l=b[7],p=b[8],q=p*g-n*l,m=-p*e+n*k,r=l*e-g*k,s=c*q+d*m+f*r;if(!s)return null;s=1/s;a[0]=q*s;a[1]=(-p*d+f*l)*s;a[2]=(n*d-f*g)*s;a[3]=m*s;a[4]=(p*c-f*k)*s;a[5]=(-n*c+f*e)*s;a[6]=r*s;a[7]=(-l*c+d*k)*s;a[8]=(g*c-d*e)*s;return a},adjoint:function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],g=b[4],n=b[5],k=b[6],l=b[7],p=b[8];a[0]=g*p-n*l;a[1]=f*l-d*p;a[2]=d*n-f*g;a[3]=n*k-e*p;a[4]=c*p-f*
k;a[5]=f*e-c*n;a[6]=e*l-g*k;a[7]=d*k-c*l;a[8]=c*g-d*e;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],f=a[6],e=a[7],g=a[8];return a[0]*(g*c-d*e)+a[1]*(-g*b+d*f)+a[2]*(e*b-c*f)},multiply:function(a,b,c){var d=b[0],f=b[1],e=b[2],g=b[3],n=b[4],k=b[5],l=b[6],p=b[7];b=b[8];var q=c[0],m=c[1],r=c[2],s=c[3],t=c[4],u=c[5],D=c[6],w=c[7];c=c[8];a[0]=q*d+m*g+r*l;a[1]=q*f+m*n+r*p;a[2]=q*e+m*k+r*b;a[3]=s*d+t*g+u*l;a[4]=s*f+t*n+u*p;a[5]=s*e+t*k+u*b;a[6]=D*d+w*g+c*l;a[7]=D*f+w*n+c*p;a[8]=D*e+w*k+c*b;return a}};
e.mul=e.multiply;e.translate=function(a,b,c){var d=b[0],f=b[1],e=b[2],g=b[3],n=b[4],k=b[5],l=b[6],p=b[7];b=b[8];var q=c[0];c=c[1];a[0]=d;a[1]=f;a[2]=e;a[3]=g;a[4]=n;a[5]=k;a[6]=q*d+c*g+l;a[7]=q*f+c*n+p;a[8]=q*e+c*k+b;return a};e.rotate=function(a,b,c){var d=b[0],f=b[1],e=b[2],g=b[3],n=b[4],k=b[5],l=b[6],p=b[7];b=b[8];var q=Math.sin(c);c=Math.cos(c);a[0]=c*d+q*g;a[1]=c*f+q*n;a[2]=c*e+q*k;a[3]=c*g-q*d;a[4]=c*n-q*f;a[5]=c*k-q*e;a[6]=l;a[7]=p;a[8]=b;return a};e.scale=function(a,b,c){var d=c[0];c=c[1];
a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};e.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};e.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=-c;a[4]=d;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};e.fromMat2d=function(a,b){a[0]=b[0];
a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};e.fromQuat=function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],g=c+c,n=d+d,k=f+f,c=c*g,l=d*g,d=d*n,p=f*g,q=f*n,f=f*k,g=e*g,n=e*n,e=e*k;a[0]=1-d-f;a[3]=l-e;a[6]=p+n;a[1]=l+e;a[4]=1-c-f;a[7]=q-g;a[2]=p-n;a[5]=q+g;a[8]=1-c-d;return a};e.normalFromMat4=function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],g=b[4],n=b[5],k=b[6],l=b[7],p=b[8],q=b[9],m=b[10],r=b[11],s=b[12],t=b[13],u=b[14],D=b[15],w=c*n-d*g,x=c*k-f*g,z=c*l-e*g,y=d*k-f*n,C=
d*l-e*n,B=f*l-e*k,F=p*t-q*s,I=p*u-m*s,p=p*D-r*s,G=q*u-m*t,q=q*D-r*t,m=m*D-r*u,r=w*m-x*q+z*G+y*p-C*I+B*F;if(!r)return null;r=1/r;a[0]=(n*m-k*q+l*G)*r;a[1]=(k*p-g*m-l*I)*r;a[2]=(g*q-n*p+l*F)*r;a[3]=(f*q-d*m-e*G)*r;a[4]=(c*m-f*p+e*I)*r;a[5]=(d*p-c*q-e*F)*r;a[6]=(t*B-u*C+D*y)*r;a[7]=(u*z-s*B-D*x)*r;a[8]=(s*C-t*z+D*w)*r;return a};e.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};e.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+
Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};e.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a};e.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a};e.sub=e.subtract;e.multiplyScalar=
function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a};e.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;return a};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};e.equals=function(a,
b){var c=a[0],d=a[1],f=a[2],e=a[3],g=a[4],n=a[5],k=a[6],l=a[7],p=a[8],q=b[0],v=b[1],r=b[2],s=b[3],t=b[4],u=b[5],D=a[6],w=b[7],x=b[8];return Math.abs(c-q)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(q))&&Math.abs(d-v)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(v))&&Math.abs(f-r)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(r))&&Math.abs(e-s)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(g-t)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(t))&&Math.abs(n-u)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&
Math.abs(k-D)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(D))&&Math.abs(l-w)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(p-x)<=m.EPSILON*Math.max(1,Math.abs(p),Math.abs(x))};return e})},"esri/core/libs/gl-matrix/vec4":function(){define(["./common"],function(m){var e={create:function(){var a=new m.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new m.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,c,d){var f=new m.ARRAY_TYPE(4);
f[0]=a;f[1]=b;f[2]=c;f[3]=d;return f},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,c,d,f){a[0]=b;a[1]=c;a[2]=d;a[3]=f;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}};e.sub=e.subtract;e.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a};e.mul=e.multiply;e.divide=function(a,
b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a};e.div=e.divide;e.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};e.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a};e.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};e.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);
a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};e.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};e.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};e.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};e.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],f=b[2]-a[2],e=b[3]-a[3];return Math.sqrt(c*c+d*d+f*
f+e*e)};e.dist=e.distance;e.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],f=b[2]-a[2],e=b[3]-a[3];return c*c+d*d+f*f+e*e};e.sqrDist=e.squaredDistance;e.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};e.len=e.length;e.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};e.sqrLen=e.squaredLength;e.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};e.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=
1/b[2];a[3]=1/b[3];return a};e.normalize=function(a,b){var c=b[0],d=b[1],f=b[2],e=b[3],g=c*c+d*d+f*f+e*e;0<g&&(g=1/Math.sqrt(g),a[0]=c*g,a[1]=d*g,a[2]=f*g,a[3]=e*g);return a};e.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};e.lerp=function(a,b,c,d){var f=b[0],e=b[1],g=b[2];b=b[3];a[0]=f+d*(c[0]-f);a[1]=e+d*(c[1]-e);a[2]=g+d*(c[2]-g);a[3]=b+d*(c[3]-b);return a};e.random=function(a,b){b=b||1;a[0]=m.RANDOM();a[1]=m.RANDOM();a[2]=m.RANDOM();a[3]=m.RANDOM();e.normalize(a,a);e.scale(a,
a,b);return a};e.transformMat4=function(a,b,c){var d=b[0],f=b[1],e=b[2];b=b[3];a[0]=c[0]*d+c[4]*f+c[8]*e+c[12]*b;a[1]=c[1]*d+c[5]*f+c[9]*e+c[13]*b;a[2]=c[2]*d+c[6]*f+c[10]*e+c[14]*b;a[3]=c[3]*d+c[7]*f+c[11]*e+c[15]*b;return a};e.transformQuat=function(a,b,c){var d=b[0],f=b[1],e=b[2],g=c[0],n=c[1],k=c[2];c=c[3];var l=c*d+n*e-k*f,p=c*f+k*d-g*e,q=c*e+g*f-n*d,d=-g*d-n*f-k*e;a[0]=l*c+d*-g+p*-k-q*-n;a[1]=p*c+d*-n+q*-g-l*-k;a[2]=q*c+d*-k+l*-n-p*-g;a[3]=b[3];return a};e.forEach=function(){var a=e.create();
return function(b,c,d,e,h,g){c||(c=4);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],h(a,a,g),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();e.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};e.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};e.equals=function(a,b){var c=a[0],d=a[1],e=a[2],h=a[3],g=b[0],n=b[1],k=b[2],l=b[3];return Math.abs(c-g)<=m.EPSILON*Math.max(1,Math.abs(c),
Math.abs(g))&&Math.abs(d-n)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(n))&&Math.abs(e-k)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(k))&&Math.abs(h-l)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(l))};return e})},"esri/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 dojo/text!./shaders/lineShader.vs.glsl dojo/text!./shaders/lineShader.fs.glsl dojo/text!./shaders/patternLineShader.vs.glsl dojo/text!./shaders/patternLineShader.fs.glsl dojo/text!./shaders/lineJoinShader.vs.glsl dojo/text!./shaders/lineJoinShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(m,e,a,b,c,d,f,h,g,n,k,l,p,q,v){return function(){function e(){this._joinAttributeLocations={a_pos:0,a_vertexOffset:1};this._triangleAttributeLocations={a_pos:0,a_offset:1,a_accumulatedDistance:2};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=c.create();this._screenSize=d.create();this._color=b.create();this._dashArray=d.create()}e.prototype.render=function(b,c,d,e,f,g,h,k,l,p){if(0!==c.triangleElementCount){this._initialized||this._initialize(b);var n=f.tileTransform.transform,
q=f.coordRange/512,m=g.getPaintValue("line-translate",d);if(0!==m[0]||0!==m[1]){a.copy(this._viewProjMat,f.tileTransform.transform);var n=m[0],m=m[1],r=0,H=0,H=(1<<f.key.level)/Math.pow(2,d)*q,r=e.rotation;if(1===g.getPaintValue("line-translate-anchor",d))var J=Math.sin(v.C_DEG_TO_RAD*-r),A=Math.cos(v.C_DEG_TO_RAD*-r),r=H*(n*A-m*J),H=H*(n*J+m*A);else r=H*n,H*=m;this._offsetVector[0]=r;this._offsetVector[1]=H;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);
n=this._viewProjMat}J=g.getPaintValue("line-pattern",d);A=void 0!==J;r=1/l;m=g.getPaintValue("line-blur",d)+r;H=g.getPaintValue("line-width",d);r=0.5*(H+r);p*=g.getPaintValue("line-opacity",d);var E=g.getPaintValue("line-color",d),K=E[3]*p;this._color[0]=K*E[0];this._color[1]=K*E[1];this._color[2]=K*E[2];this._color[3]=K;if(1<r&&0<c.joinCount&&!A&&(this._screenSize[0]=0.5*e.width,this._screenSize[1]=0.5*e.height,e=Math.ceil(2*r),E=r-0.25,K=this._getJoinsVAO(b,f)))b.bindVAO(K),b.bindProgram(this._joinProgram),
K=1/(0<l?l:1),this._joinProgram.setUniformMatrix4fv("u_transformMatrix",n),this._joinProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._joinProgram.setUniform1f("u_depth",g.z),this._joinProgram.setUniform2fv("u_screen",this._screenSize),this._joinProgram.setUniform1f("u_size",e),this._joinProgram.setUniform4fv("u_color",this._color),this._joinProgram.setUniform1f("u_lineHalfWidth",E),this._joinProgram.setUniform1f("u_pixelRatio",l),this._joinProgram.setUniform1f("u_oneOverPixelRatio",
K),b.drawArrays(0,c.joinStart,c.joinCount),b.bindVAO();if(l=this._getTrianglesVAO(b,f)){b.bindVAO(l);if(A){if(d=h.getMosaicItemPosition(J,!0))h.bind(b,9729,0),b.bindProgram(this._patternLineProgram),this._patternLineProgram.setUniformMatrix4fv("u_transformMatrix",n),this._patternLineProgram.setUniformMatrix4fv("u_extrudeMatrix",k),this._patternLineProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._patternLineProgram.setUniform1f("u_depth",g.z),this._patternLineProgram.setUniform1f("u_lineHalfWidth",
r),this._patternLineProgram.setUniform1f("u_blur",m),this._patternLineProgram.setUniform1f("u_opacity",p),this._patternLineProgram.setUniform2f("u_pattern_tl",d.tl[0],d.tl[1]),this._patternLineProgram.setUniform2f("u_pattern_br",d.br[0],d.br[1]),this._patternLineProgram.setUniform2f("u_spriteSize",q*d.size[0],d.size[1]),this._patternLineProgram.setUniform1i("u_texture",0)}else h=g.getPaintValue("line-dasharray",d),2>h.length&&(h=[1,-1]),q*=H,this._dashArray[0]=q*h[0],this._dashArray[1]=q*h[1],b.bindProgram(this._triangleslProgram),
this._triangleslProgram.setUniformMatrix4fv("u_transformMatrix",n),this._triangleslProgram.setUniformMatrix4fv("u_extrudeMatrix",k),this._triangleslProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._triangleslProgram.setUniform1f("u_depth",g.z),this._triangleslProgram.setUniform4fv("u_color",this._color),this._triangleslProgram.setUniform1f("u_lineHalfWidth",r),this._triangleslProgram.setUniform2fv("u_dasharray",this._dashArray),this._triangleslProgram.setUniform1f("u_blur",
m);b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart);b.bindVAO()}}};e.prototype._initialize=function(a){if(this._initialized)return!0;var b=new p(a,f,h,this._triangleAttributeLocations),c=new p(a,g,n,this._triangleAttributeLocations);a=new p(a,k,l,this._joinAttributeLocations);this._triangleslProgram=b;this._patternLineProgram=c;this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5122,
offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:12,normalized:!1,divisor:0}]};this._joinProgram=a;this._joinVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getTrianglesVAO=function(a,b){if(b.lineTrianglesVertexArrayObject)return b.lineTrianglesVertexArrayObject;var c=b.lineVertexBuffer,d=b.lineTrianglesIndexBuffer;if(!c||!d)return null;b.lineTrianglesVertexArrayObject=
new q(a,this._triangleAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.lineTrianglesVertexArrayObject};e.prototype._getJoinsVAO=function(a,b){if(b.lineJoinsVertexArrayObject)return b.lineJoinsVertexArrayObject;var c=b.lineJoinVertexBuffer;if(!c)return null;b.lineJoinsVertexArrayObject=new q(a,this._joinAttributeLocations,this._joinVertexAttributes,{geometry:c});return b.lineJoinsVertexArrayObject};return e}()})},"esri/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/solidFillShader.vs.glsl dojo/text!./shaders/solidFillShader.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl dojo/text!./shaders/fillOutlineShader.vs.glsl dojo/text!./shaders/fillOutlineShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(m,e,a,b,c,d,f,h,g,n,k,l,p,q,v){var r=1/65536;return function(){function e(){this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._fillAttributeLocations={a_pos:0};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=d.create();this._patternMatrix=b.create();this._color=c.create();this._outlineColor=c.create()}e.prototype.render=function(c,d,e,f,g,h,k,l,p,n,q){this._initialized||this._initialize(c);var m=k.getPaintValue("fill-pattern",e),s=void 0!==m;if(!(s&&
0===g)){var H=k.getPaintValue("fill-antialias",e)&&!s;q*=k.getPaintValue("fill-opacity",e);var J=k.getPaintValue("fill-color",e),A=!1;if(!s){var E=J[3]*q;1===E&&0===g&&(A=!0);1>E&&1===g&&(A=!0)}if(A||0!==g){var K=h.tileTransform.transform,E=h.coordRange/512,M=k.getPaintValue("fill-translate",e);if(0!==M[0]||0!==M[1]){a.copy(this._viewProjMat,h.tileTransform.transform);var K=M[0],M=M[1],O=0,N=0,E=(1<<h.key.level)/Math.pow(2,e)*E;1===k.getPaintValue("fill-translate-anchor",e)?(N=Math.sin(v.C_DEG_TO_RAD*
-f),f=Math.cos(v.C_DEG_TO_RAD*-f),O=E*(K*f-M*N),N=E*(K*N+M*f)):(O=E*K,N=E*M);this._offsetVector[0]=O;this._offsetVector[1]=N;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);K=this._viewProjMat}if(f=this._getTrianglesVAO(c,h)){if(s){if(1===g&&(m=l.getMosaicItemPosition(m,!0)))E=h.coordRange/512/Math.pow(2,Math.round(e)-h.key.level)/n,b.identity(this._patternMatrix),s=1/(m.size[1]*E),this._patternMatrix[0]=1/(m.size[0]*E),this._patternMatrix[4]=s,c.bindVAO(f),
l.bind(c,9729,0),c.bindProgram(this._patternFillProgram),this._patternFillProgram.setUniformMatrix4fv("u_transformMatrix",K),this._patternFillProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._patternFillProgram.setUniform1f("u_depth",k.z),this._patternFillProgram.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),this._patternFillProgram.setUniform1f("u_opacity",q),this._patternFillProgram.setUniform2f("u_pattern_tl",m.tl[0],m.tl[1]),this._patternFillProgram.setUniform2f("u_pattern_br",
m.br[0],m.br[1]),this._patternFillProgram.setUniform1i("u_texture",0),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart),c.bindVAO()}else A&&(E=J[3]*q,this._color[0]=E*J[0],this._color[1]=E*J[1],this._color[2]=E*J[2],this._color[3]=E,c.bindVAO(f),c.bindProgram(this._solidFillProgram),this._solidFillProgram.setUniformMatrix4fv("u_transformMatrix",K),this._solidFillProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._solidFillProgram.setUniform1f("u_depth",
k.z+r),this._solidFillProgram.setUniform4fv("u_color",this._color),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart),c.bindVAO());if(H&&0<d.outlineElementCount&&1===g){e=k.getPaintValue("fill-outline-color",e);if(0===e[3]){if(1!==this._color[3])return;e=J}n=0.75/n;q*=e[3];this._outlineColor[0]=q*e[0];this._outlineColor[1]=q*e[1];this._outlineColor[2]=q*e[2];this._outlineColor[3]=q;if(q=this._getOutlineVAO(c,h))c.bindVAO(q),c.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",
K),this._outlineProgram.setUniformMatrix4fv("u_extrudeMatrix",p),this._outlineProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_depth",k.z),this._outlineProgram.setUniform1f("u_outline_width",n),this._outlineProgram.setUniform4fv("u_color",this._outlineColor),c.drawElements(4,d.outlineElementCount,5125,12*d.outlineElementStart),c.bindVAO()}}}}};e.prototype._initialize=function(a){if(this._initialized)return!0;var b=new p(a,f,h,{a_pos:0});
if(!b)return!1;var c=new p(a,g,n,this._fillAttributeLocations);if(!c)return!1;a=new p(a,k,l,this._outlineAttributeLocations);this._solidFillProgram=b;this._patternFillProgram=c;this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};this._outlineProgram=a;this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,
divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getTrianglesVAO=function(a,b){if(b.polygonTrianglesVertexArrayObject)return b.polygonTrianglesVertexArrayObject;var c=b.polygonTrianglesVertexBuffer,d=b.polygonTrianglesIndexBuffer;if(!c||!d)return null;b.polygonTrianglesVertexArrayObject=new q(a,this._fillAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.polygonTrianglesVertexArrayObject};
e.prototype._getOutlineVAO=function(a,b){if(b.polygonOutlineVertexArrayObject)return b.polygonOutlineVertexArrayObject;var c=b.polygonOutlinesVertexBuffer,d=b.polygonOutlinesIndexBuffer;if(!c||!d)return null;b.polygonOutlineVertexArrayObject=new q(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:c},d);return b.polygonOutlineVertexArrayObject};return e}()})},"esri/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require","exports","./IconRenderer","./SDFRenderer"],
function(m,e,a,b){return function(){function c(){this._iconRenderer=new a;this._sdfRenderer=new b}c.prototype.render=function(a,b,c,e,n,k,l,p,q,m,r,s,t){b.hasData()&&(0<b.marketElementCount&&!b.isSDF&&this._iconRenderer.render(a,b,c,e,n,k,l,p,m,r,t),0<b.textElementCount&&this._sdfRenderer.render(a,b,c,e,n,k,l,q,m,r,s,t))};return c}()})},"esri/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/iconShader.vs.glsl dojo/text!./shaders/iconShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(m,e,a,b,c,d,f,h,g){return function(){function e(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._extrudeMat=a.create();this._scaleVec=b.create()}e.prototype.render=function(b,c,d,e,f,h,n,m,u,D,w){this._initialized||this._initialize(b);w*=n.getPaintValue("icon-opacity",d);var x=n.getLayoutValue("icon-rotation-alignment",d);1===x&&1===n.getLayoutValue("symbol-placement",d)&&!n.hasLayoutProperty("icon-rotation-alignment")&&
(x=0);var z=0===x,x=n.getLayoutValue("icon-keep-upright",d)&&z,y=n.getLayoutValue("icon-size",d);e=g.degToByte(e);this._spritesTextureSize[0]=m.width/4;this._spritesTextureSize[1]=m.height/4;z?a.copy(this._extrudeMat,u):a.copy(this._extrudeMat,D);1!==y&&(this._scaleVec[0]=y,this._scaleVec[1]=y,this._scaleVec[2]=1,a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec));m.bind(b,9729,0);b.bindProgram(this._iconProgram);if(m=this._getIconVAO(b,h))b.bindVAO(m),this._iconProgram.setUniformMatrix4fv("u_transformMatrix",
h.tileTransform.transform),this._iconProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._iconProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._iconProgram.setUniform1f("u_depth",n.z),this._iconProgram.setUniform2fv("u_mosaicSize",this._spritesTextureSize),this._iconProgram.setUniform1f("u_mapRotation",e),this._iconProgram.setUniform1f("u_keepUpright",x?1:0),this._iconProgram.setUniform1f("u_level",10*d),this._iconProgram.setUniform1f("u_fadeSpeed",10*
f.fadeSpeed),this._iconProgram.setUniform1f("u_minfadeLevel",10*f.minfadeLevel),this._iconProgram.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel),this._iconProgram.setUniform1f("u_fadeChange",10*(d+f.fadeChange)),this._iconProgram.setUniform1f("u_opacity",w),this._iconProgram.setUniform1i("u_texture",0),b.drawElements(4,c.marketElementCount,5125,12*c.markerElementStart),b.bindVAO()};e.prototype._initialize=function(a){if(this._initialized)return!0;this._iconProgram=new f(a,c,d,this._attributeLocations);
this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getIconVAO=function(a,b){if(b.iconVertexArrayObject)return b.iconVertexArrayObject;var c=b.iconVertexBuffer,
d=b.iconIndexBuffer;if(!c||!d)return null;b.iconVertexArrayObject=new h(a,this._attributeLocations,this._iconVertexAttributes,{geometry:c},d);return b.iconVertexArrayObject};return e}()})},"esri/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/sdfShader.vs.glsl dojo/text!./shaders/sdfShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(m,e,a,b,c,d,f,h,g,n){return function(){function e(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._initialized=!1;this._extrudeMat=a.create();this._haloColor=b.create();this._sdfColor=b.create();this._scaleVec=c.create()}e.prototype.render=function(b,c,d,e,f,g,h,k,m,w,x,z){this._initialized||this._initialize(b);var y=h.getLayoutValue("text-size",d),C=y/24;e=n.degToByte(e);var B=h.getLayoutValue("text-rotation-alignment",d);1===B&&1===h.getLayoutValue("symbol-placement",
d)&&!h.hasLayoutProperty("text-rotation-alignment")&&(B=0);var F=0===B,B=h.getLayoutValue("text-keep-upright",d)&&F;x=0.1*24/y/x;z*=h.getPaintValue("text-opacity",d);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([k.width/4,k.height/4]));F?a.copy(this._extrudeMat,m):a.copy(this._extrudeMat,w);this._scaleVec[0]=C;this._scaleVec[1]=C;this._scaleVec[2]=1;a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);k.bind(b,9729,0);b.bindProgram(this._sdfProgram);if(k=this._getSDFVAO(b,
g))b.bindVAO(k),this._sdfProgram.setUniformMatrix4fv("u_transformMatrix",g.tileTransform.transform),this._sdfProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._sdfProgram.setUniform2fv("u_normalized_origin",g.tileTransform.displayCoord),this._sdfProgram.setUniform1f("u_depth",h.z),this._sdfProgram.setUniform2fv("u_mosaicSize",this._glyphTextureSize),this._sdfProgram.setUniform1f("u_mapRotation",e),this._sdfProgram.setUniform1f("u_keepUpright",B?1:0),this._sdfProgram.setUniform1f("u_level",
10*d),this._sdfProgram.setUniform1f("u_fadeSpeed",10*f.fadeSpeed),this._sdfProgram.setUniform1f("u_minfadeLevel",10*f.minfadeLevel),this._sdfProgram.setUniform1f("u_maxfadeLevel",10*f.maxfadeLevel),this._sdfProgram.setUniform1f("u_fadeChange",10*(d+f.fadeChange)),this._sdfProgram.setUniform1f("u_opacity",z),this._sdfProgram.setUniform1i("u_texture",0),f=h.getPaintValue("text-halo-color",d),0<f[3]&&(g=f[3]*z,this._haloColor[0]=g*f[0],this._haloColor[1]=g*f[1],this._haloColor[2]=g*f[2],this._haloColor[3]=
g,f=x+h.getPaintValue("text-halo-blur",d)/C/8,C=0.75-h.getPaintValue("text-halo-width",d)/C/8,this._sdfProgram.setUniform4fv("u_color",this._haloColor),this._sdfProgram.setUniform1f("u_edgeDistance",C),this._sdfProgram.setUniform1f("u_edgeWidth",f),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart)),d=h.getPaintValue("text-color",d),0<d[3]&&(h=d[3]*z,this._sdfColor[0]=h*d[0],this._sdfColor[1]=h*d[1],this._sdfColor[2]=h*d[2],this._sdfColor[3]=h,this._sdfProgram.setUniform4fv("u_color",
this._sdfColor),this._sdfProgram.setUniform1f("u_edgeDistance",0.75),this._sdfProgram.setUniform1f("u_edgeWidth",x),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart),b.bindVAO())};e.prototype._initialize=function(a){if(this._initialized)return!0;this._sdfProgram=new h(a,d,f,this._attributeLocations);this._sdfVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,
divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};e.prototype._getSDFVAO=function(a,b){if(b.textVertexArrayObject)return b.textVertexArrayObject;var c=b.textVertexBuffer,d=b.textIndexBuffer;if(!c||!d)return null;b.textVertexArrayObject=new g(a,this._attributeLocations,this._sdfVertexAttributes,{geometry:c},d);return b.textVertexArrayObject};return e}()})},
"esri/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils".split(" "),function(m,e,a,b,c,d,f,h,g,n,k){return function(){function e(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}
e.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);
a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",
8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())};e.prototype._initialize=function(e){if(this._initialized)return!0;var k={a_pos:0},l=new f(e,a,b,k),n=new f(e,c,d,k),m={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},t=new Int8Array([0,0,1,0,1,1,0,1]),t=g.createVertex(e,35044,t),t=new h(e,k,m,{geometry:t}),u=new Int8Array([0,0,1,0,0,1,1,1]),u=g.createVertex(e,35044,u);e=new h(e,k,
m,{geometry:u});this._outlineProgram=l;this._tileInfoProgram=n;this._vertexAttributes=m;this._outlineVertexArrayObject=t;this._tileInfoVertexArrayObject=e;return this._initialized=!0};e.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,
d=this._canvas.getContext("2d");d.font="24px sans-serif";d.textAlign="left";d.textBaseline="middle";var e=d.measureText(c),e=Math.pow(2,Math.ceil(k.log2(e.width+2)));e>this._maxWidth&&(this._maxWidth=e);d.clearRect(0,0,this._maxWidth,32);d.fillStyle=b.key.level>b.refKey.level?"red":"blue";d.fillText(c,0,16);b.texture=new n(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas);return b.texture};return e}()})},"esri/views/vectorTiles/renderers/FadeRecorder":function(){define(["require",
"exports","../../../core/now"],function(m,e,a){(function(){return function(a,c){this.level=a;this.now=c}})();m=function(){return function(a,c,d,e){this.fadeSpeed=a;this.minfadeLevel=c;this.maxfadeLevel=d;this.fadeChange=e}}();e.FadeProperties=m;m=function(){function b(a){void 0===a&&(a=300);this._levelSnapshots=[];this._duration=a}b.prototype.recordLevel=function(b){var d=a(),e=this._levelSnapshots;0===e.length&&(e.push({level:b,now:0}),e.push({level:b,now:0}));(2===e.length||e[0].level!==b)&&e.push({level:b,
now:d})};b.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var a=this._duration,b=this._levelSnapshots,e=b.length,h=b[e-1],g=-1;e>g+1&&b[g+1].now+a<h.now;)g++;for(0>g&&(g=0);g<e;g++)if(b[g].level!==h.level)return!0;return!1};b.prototype.getFadeValues=function(b){void 0===b&&(b=!1);for(var d=this._duration,e=a(),h=this._levelSnapshots;3<h.length&&h[1].now+d<e;)h.shift();h[1].now+d<e&&(h[0].level=h[1].level);var g=h[0].level,m=h[h.length-1],k=m.level,l=Math.min(g,k),
g=Math.max(g,k),h=(m.level-h[1].level)/((m.now-h[1].now)/d);return b?{fadeSpeed:0,minfadeLevel:l,maxfadeLevel:g,fadeChange:0}:{fadeSpeed:h,minfadeLevel:l,maxfadeLevel:g,fadeChange:(e-m.now)/d*h}};return b}();e.FadeRecorder=m})},"esri/views/vectorTiles/StencilClipGenerator":function(){define(["require","exports","./GeometryUtils"],function(m,e,a){var b=function(){function a(b){this.children=[];this.stageTile=b}a.prototype.tryAdd=function(b){if(a.isChildOf(b,this.stageTile.key)){for(var e=0,h=this.children;e<
h.length;e++)if(a.isChildOf(b,h[e]))return;this.children.push(b)}};a.prototype.equals=function(a){if(this.stageTile.key.id!==a.stageTile.key.id||this.children.length!==a.children.length)return!1;for(var b=0;b<this.children.length;b++)if(this.children[b].id!==a.children[b].id)return!1;return!0};a.isChildOf=function(a,b){if(a.level<=b.level)return!1;var c=a.level-b.level,e=a.col>>c;return a.row>>c===b.row&&e===b.col};return a}();return function(){function c(){this._tileGroups=[];this._bitOffset=0}c.prototype.update=
function(c){this._tileGroups=[];this._bitOffset=0;if(0!==c.length){for(var e=[],h=c.length,g=0;g<h;g++)if(c[g].attached&&c[g].visible){for(var m=new b(c[g]),k=g+1;k<h;k++)m.tryAdd(c[k].key);m.children.sort(function(a,b){return a.level<b.level?-1:1});this._reuseExisting(m)||e.push(m)}if(0<e.length){c=Math.ceil(a.log2(e.length+1));h=(1<<c)-1<<this._bitOffset;g=1;m=void 0;for(k=0;k<e.length;k++){var l=e[k],m=g++<<this._bitOffset;l.stageTile.stencilData.mask=h;l.stageTile.stencilData.reference=m}this._bitOffset+=
c;this._tileGroups.push(e)}}};c.prototype._reuseExisting=function(a){for(var b=0,c=this._tileGroups;b<c.length;b++)for(var e=0,m=c[b];e<m.length;e++){var k=m[e];if(k.equals(a)&&k.stageTile.stencilData.mask===a.stageTile.stencilData.mask&&k.stageTile.stencilData.reference===a.stageTile.stencilData.reference)return!0}return!1};return c}()})},"url:esri/views/vectorTiles/renderers/shaders/background.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_coord_range;\r\nuniform mediump float u_depth;\r\n\r\nvoid main() {\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main() {\r\n  gl_FragColor \x3d u_color;\r\n}","url:esri/views/vectorTiles/renderers/shaders/patternFillShader.vs.glsl":"uniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump mat3 u_pattern_matrix; // can we use meduim precision??\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\r\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\r\n  // (-4k to 8k -1) to texture coordinates.\r\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/patternFillShader.fs.glsl":"uniform lowp float u_opacity;\r\nuniform mediump vec2 u_pattern_tl;\r\nuniform mediump vec2 u_pattern_br;\r\nuniform sampler2D u_texture;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\r\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\r\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\r\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\r\n  // we need to only sample from area that has our sprite in the mosaic.\r\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\r\n  // sample the sprite mosaic\r\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\r\n  gl_FragColor \x3d u_opacity * color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineShader.vs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute float a_accumulatedDistance;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the inset and outset of the line\r\nuniform mediump float u_lineHalfWidth;\r\n// the interpolated normal to the line. the information is packed into the LSB of the vertex coordinate\r\nvarying mediump vec2 v_normal;\r\n// the accumulated distance along the line. We need this information in order to render the dashes.\r\nvarying highp float v_accumulatedDistance;\r\n\r\nconst float scale \x3d 1.0 / 31.0;\r\n\r\nvoid main()\r\n{\r\n  // extract the normal from the list significat bit. It has a value of 0 or 1, but we need it to be either -1 or 1 therefore\r\n  // we need to change 0 to -1.\r\n  lowp vec2 normal \x3d mod(a_pos, 2.0);\r\n  normal.y \x3d normal.y \x3d\x3d 0.0 ? -1.0 : 1.0;\r\n  v_normal \x3d normal;\r\n\r\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offset * scale;\r\n\r\n  // transform the vertex\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n  v_accumulatedDistance \x3d a_accumulatedDistance;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineShader.fs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nuniform mediump float u_lineHalfWidth;\r\nuniform lowp vec4 u_color;\r\nuniform mediump vec2 u_dasharray;\r\nuniform lowp float u_blur;\r\n\r\nvarying mediump vec2 v_normal;\r\nvarying highp float v_accumulatedDistance;\r\n\r\nvoid main()\r\n{\r\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\r\n\r\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n  // We need to count for both sides of the line.\r\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\r\n\r\n  // now calculate the dashes given the accumulated distance of the line:\r\n  // start with calculating a normalized position along the line\r\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, u_dasharray.x + u_dasharray.y);\r\n\r\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\r\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\r\n  //   | \x3c--- pos along the dash part\r\n  // -------_______-------_______\r\n  // when the dashPos is over the 'gap' part of the dash u_dasharray.x - dashPos is negative and therefore the alpha will\r\n  // get clamped to zero.\r\n  // when u_dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\r\n  // along the direction of the line.\r\n  lowp float dashAlpha \x3d clamp( min(dashPos, u_dasharray.x - dashPos), 0.0, 1.0);\r\n\r\n  // if we don't have a no-data part to the dash then it is a solid line\r\n  dashAlpha \x3d max(sign(-u_dasharray.y), dashAlpha); //sign(-u_dasharray.y) \x3e 0.0 ? 1.0 : dashAlpha;\r\n  // finally multiply the fragment's alpha by the calculated dash-alpha\r\n  alpha *\x3d dashAlpha;\r\n\r\n  // output the fragment color\r\n gl_FragColor \x3d alpha * u_color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/patternLineShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute float a_accumulatedDistance;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the inset and outset of the line\r\nuniform mediump float u_lineHalfWidth;\r\n// the interpolated normal to the line. the information is packed into the LSB of the vertex coordinate\r\nvarying mediump vec2 v_normal;\r\n// the accumulated distance along the line. We need this information in order to render the dashes.\r\nvarying highp float v_accumulatedDistance;\r\n\r\nconst float scale \x3d 1.0 / 31.0;\r\n\r\nvoid main()\r\n{\r\n  // extract the normal from the list significat bit. It has a value of 0 or 1, but we need it to be either -1 or 1 therefore\r\n  // we need to change 0 to -1.\r\n  lowp vec2 normal \x3d mod(a_pos, 2.0);\r\n  normal.y \x3d normal.y \x3d\x3d 0.0 ? -1.0 : 1.0;\r\n  v_normal \x3d normal;\r\n\r\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec2 dist \x3d u_lineHalfWidth * a_offset * scale;\r\n\r\n  // transform the vertex\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n  v_accumulatedDistance \x3d a_accumulatedDistance;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/patternLineShader.fs.glsl":"uniform mediump float u_lineHalfWidth;\r\nuniform lowp float u_blur;\r\nuniform lowp float u_opacity;\r\nuniform mediump vec2 u_pattern_tl;\r\nuniform mediump vec2 u_pattern_br;\r\nuniform mediump vec2 u_spriteSize;\r\nuniform sampler2D u_texture;\r\n\r\nvarying mediump vec2 v_normal;\r\nvarying highp float v_accumulatedDistance;\r\n\r\nvoid main()\r\n{\r\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\r\n\r\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n  // We need to count for both sides of the line.\r\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\r\n  // add the line's opacity to the alpha\r\n  alpha *\x3d u_opacity;\r\n\r\n  // we need to calculate the relative portion of the line texture along the line given the accumulated distance aliong the line\r\n  // The computed value should is anumber btween 0 and 1 which will later be used to interpolate btween the BR and TL values\r\n  mediump float relativeTexX \x3d mod(v_accumulatedDistance / u_spriteSize.x, 1.0);\r\n\r\n  // in order to calculate the texture coordinates prependicular to the line (Y axis), we use the interpolated normal values\r\n  // which range from -1.0 to 1.0. On the line's centerline, the value of the interpolated normal is 0.0, however the relative\r\n  // texture value shpould be 0.5 (given that at the bottom of the line, the texture coordinate must be equal to 0.0)\r\n  // (TL) ---------------------------      --\x3e left edge of line. Interpolatedf normal is 1.0\r\n  //              | -\x3e linwe-width / 2\r\n  //      - - - - - - - - - - - - - -\r\n  //              | -\x3e linwe-width / 2\r\n  //      ---------------------------- (BR)--\x3e right edge of line. Interpolatedf normal is -1.0\r\n\r\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * u_lineHalfWidth / u_spriteSize.y);\r\n\r\n  // claculate the actual texture coordinates by interpolating between the TL/BR pattern coordinates\r\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\r\n\r\n  // get the color from the texture\r\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\r\n\r\n  // 'un-premultiply' the color\r\n  lowp float inv_alpha \x3d (1.0 / clamp(color.a, 0.00390625, 1.0));\r\n  // finally write the fragment value\r\n  gl_FragColor \x3d alpha * color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineJoinShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform highp float u_depth;\r\nuniform highp vec2 u_screen;\r\nuniform mediump float u_size;\r\nuniform mediump float u_pixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  gl_PointSize \x3d u_pixelRatio * u_size;\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n\r\n  // calculate the vertex position in pixels (we need to add one in order to shift the origin from the center of the viewport)\r\n  v_vertexPosition \x3d (gl_Position.xy + 1.0) * u_screen;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/lineJoinShader.fs.glsl":"uniform lowp vec4 u_color;\r\nuniform mediump float u_lineHalfWidth;\r\nuniform mediump float u_oneOverPixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  // get the distance of the current fragment from the actual vertex\r\n  mediump float fragDist \x3d length(v_vertexPosition - u_oneOverPixelRatio * gl_FragCoord.xy);\r\n\r\n  // rounding the quare: calculate the alpha given the difference between the line-width and the distance of the fragment\r\n  // from the center-line. We will end up with a nice round circle with a soft edge.\r\n  lowp float alpha \x3d clamp(u_lineHalfWidth - fragDist, 0.0, 1.0);\r\n\r\n  // finally output the fragment color\r\n  gl_FragColor \x3d alpha * u_color;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/solidFillShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/solidFillShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main()\r\n{\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/views/vectorTiles/renderers/shaders/fillOutlineShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute vec2 a_xnormal;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp mat4 u_extrudeMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_outline_width;\r\n\r\nvarying lowp vec2 v_normal;\r\n\r\nconst float scale \x3d 1.0 / 15.0;\r\n\r\nvoid main()\r\n{\r\n  v_normal \x3d a_xnormal;\r\n\r\n   // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n    // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\r\n\r\n  // Remove the texture normal bit of the position before scaling it with the\r\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\r\n  // because we're extruding the line in pixel space, regardless of the current\r\n  // tile's zoom level.\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/fillOutlineShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvarying mediump vec2 v_normal;\r\n\r\nvoid main()\r\n{\r\n  // Calculate the distance of the pixel from the line in pixels.\r\n  lowp float dist \x3d abs(v_normal.y);\r\n\r\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\r\n  gl_FragColor \x3d alpha * u_color;\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/iconShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright,0.0)) * step(65.0,rotated) * (1.0 - step(193.0,rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label had been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/iconShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\nvoid main()\r\n{\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d v_transparency * color;\r\n}\r\n","url:esri/views/vectorTiles/renderers/shaders/sdfShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // TODO: force clipping the vertex in case that the vertex isn't visible\r\n  //delta_z +\x3d a_visible ? 0.0 : 1.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(65.0, rotated) * (1.0 - step(193.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label has been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/sdfShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nuniform lowp vec4 u_color;\r\nuniform mediump float u_edgeDistance;\r\nuniform mediump float u_edgeWidth;\r\n\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\r\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\r\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\r\n\r\nvoid main()\r\n{\r\n  // read the distance from the SDF texture\r\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n  mediump float alpha \x3d smoothstep(u_edgeDistance - u_edgeWidth, u_edgeDistance + u_edgeWidth, dist) * v_transparency;\r\n\r\n  gl_FragColor \x3d alpha * u_color;\r\n\r\n// YF: this code allow having both a fill and an outline colors combined in a single pass\r\n//  lowp float geometryAlpha \x3d smoothstep(0.75 - 0.21, 0.75 + 0.21, dist) * v_transparency;\r\n//  lowp vec4 geometryColor \x3d vec4(u_color.rgb, geometryAlpha * u_color.a);\r\n//\r\n//  if (true) {\r\n//    lowp float haloAlpha \x3d smoothstep(0.0 - 0.1, 0.0 + 0.1, dist) * v_transparency;\r\n//    lowp vec4 haloColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n//    haloColor \x3d vec4(haloColor.rgb, haloAlpha);\r\n//\r\n//    // calculate the composite color\r\n//    lowp float compositeAlpha \x3d geometryColor.a + haloColor.a * (1.0 - geometryColor.a);\r\n//    lowp vec3 compositeColor \x3d vec3(geometryColor) * geometryColor.a + vec3(haloColor) * haloColor.a * (1.0 - geometryColor.a);\r\n//    compositeColor /\x3d compositeAlpha;\r\n//    gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n//  }\r\n//  else {\r\n//    gl_FragColor \x3d geometryColor;\r\n//  }\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_coord_ratio;\r\nuniform mediump vec2 u_delta; // in tile coordinates\r\nuniform mediump vec2 u_dimensions; // in tile coordinates\r\n\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main() {\r\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\r\n\r\n  v_tex \x3d a_pos;\r\n}\r\n",
"url:esri/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main(void) {\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d 0.75 * color;\r\n}\r\n","*noref":1}});
define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../core/promiseUtils ./LayerView2D ../engine/StageGL ./support/TileInfoViewPOT ./support/TileStrategy ./support/TileKey ../../../views/vectorTiles/TileHandler ../../../views/vectorTiles/VectorTileContainer".split(" "),function(m,e,a,b,c,d,f,h,g,n,k,l,p){var q;return function(e){function f(){e.apply(this,arguments);this.container=new h}a(f,e);f.prototype.hitTest=
function(a,b){return null};f.prototype.update=function(a){this._vectorTileContainer&&this._vectorTileContainer.isInitialized&&(a.devicePixelRatio!==this._tileHandler.devicePixelRatio?this._initialize():(this._tileStrategy.updateTiles(q,a),this._tileStrategy.update(a),this.notifyChange("updating")))};f.prototype.attach=function(){var a=this;this._tileInfoView=new g(this.layer.tileInfo,this.layer.fullExtent);this.watch("layer.currentStyleInfo",function(){a._initialize()});this._initialize()};f.prototype.detach=
function(){console.log("detach");this.container.removeChild(this._vectorTileContainer);this._tileStrategy.destroy();this._tileStrategy=null};f.prototype.moveStart=function(){this.requestUpdate()};f.prototype.viewChange=function(){this.requestUpdate()};f.prototype.moveEnd=function(){this.requestUpdate()};f.prototype.isUpdating=function(){return this.attached&&(this._tileStrategy.updating||this.updateRequested)};f.prototype._initialize=function(){var a=this;this._vectorTileContainer&&(this._vectorTileContainer.removeAllChildren(),
this.container.removeChild(this._vectorTileContainer));this._vectorTileContainer=new p;this.container.addChild(this._vectorTileContainer);this._tileStrategy&&this._tileStrategy.destroy();this._tileHandler&&this._tileHandler.stop();this._tileHandler=new l(this.layer,function(){return a.requestUpdate()},window.devicePixelRatio||1,!0);this._tileStrategy=new n(this._vectorTileContainer,this._tileInfoView,function(){a.requestUpdate()},function(b,c){return a._tileHandler.getVectorTile(k.fromId(b),c)});
q=this._tileHandler.updateTile.bind(this._tileHandler);this._tileHandler.start().then(function(){a._vectorTileContainer.initialize(a._tileHandler.spriteMosaic,a._tileHandler.glyphMosaic,a.layer.tileInfo,a._tileInfoView);a.requestUpdate()}).otherwise(function(a){return d.reject(a)})};return f=b([c.subclass("esri.views.2d.layers.NewVectorTileLayerView2D")],f)}(c.declared(f))});