// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
define(["../../core/Accessor","../../core/HandleRegistry","../../core/watchUtils","dojo/_base/lang"],function(c,d,b,e){return c.createSubclass({declaredClass:"esri.widgets.CompassViewModel",properties:{canShowNorth:{dependsOn:["spatialReference"]},orientation:{},spatialReference:{dependsOn:["view.spatialReference"]},state:{dependsOn:["view.ready","canShowNorth"]},view:{}},constructor:function(){this._handles=new d;this._updateForCamera=this._updateForCamera.bind(this);this._updateForRotation=this._updateForRotation.bind(this);
this._updateRotationWatcher=this._updateRotationWatcher.bind(this)},getDefaults:function(){return e.mixin(this.inherited(arguments),{orientation:{x:0,y:0,z:0}})},initialize:function(){this._handles.add(b.init(this,"view",this._updateRotationWatcher))},destroy:function(){this._handles.destroy()},_handles:null,canShowNorth:!1,_canShowNorthGetter:function(){var a=this.spatialReference;return a&&(a.isWebMercator||4326===a.wkid)},orientation:null,spatialReference:null,_spatialReferenceGetter:function(){return this.get("view.spatialReference")||
null},state:"disabled",_stateGetter:function(){return!this.get("view.ready")?"disabled":this.canShowNorth?"compass":"rotation"},view:null,reset:function(){var a=this.view;a&&a.ready&&("2d"===a.type?a.goTo({rotation:0}):a.goTo({heading:0}))},_updateForRotation:function(a){void 0===a||null===a||(this.orientation={z:a})},_updateForCamera:function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})},_updateRotationWatcher:function(a){this._handles.removeAll();a&&("2d"===a.type?this._handles.add(b.init(this,
"view.rotation",this._updateForRotation)):this._handles.add(b.init(this,"view.camera",this._updateForCamera)))}})});