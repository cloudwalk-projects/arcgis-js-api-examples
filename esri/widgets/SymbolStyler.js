// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/widgets/SymbolStyler/templates/SymbolStyler.html":'\x3cdiv data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"${css.symbolPreviewContainer}" data-dojo-attach-point\x3d"dap_symbolPreviewContainer"\x3e\r\n    \x3cdiv class\x3d"${css.symbolPreview}" data-dojo-attach-point\x3d"dap_symbolPreview"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/StackController" class\x3d"${css.tabBar}" data-dojo-props\x3d"containerId:\'${id}_stackContainer\'" data-dojo-attach-point\x3d"dap_stackController"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/layout/StackContainer" id\x3d"${id}_stackContainer" data-dojo-attach-point\x3d"dap_stackContainer" data-dojo-props\x3d"doLayout: false" class\x3d"${css.content}"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${labels.shape}" data-dojo-attach-point\x3d"dap_shapeContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_symbolPicker"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_useImageContent"\x3e\r\n        \x3cdiv class\x3d"${css.link}" data-dojo-attach-point\x3d"dap_addImage" tabindex\x3d"0"\x3e${labels.useImage}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_shapeImageUrlContainer" class\x3d"${css.shapeImageUrlContainer}"\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"dap_shapeImageUrlInput" class\x3d"${css.urlInput} dijitInline"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"dap_loadShapeImageUrl" class\x3d"dijitInline ${css.addIcon}" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"dap_shapeImageUrlErrorDisplay" class\x3d"${css.errorDisplay}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_shapeSizeControls"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dap_shapeSizeLabel" class\x3d"${css.label}"\x3e${labels.symbolSize}\x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.symbolSizeInput} ${css.inlineInput}" data-dojo-attach-point\x3d"dap_symbolSizeOptions"\x3e\r\n          \x3cdiv class\x3d"${css.hidden}" data-dojo-type\x3d"esri/widgets/HorizontalSlider" data-dojo-attach-point\x3d"dap_shapeSizeSlider"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-type\x3d"dijit/form/NumberSpinner"  data-dojo-attach-point\x3d"dap_shapeSizeTextBox"\x3e\x3c/div\x3e\r\n          \x3cspan class\x3d"${css.text}" data-dojo-attach-point\x3d"dap_sizeUnitLabel"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${labels.fill}" data-dojo-attach-point\x3d"dap_fillContainer"\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/widgets/ColorPicker" data-dojo-attach-point\x3d"dap_fillColorPicker" data-dojo-props\x3d"showSuggestedColors: true"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/widgets/SymbolStyler/ColorRampPicker" data-dojo-attach-point\x3d"dap_fillColorRampPicker" class\x3d"${css.hidden}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" title\x3d"${labels.outline}" data-dojo-attach-point\x3d"dap_outlineContainer"\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/widgets/ColorPicker" data-dojo-attach-point\x3d"dap_outlineColorPicker" data-dojo-props\x3d"showSuggestedColors: true"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"esri/widgets/SymbolStyler/ColorRampPicker" data-dojo-attach-point\x3d"dap_outlineColorRampPicker" class\x3d"${css.hidden}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_lineWidthLabel" class\x3d"${css.label}"\x3e${labels.lineWidth}\x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.lineWidthInput} ${css.inlineInput}" data-dojo-attach-point\x3d"dap_lineWidthOptions"\x3e\r\n        \x3cdiv class\x3d"${css.hidden}" data-dojo-type\x3d"esri/widgets/HorizontalSlider" data-dojo-attach-point\x3d"dap_lineWidthSlider"\x3e\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"dap_lineWidthTextBox"\x3e\x3c!--values added dynamically--\x3e\x3c/select\x3e\r\n        \x3cspan class\x3d"${css.text}" data-dojo-attach-point\x3d"dap_lineWidthUnitLabel"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"${css.label}" data-dojo-attach-point\x3d"dap_linePatternSelectLabel"\x3e${labels.pattern}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_linePatternSelect"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("../core/domUtils ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ./ColorPicker ./ColorPicker/colorUtils ./SymbolStyler/_DelayedUpdate ./SymbolStyler/IconSelect ./SymbolStyler/MarkerSymbolPicker ./SymbolStyler/support/schemeUtils ./SymbolStyler/support/stylerUtils ./SymbolStyler/support/symbolUtils dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dijit/a11yclick dijit/form/CheckBox dijit/form/ComboBoxMixin dijit/form/NumberTextBox dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/keys dojo/number dojo/on dojo/string dojo/i18n!./SymbolStyler/nls/SymbolStyler dojo/text!./SymbolStyler/templates/SymbolStyler.html ./HorizontalSlider ./SymbolStyler/MarkerSymbolPicker ./SymbolStyler/ColorRampPicker dijit/form/Button dijit/form/ComboBox dijit/form/NumberSpinner dijit/form/Select dijit/form/TextBox dijit/layout/BorderContainer dijit/layout/ContentPane dijit/layout/StackController dijit/layout/StackContainer".split(" "),
function(t,x,L,y,z,A,u,B,q,e,d,C,D,E,v,F,G,H,M,p,n,I,J,w,N,l,K){function f(a){p.remove(t.getNode(a),k.hidden)}function h(a){p.add(t.getNode(a),k.hidden)}var r=d.is3d,k={root:"esri-symbol-styler",symbolPreviewContainer:"esri-symbol-preview-container",symbolPreview:"esri-symbol-preview",tabBar:"esri-tab-bar",content:"esri-content",link:"esri-link",label:"esri-label",shapeImageUrlContainer:"esri-shape-image-url-container",urlInput:"esri-url-input",addIcon:"esri-add-icon",errorDisplay:"esri-error-display",
symbolSizeInput:"esri-symbol-size-input",inlineInput:"esri-inline-input",text:"esri-text",hidden:"esri-hidden",lineWidthInput:"esri-line-width-input",linePattern:"esri-line-pattern",linePatternInput:"esri-line-pattern-input",alt:"esri-alt",disabled:"esri-disabled"};return D.createSubclass([C,E,A],{declaredClass:"esri.dijit.SymbolStyler",baseClass:k.root,templateString:K,labels:l,css:k,constructor:function(){this._tabOptions={};this._delayedCommitPropsTrigger=this.createUpdateTrigger(this._commitProperties,
this);this._initOptimizationControls()},postCreate:function(){this.inherited(arguments);this._setUpComboBox();this._linePatternSelect=new u({baseClass:u.prototype.baseClass+" "+k.root+" "+k.linePatternInput},this.dap_linePatternSelect);h(this.dap_shapeImageUrlContainer);this.dap_shapeImageUrlInput.set("placeholder",l.imageUrlInputPlaceholder);this._lineWidthTextBox.selectOnClick=!0;this.dap_shapeSizeTextBox.selectOnClick=!0;this.dap_lineWidthSlider.intermediateChanges=!0;this._lineWidthTextBox.intermediateChanges=
!0;this.dap_shapeSizeSlider.intermediateChanges=!0;this.dap_shapeSizeTextBox.intermediateChanges=!0;this.dap_fillColorPicker.trackColors=!1;this.dap_outlineColorPicker.trackColors=!1;this._linePatternSelect.addIconOptions(["solid","dot","dash","dash-dot","long-dash-dot-dot"],k.linePattern);this._importRecentColors();this.dap_outlineColorPicker._enableTransparencySlider=function(){};this.dap_outlineColorPicker._disableTransparencySlider=function(){}},startup:function(){this.inherited(arguments);var a=
new B(this._getSymbolPickerParams(),this.dap_symbolPicker);a.startup();this._symbolPicker=a;this._addHandlers()},destroy:function(){this._symbolPreviewSurface&&this._symbolPreviewSurface.destroy();n.destroy(this._optimizationSection);this._optimizationCheckBox.destroy();this.dap_shapeContainer.destroy();this.dap_fillContainer.destroy();this.dap_outlineContainer.destroy();this.inherited(arguments)},_RECENT_FILL_COLORS_ITEM_KEY:"symbolStyler/recent/fill/colors",_RECENT_OUTLINE_COLORS_ITEM_KEY:"symbolStyler/recent/outline/colors",
_defaultMinLineWidthInPx:0,_defaultMinShapeSizeInPx:1,_defaultMaxLineWidthInPx:18,_defaultMaxShapeSizeInPx:120,_originalSymbol:null,_editedSymbol:null,_activeTabName:null,_externalSizing:!1,_delayedCommitPropsTrigger:null,_symbolPreviewSurface:null,_linePatternSelect:null,_symbolPicker:null,_customImageSymbol:null,_optimizationSection:null,_optimizationCheckBox:null,_isPreppingEdit:null,shapeSymbol:null,_setShapeSymbolAttr:function(a){this._adjustOutlineProperties(this._editedSymbol,a);this._set("shapeSymbol",
a);this._editedSymbol=a;this._updateTabs(a);this._toggleOutlineColorControls(a);this._delayedCommitPropsTrigger()},shapeSize:null,_setShapeSizeAttr:function(a){this._set("shapeSize",a);this._delayedCommitPropsTrigger()},_shapeImageUrl:null,_setShapeImageUrlAttr:function(a){this._set("shapeImageUrl",a);this._delayedCommitPropsTrigger()},fillColor:null,_setFillColorAttr:function(a){this._set("fillColor",a);this._delayedCommitPropsTrigger()},fillColorRamp:null,_setFillColorRampAttr:function(a){this._set("fillColorRamp",
a);this._delayedCommitPropsTrigger()},outlineColorRamp:null,_setOutlineColorRampAttr:function(a){this._set("outlineColorRamp",a);this._delayedCommitPropsTrigger()},outlineWidth:null,_setOutlineWidthAttr:function(a){this._set("outlineWidth",a);this._delayedCommitPropsTrigger()},outlineColor:null,_setOutlineColorAttr:function(a){var b=!!this._optimizationOptions&&this._optimizationCheckBox.checked;a&&b&&(a.a=0.5,this.dap_outlineColorPicker.set("color",a,!1));this._set("outlineColor",a);this._delayedCommitPropsTrigger()},
outlinePattern:null,_setOutlinePatternAttr:function(a){this._set("outlinePattern",a);this._delayedCommitPropsTrigger()},mode:"2d",_setModeAttr:function(a){var b="2d"===a;this._set("mode",a);this.dap_linePatternSelect.hidden=!b;this.dap_linePatternSelectLabel.hidden=!b;this.dap_useImageContent.hidden=!b},portal:null,previewVisible:!0,_setPreviewVisibleAttr:function(a){this._set("previewVisible",a);this.dap_symbolPreviewContainer.hidden=!a;this._delayedCommitPropsTrigger()},edit:function(a,b){d.ensureProps(a.clone()).then(function(c){var g;
b=b||{};g=b.colorRamp;if(r(c)&&"3d"!==this.mode||!r(c)&&"2d"!==this.mode)throw Error("symbol-styler:incompatible-symbol-edit","tried to edit a symbol with an incompatible mode",{symbol:c,mode:this.mode});this._isPreppingEdit=!0;this._colorRamp=g;this._originalSymbol=a;this._editedSymbol=c;this._activeTabName=b.activeTab;this._externalSizing=b.externalSizing;this._tabOptions=b.tabOptions||{};this._optimizationOptions="boolean"===typeof b.optimizeOutline?{value:b.optimizeOutline}:void 0;this._setUpColorControls(b.schemes,
g);this._assimilateSymbol(c);this._toggleSizingControls(this._externalSizing);this._updateSymbolPicker();this._toggleOutlineColorControls(c);this._toggleOptimizationOptions();c=d.hasExtrudeSymbolLayer(c)||d.hasTextSymbolLayer(a)?this.dap_fillContainer:this.dap_shapeContainer;n.place(this.dap_shapeSizeControls,c.domNode,"last")}.bind(this))},getStyle:function(){var a=this._editedSymbol.clone(),b={symbol:a};this._colorRamp&&(a=(a=d.isLine(a,"2d")||d.isPoint(a,"2d")&&d.hasPureOutlineStyle(a))?this.dap_outlineColorRampPicker:
this.dap_fillColorRampPicker,b.colorRamp=a.get("selected").colors);this._optimizationOptions&&(b.optimizeOutline=this._optimizationCheckBox.checked);return b},storeColors:function(){this._storeRecentColors(this.dap_fillColorPicker,this._RECENT_FILL_COLORS_ITEM_KEY);this._storeRecentColors(this.dap_outlineColorPicker,this._RECENT_OUTLINE_COLORS_ITEM_KEY)},_initOptimizationControls:function(){var a=new F,b=n.create("div",{className:y.prototype.css.section});n.create("label",{"for":a.id,className:k.label,
innerHTML:l.autoAdjustOutline},b);a.on("change",function(a){var b=this.dap_outlineColorPicker.get("color");b.a=a?0.5:1;this.dap_outlineColorPicker.set("color",b);this._delayedCommitPropsTrigger()}.bind(this));a.placeAt(b,"first");this._optimizationSection=b;this._optimizationCheckBox=a},_toggleOutlineColorControls:function(a){var b=this.dap_outlineColorRampPicker,c=this.dap_outlineColorPicker;this._shouldShowOutlineColorRamp(a)?(f(b),h(c)):(f(c),h(b))},_shouldShowOutlineColorRamp:function(a){return this._colorRamp&&
(d.isLine(a,"2d")||d.isPoint(a,"2d")&&d.hasPureOutlineStyle(a))},_setUpColorControls:function(a,b){var c=this.dap_outlineColorRampPicker,g=this.dap_outlineColorPicker,m=this.dap_fillColorRampPicker,s=this.dap_fillColorPicker,e;b?(e={colors:b.colors},b.scheme&&(e.scheme=b.scheme),d.isLine(this._editedSymbol,"2d")?(c.set({numStops:b.numStops,schemes:a,selected:e}),h(g),f(c)):(d.isPoint(this._editedSymbol,"2d")&&c.set({numStops:b.numStops,schemes:a,selected:e}),m.set({numStops:b.numStops,schemes:a,selected:e}),
f(m),f(g),h(s),h(c)),g.set("suggestedColors",q.getOutlineColors(a))):(f(s),f(g),h(m),h(c),this._updateSuggestedColors(s,q.getFillColors(a)),this._updateSuggestedColors(g,q.getOutlineColors(a)))},_toggleOptimizationOptions:function(){var a=this._optimizationOptions,b=this._optimizationSection;d.isPolygon(this._editedSymbol,"2d")&&a?(this._optimizationCheckBox.set("value",a.value),n.place(b,this.dap_outlineColorPicker.dap_recentColorSection)):b.parentNode&&n.empty(b.parentNode)},_importRecentColors:function(){this.dap_fillColorPicker.loadRecentColors(this._RECENT_FILL_COLORS_ITEM_KEY);
this.dap_outlineColorPicker.loadRecentColors(this._RECENT_OUTLINE_COLORS_ITEM_KEY)},_toggleSizingControls:function(a){var b=!1,c=!1;a&&(d.isLine(this._editedSymbol)?c=!0:b=!0);this._toggleLabeledControls({labels:this.dap_lineWidthLabel,controls:[this._lineWidthTextBox,this.dap_lineWidthSlider],disabled:c});this._toggleLabeledControls({labels:this.dap_shapeSizeLabel,controls:[this.dap_shapeSizeTextBox,this.dap_shapeSizeSlider],disabled:b})},_toggleLabeledControls:function(a){var b=[].concat(a.labels),
c=[].concat(a.controls),d=a.disabled;b.forEach(function(a){p.toggle(a,k.disabled,d)});c.forEach(function(a){e.toggleControl(a,d)})},_updateSymbolPicker:function(){var a=this._tabOptions.symbolDisplayMode?this._tabOptions.symbolDisplayMode:d.isPoint(this._editedSymbol,"2d")&&this._colorRamp?"default":"portal";this.dap_useImageContent.hidden="3d"===this.mode||"portal"!==a;this._symbolPicker.set({displayMode:a,symbolSource:d.getSymbolSource(this._editedSymbol)});this._symbolPicker.refresh()},_adjustOutlineProperties:function(a,
b){var c=this.dap_fillColorPicker,g=this.dap_outlineColorPicker,m=this.dap_fillColorRampPicker,e=this.dap_outlineColorRampPicker;d.switchedFromRasterToVectorSymbol(a,b)?(c.set("color",b.color),c=d.getOutline(b),g.set("color",c.color),this._lineWidthTextBox.set("value",c.size),this._linePatternSelect.set("value",c.style)):d.switchedFromPureOutline(a,b)&&this._colorRamp?m.set("selected",e.get("selected")):d.switchedToPureOutline(a,b)&&(this._colorRamp?e.set("selected",m.get("selected")):(c=d.getOutline(a),
e=g.get("color"),c.color?(m=z.isBright(c.color))&&0.2>c.color.a?(e.a=0.2,g.set("color",e)):!m&&0.1>c.color.a&&(e.a=0.1,g.set("color",e)):g.set("color",b.color)))},_getTabContainer:function(a){return"fill"===a?this.dap_fillContainer:"outline"===a?this.dap_outlineContainer:this.dap_shapeContainer},_storeRecentColors:function(a,b){a.addRecentColor(a.get("color"));a.saveRecentColors(b)},_addHandlers:function(){this._linePatternSelect.on("change",function(a){this.set("outlinePattern",a)}.bind(this));this.own(w(this.dap_loadShapeImageUrl,
v,function(){this._loadImage(this.dap_shapeImageUrlInput.get("value"))}.bind(this)));this.own(w(this.dap_addImage,v,function(){f(this.dap_shapeImageUrlContainer);this.dap_shapeImageUrlInput.focus()}.bind(this)));this.dap_shapeImageUrlInput.on("input",function(a){a.keyCode===I.ENTER&&this._loadImage(this.dap_shapeImageUrlInput.get("value"))}.bind(this));this.dap_shapeImageUrlInput.on("change",function(a){this.set("shapeImageUrl",a)}.bind(this));this.dap_fillColorPicker.on("color-change",function(a){this.set("fillColor",
a.color)}.bind(this));this.dap_fillColorRampPicker.on("color-ramp-change",function(a){this.set("fillColorRamp",a.colors)}.bind(this));this.dap_outlineColorRampPicker.on("color-ramp-change",function(a){this.set("outlineColorRamp",a.colors)}.bind(this));this.dap_outlineColorPicker.on("color-change",function(a){a=a.color;!this.outlineColor&&a&&0===this.outlineWidth||null===this.outlineWidth?this._lineWidthTextBox.set("value",1):this.outlineColor&&!a&&this._lineWidthTextBox.set("value",0);this.set("outlineColor",
a)}.bind(this));this._symbolPicker.on("symbol-select",function(a){this._hideImageUrlInput();this.set("shapeSymbol",a.selection)}.bind(this));this.dap_shapeSizeTextBox.on("change",function(a){this.set("shapeSize",a)}.bind(this));this.dap_fillColorPicker.on("color-change",function(a){this.set("fillColor",a.color)}.bind(this));this.dap_outlineColorPicker.on("color-change",function(a){this.set("outlineColor",a.color)}.bind(this));this._lineWidthTextBox.on("change",function(a){this.set("outlineWidth",
a)}.bind(this))},_setUpComboBox:function(){var a=H.createSubclass([G]),b=document.createDocumentFragment();[1,1.2,1.5,2,3,4,5,6,7,8,9,10].forEach(function(a){b.appendChild(n.create("option",{innerHTML:J.format(a)}))});this.dap_lineWidthTextBox.appendChild(b);this._lineWidthTextBox=new a({},this.dap_lineWidthTextBox)},_loadImage:function(a){this._clearUrlImageErrorDisplay();d.testImageUrl(a).then(function(b){var c=this._customImageSymbol;b=d.preserveAspectRatio({dimensions:b,targetDimension:"width",
targetSize:this.shapeSize});c?(c.url=a,c.height=b.height,c.width=b.width):this._customImageSymbol=c=new x(a,b.width,b.height);this._symbolPicker.addCustomImageSymbol(c);this.set("shapeSymbol",c)}.bind(this)).otherwise(function(){this.dap_shapeImageUrlErrorDisplay.innerHTML=l.imageLoadError}.bind(this))},_clearUrlImageErrorDisplay:function(){this.dap_shapeImageUrlErrorDisplay.innerHTML=""},_getActiveTabAttr:function(){var a=this.dap_stackContainer.selectedChildWidget;return a===this.dap_outlineContainer?
"outline":a===this.dap_fillContainer?"fill":"shape"},_updateTabs:function(a){var b=d.getApplicableTabs(a,this._tabOptions.excluded),c=this.dap_stackContainer,g=0;Object.keys(b).forEach(function(a,d){var h=b[a],f=this._getTabContainer(a);"disabled"===h.state&&e.disable(f);"enabled"===h.state&&e.enable(f);"excluded"===h.state?f.domNode.parentNode&&c.removeChild(f):(f.domNode.parentNode||c.addChild(f,g),g++)},this);1===c.getChildren().length?h(this.dap_stackController.domNode):f(this.dap_stackController.domNode);
this._supportsPattern(a)?(f(this.dap_linePatternSelectLabel),f(this._linePatternSelect.domNode)):(h(this.dap_linePatternSelectLabel),h(this._linePatternSelect.domNode));a=this._getTabContainer(this._activeTabName);-1<this.dap_stackContainer.getIndexOfChild(a)&&this.dap_stackContainer.selectChild(a);e.ensureEnabledChildSelection(this.dap_stackContainer)},_supportsPattern:function(a){return d.isLine(a,"2d")||d.isPolygon(a,"2d")},_syncControls:function(a){var b;this._hideImageUrlInput();this._updateSizingConstraints();
var c=d.getApplicableTabs(a,this._tabOptions.excluded);"enabled"===c.shape.state&&(b=d.getMarkerLength(a),this.set("shapeSize",b),e.silentlyUpdateIntermediateChangingValueWidget(this.dap_shapeSizeSlider,b),e.silentlyUpdateIntermediateChangingValueWidget(this.dap_shapeSizeTextBox,b));if("enabled"===c.fill.state&&(b=d.getFillColor(a),this.set("fillColor",b),this.dap_fillColorPicker.set("color",b,!1),d.hasExtrudeSymbolLayer(a)||d.hasTextSymbolLayer(a)))b=d.getMarkerLength(a),this.set("shapeSize",b),
e.silentlyUpdateIntermediateChangingValueWidget(this.dap_shapeSizeSlider,b),e.silentlyUpdateIntermediateChangingValueWidget(this.dap_shapeSizeTextBox,b);if("enabled"===c.outline.state&&(a=d.getOutline(a)))this.set({outlineColor:a.color,outlineWidth:a.size,outlinePattern:a.style}),this.dap_outlineColorPicker.set("color",a.color,!1),e.silentlyUpdateIntermediateChangingValueWidget(this.dap_lineWidthSlider,a.size),e.silentlyUpdateIntermediateChangingValueWidget(this._lineWidthTextBox,a.size),this._linePatternSelect.set("value",
a.style,!1)},_updateSizingConstraints:function(){var a=this._editedSymbol,b=d.is3d(a),c=d.getOutlineUnit(a),g=d.getSizeUnit(a),f=d.getOutline(a),f=b?99999999:f&&f.size>this._defaultMaxLineWidthInPx?Math.ceil(f.size):this._defaultMaxLineWidthInPx,a=d.getMarkerLength(a),a=b?99999999:a>this._defaultMaxShapeSizeInPx?Math.ceil(a):this._defaultMaxShapeSizeInPx,h=b?"meters"===g?0.001:1:this._defaultMinShapeSizeInPx;e.updateSliderAndTextBoxConstraints({textBox:this._lineWidthTextBox,slider:this.dap_lineWidthSlider,
minimum:b?"meters"===c?0.001:0:this._defaultMinLineWidthInPx,maximum:f});this.dap_lineWidthUnitLabel.innerHTML="meters"===c?l.meters:l.px;e.updateSliderAndTextBoxConstraints({textBox:this.dap_shapeSizeTextBox,slider:this.dap_shapeSizeSlider,minimum:h,maximum:a});this.dap_sizeUnitLabel.innerHTML="meters"===g?l.meters:l.px},_assimilateSymbol:function(a){this._updateTabs(a);this._syncControls(a)},_getSymbolPickerParams:function(){return{portal:this.portal,symbolSource:"2d"===this.mode?"symbol-set":"web-style"}},
_hideImageUrlInput:function(){this._clearUrlImageErrorDisplay();h(this.dap_shapeImageUrlContainer);this.dap_shapeImageUrlInput.set("value","")},_getFillColor:function(){var a=this._editedSymbol;return!r(a)&&!d.isLine(a)&&this._colorRamp?this._getMiddleItem(this.fillColorRamp):this.fillColor},_getMiddleItem:function(a){return a[Math.floor(0.5*(a.length-1))]},_getOutlineColor:function(){return this._shouldShowOutlineColorRamp(this._editedSymbol)?this._getMiddleItem(this.outlineColorRamp):this.outlineColor},
_commitProperties:function(){var a=this._editedSymbol,b=d.getApplicableTabs(a,this._tabOptions.excluded);"enabled"===b.shape.state&&d.updateShape({symbol:a,size:this.shapeSize});"enabled"===b.fill.state&&(d.updateFill({symbol:a,color:this._getFillColor()}),(d.hasExtrudeSymbolLayer(a)||d.hasTextSymbolLayer(a))&&d.updateShape({symbol:a,size:this.shapeSize}),this._isPreppingEdit||d.ensureSupportedSimpleFillSymbolStyle(a));"enabled"===b.outline.state&&d.updateOutline({symbol:a,color:this._getOutlineColor(),
pattern:this.outlinePattern,size:this.outlineWidth});this.previewVisible&&this._updatePreviewSymbol();this._toggleOutlineOptions();this._isPreppingEdit=!1;this.emit("style-update")},_toggleOutlineOptions:function(){var a=!!this._optimizationOptions&&this._optimizationCheckBox.checked,b=this.outlineColor,c=d.isLine(this._editedSymbol),e=a||!b,f=!b;this._toggleLabeledControls({labels:this.dap_lineWidthLabel,controls:[this._lineWidthTextBox,this.dap_lineWidthSlider],disabled:this._externalSizing&&c||
!b||a});this._toggleLabeledControls({labels:this.dap_linePatternSelectLabel,controls:this._linePatternSelect,disabled:f});this._toggleLabeledControls({labels:[this.dap_outlineColorPicker.dap_transparencyLabel],controls:[this.dap_outlineColorPicker.dap_transparencySlider],disabled:e})},_updatePreviewSymbol:function(){var a=this._editedSymbol,b=this.dap_symbolPreview;if(this._symbolPreviewSurface)try{this._symbolPreviewSurface.destroy()}catch(c){}d.hasTextSymbolLayer(a)||d.renderOnSurface(a,b).then(function(c){this._symbolPreviewSurface=
c;p.toggle(b,k.alt,d.blendsIntoBackground(a))}.bind(this))},_updateSuggestedColors:function(a,b){a.set("suggestedColors",b)}})});