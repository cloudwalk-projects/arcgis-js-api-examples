//>>built
define("xstyle/core/generate",["xstyle/core/elemental","put-selector/put","xstyle/core/utils","xstyle/core/expression","xstyle/core/base"],function(z,u,A,J,K){function m(a,e){a=a.sort?a:[a];return function(c,k,f){var b=c,x;"content"in c||(c.content=void 0);if(void 0===f){var g=(c._contentNode||c).childNodes||0,h=g[0];if(h){var s=r.createDocumentFragment();do s.appendChild(h);while(h=g[0]);c.content=s}if(c._contentNode){c._contentNode=void 0;try{c.innerHTML=""}catch(B){}}}for(var E=0,F=[c],C=[],g=
0,h=a.length;g<h;g++){var G=d,d=a[g];try{if(d.eachProperty){if(d.args)if("("==d.operator){var p=a[g+1];H(d,p,b,function(a,b,c){L(a,b,c,e)})}else{var n=d.args[0];if("string"===typeof n){var q=n.split("\x3d");try{b.setAttribute(q[0],q[1])}catch(m){console.error(m)}}else{var v=n[0].replace(/=$/,""),y=n[1];"("==y.operator?H(n[1],v,b,function(a,b,c){M(a,b,c,e)}):b.setAttribute(v,y.value)}}}else if("string"==typeof d){"\x3d"==d.charAt(0)&&(d=d.slice(1));var l=b,p=a[g+1],q=[];d.replace(/([,\n]+)?([\t ]*)?(\.|#)?([-\w%$|\.\#]+)(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,
function(){q.push(arguments)});for(var w=0;w<q.length;w++)(function(a,h,g,d,s,m,r){function B(){var a=l._contentNode;a&&(a.innerHTML="",l=a)}h?(a=g?g.length:0,a>E?(B(),F[a]=l):l=F[a]||l,E=a):B();var n;if(d)n=(G&&G.args?"":"span")+d+s;else{d=s.match(/^[-\w]+/);if(!d)throw new SyntaxError("Unable to parse selector",s);d=d[0];var t;w===q.length-1&&p&&p.selector?(p.bases||A.extend(p,d),t=p):t=e.getDefinition(d);t&&(t.then||t.newElement)?l=function(a,b,c,f){var d,e;A.when(t&&t.newElement&&t.newElement(),
function(a){(d=a)?(c=c.slice(f.length))&&u(d,c):d=u(c);if(e){e.parentNode.replaceChild(d,e);a=e.childNodes;var b;for(d=d._contentNode||d;b=a[0];)d.appendChild(b)}});if(d)return a.insertBefore(d,b||null);e=u("span");return a.insertBefore(e,b||null)}(l,f,s,d):n=s}n&&(l=u(f||l,(f?"-":"")+n));f=null;m&&l.setAttribute(m,""===r?m:r);k&&(l.item=k);x=x||l;(w<q.length-1||l!=b&&l!=c)&&C.push(w==q.length-1&&p&&p.selector,l);b=l}).apply(this,q[w])}else b.appendChild(r.createTextNode(d.value))}catch(D){console.error(D,
D.stack),b.innerHTML&&(b.innerHTML=""),b.appendChild(r.createTextNode(D))}}for(;d=C.pop();)z.update(d,C.pop());return x}}function H(a,e,c,k){var f,b;e&&e.eachProperty?(u(c,f=e.selector),b=e):(u(c,f=a.selector||(a.selector=".-xbind-"+N++)),b=a);var x=a.getArgs()[0],g=a.expressionResult,h=a.expressionDefinition;h||(h=a.expressionDefinition=J.evaluate(a.parent,x),g=h.valueOf(),z.addInputConnector(b,h),function(c,e,f){a.expressionResult=g;f.dependencyOf&&f.dependencyOf({invalidate:function(a){a=a?z.matchesRule(a.elements[0],
b)?a.elements:a.elements[0].querySelectorAll(e):document.querySelectorAll(e);for(var h=0,g=a.length;h<g;h++)k(a[h],c,f.valueOf())}})}(e,f,h));k(c,e,g)}function v(a,e,c,k){return A.when(a,function(a){a&&a.forRule&&(a=a.forRule(e));a&&a.forElement&&(a=a.forElement(c));k(a)})}function M(a,e,c,k){v(c,k,a,function(c){a.setAttribute(e,c)})}function L(a,e,c,k){a._defaultBinding=!0;if(c&&c.then&&"INPUT"!==a.tagName)try{a.appendChild(r.createTextNode("Loading"))}catch(f){}v(c,k,a,function(b){if(a._defaultBinding)if(y(a),
a.childNodes.length&&(a.innerHTML=""),b&&b.sort)if(b.isSequence)m(b,k)(a);else{var c=e&&e.definitions&&e.definitions.each,g=k.newRule(),c=c?m(c,g):function(a,b,c){return u(c||a,(c?"-":"")+(O[a.tagName]||"span"),""+b)},h=[],f;b.track&&(b=b.track(),f=b.tracking);b.forEach(function(b){h.push(c(a,b,null))});if(b.on)var v=b.on("add,delete,update",function(b){var e=b.target,f=b.previousIndex;b=b.index;if(-1<f){var g=h[f];y(g,!0);g.parentNode.removeChild(g);h.splice(f,1)}-1<b&&h.splice(b,0,c(a,e,h[b]||null))});
if(f=f||v)a.xcleanup=function(){f.remove()}}else b&&b.nodeType?a.appendChild(b):(b=void 0===b?"":b,a.tagName in P?"checkbox"===a.type?a.checked=b:a.value=b:a.appendChild(r.createTextNode(b)))})}function y(a,e){a.xcleanup&&a.xcleanup(e);for(var c=a.getElementsByTagName("*"),k=0,f=c.length;k<f;k++){var b=c[k];b.xcleanup&&b.xcleanup(!0)}}function I(a,e){return m(e,K)(a)}var O={TABLE:"tr",TBODY:"tr",TR:"td",UL:"li",OL:"li",SELECT:"option"},P={INPUT:1,TEXTAREA:1,SELECT:1},r=document,N=1;I.forSelector=
m;return I});