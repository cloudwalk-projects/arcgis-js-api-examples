//>>built
require({cache:{"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(k,v,q,t,w,l,f,e,c,a){function y(b,a){if(!s)return b.splice(a,1);var c=b.length;if(c){for(;a<c;)b[a]=b[a+1],a++;b.length--}}var s=!!w("chrome"),m=k.shape={};m.Shape=q("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=
this.matrix=this.shape=this.rawNode=null;if(w("gfxRegistry")){var b=m.register(this);this.getUID=function(){return b}}},destroy:function(){w("gfxRegistry")&&m.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},
getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var b=this.getBoundingBox();if(!b)return null;var c=this._getRealMatrix();return[a.multiplyPoint(c,b.x,b.y),a.multiplyPoint(c,b.x+b.width,b.y),a.multiplyPoint(c,b.x+b.width,b.y+b.height),a.multiplyPoint(c,b.x,b.y+b.height)]},getEventSource:function(){return this.rawNode},setClip:function(b){this.clip=b},getClip:function(){return this.clip},setShape:function(b){this.shape=k.makeParameters(this.shape,b);this.bbox=null;
return this},setFill:function(b){if(!b)return this.fillStyle=null,this;var a=null;if("object"==typeof b&&"type"in b)switch(b.type){case "linear":a=k.makeParameters(k.defaultLinearGradient,b);break;case "radial":a=k.makeParameters(k.defaultRadialGradient,b);break;case "pattern":a=k.makeParameters(k.defaultPattern,b)}else a=k.normalizeColor(b);this.fillStyle=a;return this},setStroke:function(b){if(!b)return this.strokeStyle=null,this;if("string"==typeof b||v.isArray(b)||b instanceof c)b={color:b};b=
this.strokeStyle=k.makeParameters(k.defaultStroke,b);b.color=k.normalizeColor(b.color);return this},setTransform:function(b){this.matrix=a.clone(b?a.normalize(b):a.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var b=this.getParent();b&&(b._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var b=this.getParent();b&&(b._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},
applyRightTransform:function(b){return b?this.setTransform([this.matrix,b]):this},applyLeftTransform:function(b){return b?this.setTransform([b,this.matrix]):this},applyTransform:function(b){return b?this.setTransform([this.matrix,b]):this},removeShape:function(b){this.parent&&this.parent.remove(this,b);return this},_setParent:function(b,a){this.parent=b;return this._updateParentMatrix(a)},_updateParentMatrix:function(b){this.parentMatrix=b?a.clone(b):null;return this._applyTransform()},_getRealMatrix:function(){for(var b=
this.matrix,c=this.parent;c;)c.matrix&&(b=a.multiply(c.matrix,b)),c=c.parent;return b}});m._eventsProcessing={on:function(b,a){return l(this.getEventSource(),b,m.fixCallback(this,k.fixTarget,a))},connect:function(b,a,c){"on"==b.substring(0,2)&&(b=b.substring(2));return this.on(b,c?v.hitch(a,c):a)},disconnect:function(b){return b.remove()}};m.fixCallback=function(b,a,c,e){e||(e=c,c=null);if(v.isString(e)){c=c||t.global;if(!c[e])throw['dojox.gfx.shape.fixCallback: scope["',e,'"] is null (scope\x3d"',
c,'")'].join("");return function(f){return a(f,b)?c[e].apply(c,arguments||[]):void 0}}return!c?function(f){return a(f,b)?e.apply(c,arguments):void 0}:function(f){return a(f,b)?e.apply(c,arguments||[]):void 0}};v.extend(m.Shape,m._eventsProcessing);m.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(b){var a=b.getParent();a&&a.remove(b,!0);this.children.push(b);return b._setParent(this,this._getRealMatrix())},
remove:function(b,a){for(var c=0;c<this.children.length;++c)if(this.children[c]==b){a||(b.parent=null,b.parentMatrix=null);y(this.children,c);break}return this},clear:function(b){for(var a,c=0;c<this.children.length;++c)a=this.children[c],a.parent=null,a.parentMatrix=null,b&&a.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var b=null;f.forEach(this.children,function(c){var e=c.getBoundingBox();e&&((c=c.getTransform())&&(e=a.multiplyRectangle(c,e)),b?(b.x=Math.min(b.x,
e.x),b.y=Math.min(b.y,e.y),b.endX=Math.max(b.endX,e.x+e.width),b.endY=Math.max(b.endY,e.y+e.height)):b={x:e.x,y:e.y,endX:e.x+e.width,endY:e.y+e.height})});b&&(b.width=b.endX-b.x,b.height=b.endY-b.y);return b}return null},_moveChildToFront:function(b){for(var a=0;a<this.children.length;++a)if(this.children[a]==b){y(this.children,a);this.children.push(b);break}return this},_moveChildToBack:function(b){for(var a=0;a<this.children.length;++a)if(this.children[a]==b){y(this.children,a);this.children.unshift(b);
break}return this}};m.Surface=q("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){f.forEach(this._nodes,e.destroy);this._nodes=[];f.forEach(this._events,function(b){b&&b.remove()});this._events=[];this.rawNode=null;if(w("ie"))for(;this._parent.lastChild;)e.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},
isLoaded:!0,onLoad:function(b){},whenLoaded:function(b,a){var c=v.hitch(b,a);if(this.isLoaded)c(this);else l.once(this,"load",function(b){c(b)})}});v.extend(m.Surface,m._eventsProcessing);m.Rect=q("dojox.gfx.shape.Rect",m.Shape,{constructor:function(b){this.shape=k.getDefault("Rect");this.rawNode=b},getBoundingBox:function(){return this.shape}});m.Ellipse=q("dojox.gfx.shape.Ellipse",m.Shape,{constructor:function(b){this.shape=k.getDefault("Ellipse");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=
this.shape;this.bbox={x:b.cx-b.rx,y:b.cy-b.ry,width:2*b.rx,height:2*b.ry}}return this.bbox}});m.Circle=q("dojox.gfx.shape.Circle",m.Shape,{constructor:function(b){this.shape=k.getDefault("Circle");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=this.shape;this.bbox={x:b.cx-b.r,y:b.cy-b.r,width:2*b.r,height:2*b.r}}return this.bbox}});m.Line=q("dojox.gfx.shape.Line",m.Shape,{constructor:function(b){this.shape=k.getDefault("Line");this.rawNode=b},getBoundingBox:function(){if(!this.bbox){var b=
this.shape;this.bbox={x:Math.min(b.x1,b.x2),y:Math.min(b.y1,b.y2),width:Math.abs(b.x2-b.x1),height:Math.abs(b.y2-b.y1)}}return this.bbox}});m.Polyline=q("dojox.gfx.shape.Polyline",m.Shape,{constructor:function(b){this.shape=k.getDefault("Polyline");this.rawNode=b},setShape:function(b,a){b&&b instanceof Array?(this.inherited(arguments,[{points:b}]),a&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[b]);return this},_normalizePoints:function(){var b=
this.shape.points,a=b&&b.length;if(a&&"number"==typeof b[0]){for(var c=[],e=0;e<a;e+=2)c.push({x:b[e],y:b[e+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var b=this.shape.points,a=b.length,c=b[0],e=c.x,f=c.y,s=c.x,l=c.y,m=1;m<a;++m)c=b[m],e>c.x&&(e=c.x),s<c.x&&(s=c.x),f>c.y&&(f=c.y),l<c.y&&(l=c.y);this.bbox={x:e,y:f,width:s-e,height:l-f}}return this.bbox}});m.Image=q("dojox.gfx.shape.Image",m.Shape,{constructor:function(b){this.shape=k.getDefault("Image");
this.rawNode=b},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});m.Text=q(m.Shape,{constructor:function(b){this.fontStyle=null;this.shape=k.getDefault("Text");this.rawNode=b},getFont:function(){return this.fontStyle},setFont:function(b){this.fontStyle="string"==typeof b?k.splitFontString(b):k.makeParameters(k.defaultFont,b);this._setFont();return this},getBoundingBox:function(){var b=null;this.getShape().text&&(b=k._base._computeTextBoundingBox(this));
return b}});m.Creator={createShape:function(b){switch(b.type){case k.defaultPath.type:return this.createPath(b);case k.defaultRect.type:return this.createRect(b);case k.defaultCircle.type:return this.createCircle(b);case k.defaultEllipse.type:return this.createEllipse(b);case k.defaultLine.type:return this.createLine(b);case k.defaultPolyline.type:return this.createPolyline(b);case k.defaultImage.type:return this.createImage(b);case k.defaultText.type:return this.createText(b);case k.defaultTextPath.type:return this.createTextPath(b)}return null},
createGroup:function(){return this.createObject(k.Group)},createRect:function(b){return this.createObject(k.Rect,b)},createEllipse:function(b){return this.createObject(k.Ellipse,b)},createCircle:function(b){return this.createObject(k.Circle,b)},createLine:function(b){return this.createObject(k.Line,b)},createPolyline:function(b){return this.createObject(k.Polyline,b)},createImage:function(b){return this.createObject(k.Image,b)},createText:function(b){return this.createObject(k.Text,b)},createPath:function(b){return this.createObject(k.Path,
b)},createTextPath:function(b){return this.createObject(k.TextPath,{}).setText(b)},createObject:function(b,a){return null}};return m})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(k,v,q,t,w){w=q("dojox.gfx.path.Path",w.Shape,{constructor:function(l){this.shape=v.clone(k.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=l;this.segmented=!1},setAbsoluteMode:function(l){this._confirmSegmented();
this.absolute="string"==typeof l?"absolute"==l:l;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var l=this.bbox,f=this._getRealMatrix();this.bbox=null;for(var e=0,c=this.segments.length;e<c;++e)this._updateWithSegment(this.segments[e],
f);f=this.bbox;this.bbox=l;return this.tbbox=f?[{x:f.l,y:f.t},{x:f.r,y:f.t},{x:f.r,y:f.b},{x:f.l,y:f.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(l,f,e){e&&(f=t.multiplyPoint(e,l,f),l=f.x,f=f.y);this.bbox&&"l"in this.bbox?(this.bbox.l>l&&(this.bbox.l=l),this.bbox.r<l&&(this.bbox.r=l),this.bbox.t>f&&(this.bbox.t=f),this.bbox.b<f&&(this.bbox.b=f)):
this.bbox={l:l,b:f,r:l,t:f}},_updateWithSegment:function(l,f){var e=l.args,c=e.length,a;switch(l.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=0;a<c;a+=2)this._updateBBox(e[a],e[a+1],f);this.last.x=e[c-2];this.last.y=e[c-1];this.absolute=!0;break;case "H":for(a=0;a<c;++a)this._updateBBox(e[a],this.last.y,f);this.last.x=e[c-1];this.absolute=!0;break;case "V":for(a=0;a<c;++a)this._updateBBox(this.last.x,e[a],f);this.last.y=e[c-1];this.absolute=!0;break;case "m":a=0;"x"in this.last||
(this._updateBBox(this.last.x=e[0],this.last.y=e[1],f),a=2);for(;a<c;a+=2)this._updateBBox(this.last.x+=e[a],this.last.y+=e[a+1],f);this.absolute=!1;break;case "l":case "t":for(a=0;a<c;a+=2)this._updateBBox(this.last.x+=e[a],this.last.y+=e[a+1],f);this.absolute=!1;break;case "h":for(a=0;a<c;++a)this._updateBBox(this.last.x+=e[a],this.last.y,f);this.absolute=!1;break;case "v":for(a=0;a<c;++a)this._updateBBox(this.last.x,this.last.y+=e[a],f);this.absolute=!1;break;case "c":for(a=0;a<c;a+=6)this._updateBBox(this.last.x+
e[a],this.last.y+e[a+1],f),this._updateBBox(this.last.x+e[a+2],this.last.y+e[a+3],f),this._updateBBox(this.last.x+=e[a+4],this.last.y+=e[a+5],f);this.absolute=!1;break;case "s":case "q":for(a=0;a<c;a+=4)this._updateBBox(this.last.x+e[a],this.last.y+e[a+1],f),this._updateBBox(this.last.x+=e[a+2],this.last.y+=e[a+3],f);this.absolute=!1;break;case "A":for(a=0;a<c;a+=7)this._updateBBox(e[a+5],e[a+6],f);this.last.x=e[c-2];this.last.y=e[c-1];this.absolute=!0;break;case "a":for(a=0;a<c;a+=7)this._updateBBox(this.last.x+=
e[a+5],this.last.y+=e[a+6],f);this.absolute=!1}var y=[l.action];for(a=0;a<c;++a)y.push(k.formatNumber(e[a],!0));if("string"==typeof this.shape.path)this.shape.path+=y.join("");else{a=0;for(c=y.length;a<c;++a)this.shape.path.push(y[a])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(l,f){this.tbbox=null;var e=this._validSegments[l.toLowerCase()];"number"==typeof e&&(e?f.length>=e&&(e={action:l,args:f.slice(0,f.length-f.length%e)},this.segments.push(e),this._updateWithSegment(e)):
(e={action:l,args:[]},this.segments.push(e),this._updateWithSegment(e)))},_collectArgs:function(l,f){for(var e=0;e<f.length;++e){var c=f[e];"boolean"==typeof c?l.push(c?1:0):"number"==typeof c?l.push(c):c instanceof Array?this._collectArgs(l,c):"x"in c&&"y"in c&&l.push(c.x,c.y)}},moveTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"M":"m",l);return this},lineTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);
this._pushSegment(this.absolute?"L":"l",l);return this},hLineTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"H":"h",l);return this},vLineTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"V":"v",l);return this},curveTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"C":"c",l);return this},smoothCurveTo:function(){this._confirmSegmented();
var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"S":"s",l);return this},qCurveTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"Q":"q",l);return this},qSmoothCurveTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"T":"t",l);return this},arcTo:function(){this._confirmSegmented();var l=[];this._collectArgs(l,arguments);this._pushSegment(this.absolute?"A":
"a",l);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var l=this.shape.path;this.shape.path=[];this._setPath(l);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(l){l=v.isArray(l)?l:l.match(k.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(l){for(var f="",e=[],c=l.length,a=0;a<c;++a){var y=l[a],s=parseFloat(y);isNaN(s)?(f&&this._pushSegment(f,
e),e=[],f=y):e.push(s)}this._pushSegment(f,e)}},setShape:function(l){this.inherited(arguments,["string"==typeof l?{path:l}:l]);this.segmented=!1;this.segments=[];k.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});q=q("dojox.gfx.path.TextPath",w,{constructor:function(l){"text"in this||(this.text=v.clone(k.defaultTextPath));"fontStyle"in this||(this.fontStyle=v.clone(k.defaultFont))},getText:function(){return this.text},setText:function(l){this.text=k.makeParameters(this.text,
"string"==typeof l?{text:l}:l);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(l){this.fontStyle="string"==typeof l?k.splitFontString(l):k.makeParameters(k.defaultFont,l);this._setFont();return this}});return k.path={Path:w,TextPath:q}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(k,v,q){function t(a){var c=Math.cos(a);a=Math.sin(a);var e={x:c+4/3*(1-c),y:a-4/3*c*(1-c)/a};return{s:{x:c,y:-a},c1:{x:e.x,y:-e.y},c2:e,e:{x:c,
y:a}}}var w=2*Math.PI,l=Math.PI/4,f=Math.PI/8,e=l+f,c=t(f);return k.arc={unitArcAsBezier:t,curvePI4:c,arcAsBezier:function(a,y,s,m,b,k,u,r){b=Boolean(b);k=Boolean(k);var n=q._degToRad(m);m=y*y;var v=s*s,x=q.multiplyPoint(q.rotate(-n),{x:(a.x-u)/2,y:(a.y-r)/2}),z=x.x*x.x,F=x.y*x.y;m=Math.sqrt((m*v-m*F-v*z)/(m*F+v*z));isNaN(m)&&(m=0);m={x:m*y*x.y/s,y:-m*s*x.x/y};b==k&&(m={x:-m.x,y:-m.y});m=q.multiplyPoint([q.translate((a.x+u)/2,(a.y+r)/2),q.rotate(n)],m);y=q.normalize([q.translate(m.x,m.y),q.rotate(n),
q.scale(y,s)]);m=q.invert(y);a=q.multiplyPoint(m,a);r=q.multiplyPoint(m,u,r);u=Math.atan2(a.y,a.x);r=Math.atan2(r.y,r.x);m=u-r;k&&(m=-m);0>m?m+=w:m>w&&(m-=w);s=f;r=c;s=k?s:-s;a=[];for(b=m;0<b;b-=l)b<e&&(s=b/2,r=t(s),s=k?s:-s,b=0),x=q.normalize([y,q.rotate(u+s)]),k?(m=q.multiplyPoint(x,r.c1),n=q.multiplyPoint(x,r.c2),x=q.multiplyPoint(x,r.e)):(m=q.multiplyPoint(x,r.c2),n=q.multiplyPoint(x,r.c1),x=q.multiplyPoint(x,r.s)),a.push([m.x,m.y,n.x,n.y,x.x,x.y]),u+=2*s;return a}}})},"dojox/gfx/decompose":function(){define(["./_base",
"dojo/_base/lang","./matrix"],function(k,v,q){function t(c,a){return Math.abs(c-a)<=1E-6*(Math.abs(c)+Math.abs(a))}function w(c,a,e,f){if(isFinite(c)){if(!isFinite(e))return c}else return e;a=Math.abs(a);f=Math.abs(f);return(a*c+f*e)/(a+f)}function l(c){c=q.normalize(c);var a=-c.xx-c.yy,e=c.xx*c.yy-c.xy*c.yx,f=Math.sqrt(a*a-4*e),a=-(a+(0>a?-f:f))/2,e=e/a,f=c.xy/(a-c.xx),l=1,b=c.xy/(e-c.xx),k=1;t(a,e)&&(f=1,b=l=0,k=1);isFinite(f)||(f=1,l=(a-c.xx)/c.xy,isFinite(l)||(f=(a-c.yy)/c.yx,l=1,isFinite(f)||
(f=1,l=c.yx/(a-c.yy))));isFinite(b)||(b=1,k=(e-c.xx)/c.xy,isFinite(k)||(b=(e-c.yy)/c.yx,k=1,isFinite(b)||(b=1,k=c.yx/(e-c.yy))));c=Math.sqrt(f*f+l*l);var u=Math.sqrt(b*b+k*k);if(!isFinite(f/=c))f=0;if(!isFinite(l/=c))l=0;if(!isFinite(b/=u))b=0;if(!isFinite(k/=u))k=0;return{value1:a,value2:e,vector1:{x:f,y:l},vector2:{x:b,y:k}}}function f(c,a){var e=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,f=a.angle1=(Math.atan2(c.yx,c.yy)+Math.atan2(-e*c.xy,e*c.xx))/2,e=Math.cos(f),f=Math.sin(f);a.sx=w(c.xx/e,e,-c.xy/f,f);a.sy=
w(c.yy/e,e,c.yx/f,f);return a}function e(c,a){var e=0>c.xx*c.yy||0<c.xy*c.yx?-1:1,f=a.angle2=(Math.atan2(e*c.yx,e*c.xx)+Math.atan2(-c.xy,c.yy))/2,e=Math.cos(f),f=Math.sin(f);a.sx=w(c.xx/e,e,c.yx/f,f);a.sy=w(c.yy/e,e,-c.xy/f,f);return a}return k.decompose=function(c){var a=q.normalize(c);c={dx:a.dx,dy:a.dy,sx:1,sy:1,angle1:0,angle2:0};if(t(a.xy,0)&&t(a.yx,0))return v.mixin(c,{sx:a.xx,sy:a.yy});if(t(a.xx*a.yx,-a.xy*a.yy))return f(a,c);if(t(a.xx*a.xy,-a.yx*a.yy))return e(a,c);var k,s=new q.Matrix2D(a);
k=v.mixin(s,{dx:0,dy:0,xy:s.yx,yx:s.xy});s=l([a,k]);k=l([k,a]);s=new q.Matrix2D({xx:s.vector1.x,xy:s.vector2.x,yx:s.vector1.y,yy:s.vector2.y});k=new q.Matrix2D({xx:k.vector1.x,xy:k.vector1.y,yx:k.vector2.x,yy:k.vector2.y});a=new q.Matrix2D([q.invert(s),a,q.invert(k)]);f(k,c);a.xx*=c.sx;a.yy*=c.sy;e(s,c);a.xx*=c.sx;a.yy*=c.sy;return v.mixin(c,{sx:a.xx,sy:a.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(k){k=k.bezierutils={};k.tAtLength=function(f,e){var c=0,a=6==f.length,k=
0,s=0,m=a?t:l,b=function(l,u){for(var r=0,n=0;n<l.length-2;n+=2)r+=q(l[n],l[n+1],l[n+2],l[n+3]);n=a?q(f[0],f[1],f[4],f[5]):q(f[0],f[1],f[6],f[7]);r-n>u||k+r>e+u?(++s,r=m(l,0.5),b(r[0],u),Math.abs(k-e)<=u||b(r[1],u)):(k+=r,c+=1/(1<<s))};e&&b(f,0.5);return c};var v=k.computeLength=function(f){for(var e=6==f.length,c=0,a=0;a<f.length-2;a+=2)c+=q(f[a],f[a+1],f[a+2],f[a+3]);a=e?q(f[0],f[1],f[4],f[5]):q(f[0],f[1],f[6],f[7]);0.1<c-a&&(f=e?t(f,0.5):w(f,0.5),c=v(f[0],e),c+=v(f[1],e));return c},q=k.distance=
function(f,e,c,a){return Math.sqrt((c-f)*(c-f)+(a-e)*(a-e))},t=function(f,e){var c=1-e,a=c*c,l=e*e,k=f[0],m=f[1],b=f[2],q=f[3],u=f[4],r=f[5],n=a*k+2*c*e*b+l*u,a=a*m+2*c*e*q+l*r;return[[k,m,c*k+e*b,c*m+e*q,n,a],[n,a,c*b+e*u,c*q+e*r,u,r]]},w=function(f,e){var c=1-e,a=c*c,l=a*c,k=e*e,m=k*e,b=f[0],q=f[1],u=f[2],r=f[3],n=f[4],t=f[5],x=f[6],v=f[7],w=l*b+3*a*e*u+3*c*k*n+m*x,l=l*q+3*a*e*r+3*c*k*t+m*v;return[[b,q,c*b+e*u,c*q+e*r,a*b+2*c*e*u+k*n,a*q+2*c*e*r+k*t,w,l],[w,l,a*u+2*c*e*n+k*x,a*r+2*c*e*t+k*v,c*n+
e*x,c*t+e*v,x,v]]},l=k.splitBezierAtT=function(f,e){return 6==f.length?t(f,e):w(f,e)};return k})},"*noref":1}});
define("dojox/gfx/canvas","./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(k,v,q,t,w,l,f,e,c,a,y,s,m){function b(g,h,d,b,a,c,e,f,k,l){var m,n,q=h.length,r=0;l?(n=l.l/a,r=l.i):n=h[0]/a;for(;c<e;)c+n>e&&(m={l:(c+n-e)*a,i:r},n=e-c),r%2||(g.beginPath(),g.arc(d,b,a,c,c+n,f),k&&g.stroke()),c+=n,++r,n=h[r%q]/a;return m}function I(g,h,d,b){var a=0,c=0,e,f=0;b?(e=b.l,f=b.i):
e=h[0];for(;1>c;)c=m.tAtLength(g,e),1==c&&(a=m.computeLength(g),a={l:e-a,i:f}),g=m.splitBezierAtT(g,c),f%2||d.push(g[0]),g=g[1],++f,e=h[f%h.length];return a}function u(g,h,d,a){var b=[h.last.x,h.last.y].concat(d),c=!(g instanceof Array);d=4===d.length?"quadraticCurveTo":"bezierCurveTo";var e=[];h=I(b,h.canvasDash,e,a);for(a=0;a<e.length;++a)b=e[a],c?(g.moveTo(b[0],b[1]),g[d].apply(g,b.slice(2))):(g.push("moveTo",[b[0],b[1]]),g.push(d,b.slice(2)));return h}function r(g,h,d,b,a,c,e){var f=0,l=0,k=0,
n=m.distance(d,b,a,c),q=0;h=h.canvasDash;var r=d,s=b,t,u=!(g instanceof Array);e?(k=e.l,q=e.i):k+=h[0];for(;0.01<Math.abs(1-l);)k>n&&(f={l:k-n,i:q},k=n),l=k/n,e=d+(a-d)*l,t=b+(c-b)*l,q++%2||(u?(g.moveTo(r,s),g.lineTo(e,t)):(g.push("moveTo",[r,s]),g.push("lineTo",[e,t]))),r=e,s=t,k+=h[q%h.length];return f}var n=k.canvas={},C=null,x=y.multiplyPoint,z=Math.PI,F=2*z,A=z/2;s=v.extend;if(w.global.CanvasRenderingContext2D){w=w.doc.createElement("canvas").getContext("2d");var G="function"==typeof w.setLineDash,
K="function"==typeof w.fillText}var J={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};n.Shape=t("dojox.gfx.canvas.Shape",e.Shape,{_render:function(g){g.save();this._renderTransform(g);this._renderClip(g);this._renderShape(g);this._renderFill(g,!0);this._renderStroke(g,!0);g.restore()},_renderClip:function(g){this.canvasClip&&(this.canvasClip.render(g),
g.clip())},_renderTransform:function(g){if("canvasTransform"in this){var h=this.canvasTransform;g.translate(h.dx,h.dy);g.rotate(h.angle2);g.scale(h.sx,h.sy);g.rotate(h.angle1)}},_renderShape:function(g){},_renderFill:function(g,h){if("canvasFill"in this){var d=this.fillStyle;if("canvasFillImage"in this){var b=d.width,a=d.height,c=this.canvasFillImage.width,e=this.canvasFillImage.height,f=Math.min(b==c?1:b/c,a==e?1:a/e),k=(b-f*c)/2,l=(a-f*e)/2;C.width=b;C.height=a;var m=C.getContext("2d");m.clearRect(0,
0,b,a);m.drawImage(this.canvasFillImage,0,0,c,e,k,l,f*c,f*e);this.canvasFill=g.createPattern(C,"repeat");delete this.canvasFillImage}g.fillStyle=this.canvasFill;h&&("pattern"===d.type&&(0!==d.x||0!==d.y)&&g.translate(d.x,d.y),g.fill())}else g.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(g,h){var d=this.strokeStyle;d?(g.strokeStyle=d.color.toString(),g.lineWidth=d.width,g.lineCap=d.cap,"number"==typeof d.join?(g.lineJoin="miter",g.miterLimit=d.join):g.lineJoin=d.join,this.canvasDash?G?(g.setLineDash(this.canvasDash),
h&&g.stroke()):this._renderDashedStroke(g,h):h&&g.stroke()):h||(g.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(g,h){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(g){this.inherited(arguments);var h=g?"width"in g?"rect":"cx"in g?"ellipse":"points"in g?"polyline":"d"in g?"path":null:null;if(g&&!h)return this;this.canvasClip=g?L(h,g):null;this.parent&&this.parent._makeDirty();return this}});var L=
function(g,h){switch(g){case "ellipse":return{canvasEllipse:H({shape:h}),render:function(d){return n.Ellipse.prototype._renderShape.call(this,d)}};case "rect":return{shape:v.delegate(h,{r:0}),render:function(d){return n.Rect.prototype._renderShape.call(this,d)}};case "path":return{canvasPath:M(h),render:function(d){this.canvasPath._renderShape(d)}};case "polyline":return{canvasPolyline:h.points,render:function(d){return n.Polyline.prototype._renderShape.call(this,d)}}}return null},M=function(g){var h=
new dojox.gfx.canvas.Path;h.canvasPath=[];h._setPath(g.d);return h},D=function(g,h,d){var b=g.prototype[h];g.prototype[h]=d?function(){this.parent&&this.parent._makeDirty();b.apply(this,arguments);d.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return b.apply(this,arguments)}};D(n.Shape,"setTransform",function(){this.matrix?this.canvasTransform=k.decompose(this.matrix):delete this.canvasTransform});D(n.Shape,"setFill",function(){var g=this.fillStyle,h;if(g){if("object"==
typeof g&&"type"in g){var d=this.surface.rawNode.getContext("2d");switch(g.type){case "linear":case "radial":h="linear"==g.type?d.createLinearGradient(g.x1,g.y1,g.x2,g.y2):d.createRadialGradient(g.cx,g.cy,0,g.cx,g.cy,g.r);q.forEach(g.colors,function(d){h.addColorStop(d.offset,k.normalizeColor(d.color).toString())});break;case "pattern":C||(C=document.createElement("canvas")),d=new Image,this.surface.downloadImage(d,g.src),this.canvasFillImage=d}}else h=g.toString();this.canvasFill=h}else delete this.canvasFill});
D(n.Shape,"setStroke",function(){var g=this.strokeStyle;if(g){var h=this.strokeStyle.style.toLowerCase();h in J&&(h=J[h]);if(h instanceof Array){this.canvasDash=h=h.slice();var d;for(d=0;d<h.length;++d)h[d]*=g.width;if("butt"!=g.cap){for(d=0;d<h.length;d+=2)h[d]-=g.width,1>h[d]&&(h[d]=1);for(d=1;d<h.length;d+=2)h[d]+=g.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!G&&!!this.canvasDash});D(n.Shape,"setShape");n.Group=t("dojox.gfx.canvas.Group",n.Shape,{constructor:function(){e.Container._init.call(this)},
_render:function(g){g.save();this._renderTransform(g);this._renderClip(g);for(var h=0;h<this.children.length;++h)this.children[h]._render(g);g.restore()},destroy:function(){e.Container.clear.call(this,!0);n.Shape.prototype.destroy.apply(this,arguments)}});n.Rect=t("dojox.gfx.canvas.Rect",[n.Shape,e.Rect],{_renderShape:function(g){var h=this.shape,d=Math.min(h.r,h.height/2,h.width/2),b=h.x,a=b+h.width,c=h.y,h=c+h.height,e=b+d,f=a-d,k=c+d,l=h-d;g.beginPath();g.moveTo(e,c);d?(g.arc(f,k,d,-A,0,!1),g.arc(f,
l,d,0,A,!1),g.arc(e,l,d,A,z,!1),g.arc(e,k,d,z,z+A,!1)):(g.lineTo(f,c),g.lineTo(a,l),g.lineTo(e,h),g.lineTo(b,k));g.closePath()},_renderDashedStroke:function(g,h){var d=this.shape,a=Math.min(d.r,d.height/2,d.width/2),c=d.x,e=c+d.width,f=d.y,k=f+d.height,l=c+a,m=e-a,n=f+a,q=k-a;a?(g.beginPath(),d=r(g,this,l,f,m,f),h&&g.stroke(),d=b(g,this.canvasDash,m,n,a,-A,0,!1,h,d),g.beginPath(),d=r(g,this,e,n,e,q,d),h&&g.stroke(),d=b(g,this.canvasDash,m,q,a,0,A,!1,h,d),g.beginPath(),d=r(g,this,m,k,l,k,d),h&&g.stroke(),
d=b(g,this.canvasDash,l,q,a,A,z,!1,h,d),g.beginPath(),d=r(g,this,c,q,c,n,d),h&&g.stroke(),b(g,this.canvasDash,l,n,a,z,z+A,!1,h,d)):(g.beginPath(),d=r(g,this,l,f,m,f),d=r(g,this,m,f,e,q,d),d=r(g,this,e,q,l,k,d),r(g,this,l,k,c,n,d),h&&g.stroke())}});var B=[];(function(){var g=a.curvePI4;B.push(g.s,g.c1,g.c2,g.e);for(var h=45;360>h;h+=45){var d=y.rotateg(h);B.push(x(d,g.c1),x(d,g.c2),x(d,g.e))}})();var H=function(g){var h,d,a,b=[],c=g.shape,e=y.normalize([y.translate(c.cx,c.cy),y.scale(c.rx,c.ry)]);
h=x(e,B[0]);b.push([h.x,h.y]);for(c=1;c<B.length;c+=3)d=x(e,B[c]),a=x(e,B[c+1]),h=x(e,B[c+2]),b.push([d.x,d.y,a.x,a.y,h.x,h.y]);if(g._needsDash){h=[];d=b[0];for(c=1;c<b.length;++c)a=[],I(d.concat(b[c]),g.canvasDash,a),d=[b[c][4],b[c][5]],h.push(a);g._dashedPoints=h}return b};n.Ellipse=t("dojox.gfx.canvas.Ellipse",[n.Shape,e.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=H(this);return this},setStroke:function(){this.inherited(arguments);G||(this.canvasEllipse=H(this));
return this},_renderShape:function(g){var h=this.canvasEllipse,d;g.beginPath();g.moveTo.apply(g,h[0]);for(d=1;d<h.length;++d)g.bezierCurveTo.apply(g,h[d]);g.closePath()},_renderDashedStroke:function(g,h){var d=this._dashedPoints;g.beginPath();for(var b=0;b<d.length;++b)for(var a=d[b],c=0;c<a.length;++c){var e=a[c];g.moveTo(e[0],e[1]);g.bezierCurveTo(e[2],e[3],e[4],e[5],e[6],e[7])}h&&g.stroke()}});n.Circle=t("dojox.gfx.canvas.Circle",[n.Shape,e.Circle],{_renderShape:function(g){var h=this.shape;g.beginPath();
g.arc(h.cx,h.cy,h.r,0,F,1)},_renderDashedStroke:function(g,h){var d=this.shape,b=0,a,c=this.canvasDash.length;for(i=0;b<F;)a=this.canvasDash[i%c]/d.r,i%2||(g.beginPath(),g.arc(d.cx,d.cy,d.r,b,b+a,0),h&&g.stroke()),b+=a,++i}});n.Line=t("dojox.gfx.canvas.Line",[n.Shape,e.Line],{_renderShape:function(g){var h=this.shape;g.beginPath();g.moveTo(h.x1,h.y1);g.lineTo(h.x2,h.y2)},_renderDashedStroke:function(g,h){var d=this.shape;g.beginPath();r(g,this,d.x1,d.y1,d.x2,d.y2);h&&g.stroke()}});n.Polyline=t("dojox.gfx.canvas.Polyline",
[n.Shape,e.Polyline],{setShape:function(){this.inherited(arguments);var g=this.shape.points,h=g[0],d,b;this.bbox=null;this._normalizePoints();if(g.length)if("number"==typeof h)h=g;else{h=[];for(b=0;b<g.length;++b)d=g[b],h.push(d.x,d.y)}else h=[];this.canvasPolyline=h;return this},_renderShape:function(b){var h=this.canvasPolyline;if(h.length){b.beginPath();b.moveTo(h[0],h[1]);for(var d=2;d<h.length;d+=2)b.lineTo(h[d],h[d+1])}},_renderDashedStroke:function(b,h){var d=this.canvasPolyline,a=0;b.beginPath();
for(var c=0;c<d.length;c+=2)a=r(b,this,d[c],d[c+1],d[c+2],d[c+3],a);h&&b.stroke()}});n.Image=t("dojox.gfx.canvas.Image",[n.Shape,e.Image],{setShape:function(){this.inherited(arguments);var b=new Image;this.surface.downloadImage(b,this.shape.src);this.canvasImage=b;return this},_renderShape:function(b){var h=this.shape;b.drawImage(this.canvasImage,h.x,h.y,h.width,h.height)}});n.Text=t("dojox.gfx.canvas.Text",[n.Shape,e.Text],{_setFont:function(){this.fontStyle?this.canvasFont=k.makeFontString(this.fontStyle):
delete this.canvasFont},getTextWidth:function(){var b=this.shape,h=0,d;b.text&&(d=this.surface.rawNode.getContext("2d"),d.save(),this._renderTransform(d),this._renderFill(d,!1),this._renderStroke(d,!1),this.canvasFont&&(d.font=this.canvasFont),h=d.measureText(b.text).width,d.restore());return h},_render:function(b){b.save();this._renderTransform(b);this._renderFill(b,!1);this._renderStroke(b,!1);this._renderShape(b);b.restore()},_renderShape:function(b){var h,d=this.shape;d.text&&(h="middle"===d.align?
"center":d.align,b.textAlign=h,this.canvasFont&&(b.font=this.canvasFont),this.canvasFill&&b.fillText(d.text,d.x,d.y),this.strokeStyle&&(b.beginPath(),b.strokeText(d.text,d.x,d.y),b.closePath()))}});D(n.Text,"setFont");K||n.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var N={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",
Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};n.Path=t("dojox.gfx.canvas.Path",[n.Shape,c.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);G||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(b){var h=
v.clone(this.last);this[N[b.action]](this.canvasPath,b.action,b.args,this._needsDash?this._dashedPath:null);this.last=h;this.inherited(arguments)},_renderShape:function(b){var h=this.canvasPath;b.beginPath();for(var d=0;d<h.length;d+=2)b[h[d]].apply(b,h[d+1])},_renderDashedStroke:G?function(){}:function(b,h){var d=this._dashedPath;b.beginPath();for(var a=0;a<d.length;a+=2)b[d[a]].apply(b,d[a+1]);h&&b.stroke()},_moveToA:function(b,h,d,a){b.push("moveTo",[d[0],d[1]]);a&&a.push("moveTo",[d[0],d[1]]);
for(h=2;h<d.length;h+=2)b.push("lineTo",[d[h],d[h+1]]),a&&(this._dashResidue=r(a,this,d[h-2],d[h-1],d[h],d[h+1],this._dashResidue));this.last.x=d[d.length-2];this.last.y=d[d.length-1];this.lastControl={}},_moveToR:function(b,h,d,a){h="x"in this.last?[this.last.x+=d[0],this.last.y+=d[1]]:[this.last.x=d[0],this.last.y=d[1]];b.push("moveTo",h);a&&a.push("moveTo",h);for(h=2;h<d.length;h+=2)b.push("lineTo",[this.last.x+=d[h],this.last.y+=d[h+1]]),a&&(this._dashResidue=r(a,this,a[a.length-1][0],a[a.length-
1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(b,a,d,c){for(a=0;a<d.length;a+=2)c&&(this._dashResidue=r(c,this,this.last.x,this.last.y,d[a],d[a+1],this._dashResidue)),b.push("lineTo",[d[a],d[a+1]]);this.last.x=d[d.length-2];this.last.y=d[d.length-1];this.lastControl={}},_lineToR:function(b,a,d,c){for(a=0;a<d.length;a+=2)b.push("lineTo",[this.last.x+=d[a],this.last.y+=d[a+1]]),c&&(this._dashResidue=r(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,
this._dashResidue));this.lastControl={}},_hLineToA:function(b,a,d,c){for(a=0;a<d.length;++a)b.push("lineTo",[d[a],this.last.y]),c&&(this._dashResidue=r(c,this,c[c.length-1][0],c[c.length-1][1],d[a],this.last.y,this._dashResidue));this.last.x=d[d.length-1];this.lastControl={}},_hLineToR:function(b,a,d,c){for(a=0;a<d.length;++a)b.push("lineTo",[this.last.x+=d[a],this.last.y]),c&&(this._dashResidue=r(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl=
{}},_vLineToA:function(b,a,d,c){for(a=0;a<d.length;++a)b.push("lineTo",[this.last.x,d[a]]),c&&(this._dashResidue=r(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,d[a],this._dashResidue));this.last.y=d[d.length-1];this.lastControl={}},_vLineToR:function(b,a,d,c){for(a=0;a<d.length;++a)b.push("lineTo",[this.last.x,this.last.y+=d[a]]),c&&(this._dashResidue=r(c,this,c[c.length-1][0],c[c.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(b,a,d,c){for(a=
0;a<d.length;a+=6)b.push("bezierCurveTo",d.slice(a,a+6)),c&&(this._dashResidue=u(c,this,b[b.length-1],this._dashResidue));this.last.x=d[d.length-2];this.last.y=d[d.length-1];this.lastControl.x=d[d.length-4];this.lastControl.y=d[d.length-3];this.lastControl.type="C"},_curveToR:function(b,a,d,c){for(a=0;a<d.length;a+=6)b.push("bezierCurveTo",[this.last.x+d[a],this.last.y+d[a+1],this.lastControl.x=this.last.x+d[a+2],this.lastControl.y=this.last.y+d[a+3],this.last.x+d[a+4],this.last.y+d[a+5]]),c&&(this._dashResidue=
u(c,this,b[b.length-1],this._dashResidue)),this.last.x+=d[a+4],this.last.y+=d[a+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,d,c){for(b=0;b<d.length;b+=4){var e="C"==this.lastControl.type;a.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,d[b],d[b+1],d[b+2],d[b+3]]);c&&(this._dashResidue=u(c,this,a[a.length-1],this._dashResidue));this.lastControl.x=d[b];this.lastControl.y=d[b+1];this.lastControl.type="C"}this.last.x=
d[d.length-2];this.last.y=d[d.length-1]},_smoothCurveToR:function(b,a,d,c){for(a=0;a<d.length;a+=4){var e="C"==this.lastControl.type;b.push("bezierCurveTo",[e?2*this.last.x-this.lastControl.x:this.last.x,e?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+d[a],this.last.y+d[a+1],this.last.x+d[a+2],this.last.y+d[a+3]]);c&&(this._dashResidue=u(c,this,b[b.length-1],this._dashResidue));this.lastControl.x=this.last.x+d[a];this.lastControl.y=this.last.y+d[a+1];this.lastControl.type="C";this.last.x+=
d[a+2];this.last.y+=d[a+3]}},_qCurveToA:function(a,b,c,e){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));e&&(this._dashResidue=u(e,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,b,c,e){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+
2],this.last.y+c[b+3]]),e&&(this._dashResidue=u(e,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(b,a,c,e){for(a=0;a<c.length;a+=2){var f="Q"==this.lastControl.type;b.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,c[a],c[a+1]]);e&&(this._dashResidue=u(e,this,b[b.length-1],this._dashResidue));this.lastControl.type=
"Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(b,a,c,e){for(a=0;a<c.length;a+=2){var f="Q"==this.lastControl.type;b.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[a],this.last.y+c[a+1]]);e&&(this._dashResidue=u(e,this,b[b.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[a];this.last.y+=c[a+1]}},_arcTo:function(b,c,d,e){c=
"a"==c;for(var f=0;f<d.length;f+=7){var k=d[f+5],l=d[f+6];c&&(k+=this.last.x,l+=this.last.y);var m=a.arcAsBezier(this.last,d[f],d[f+1],d[f+2],d[f+3]?1:0,d[f+4]?1:0,k,l);q.forEach(m,function(a){b.push("bezierCurveTo",a)});e&&(this._dashResidue=u(e,this,p,this._dashResidue));this.last.x=k;this.last.y=l}this.lastControl={}},_closePath:function(a,b,c,e){a.push("closePath",[]);e&&(this._dashResidue=r(e,this,this.last.x,this.last.y,e[1][0],e[1][1],this._dashResidue));this.lastControl={}}});q.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),
function(a){D(n.Path,a)});n.TextPath=t("dojox.gfx.canvas.TextPath",[n.Shape,c.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});n.Surface=t("dojox.gfx.canvas.Surface",e.Surface,{constructor:function(){e.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){e.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=k.normalizedLength(a);this.height=k.normalizedLength(b);if(!this.rawNode)return this;
var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){if(this.rawNode&&(a||!this.pendingImageCount))a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),
delete this.pendingRender)},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){!this.pendingImagesCount&&(!("pendingRender"in this)&&!this._batch)&&(this.pendingRender=setTimeout(v.hitch(this,this._render),0))},downloadImage:function(a,b){var c=v.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;
a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});n.createSurface=function(a,b,c){if(!b&&!c){var e=l.position(a);b=b||e.w;c=c||e.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");e=new n.Surface;a=f.byId(a);var m=a.ownerDocument.createElement("canvas");m.width=k.normalizedLength(b);m.height=k.normalizedLength(c);
a.appendChild(m);e.rawNode=m;e._parent=a;return e.surface=e};var E=e.Container;t={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return E.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return E.remove.apply(this,arguments)},clear:function(){this._makeDirty();return E.clear.apply(this,arguments)},
getBoundingBox:E.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return E._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return E._moveChildToBack.apply(this,arguments)}};c={createObject:function(a,b){var c=new a;c.surface=this.surface;c.setShape(b);this.add(c);return c}};s(n.Group,t);s(n.Group,e.Creator);s(n.Group,c);s(n.Surface,t);s(n.Surface,e.Creator);s(n.Surface,c);n.fixTarget=function(a,b){return!0};return n});