// -*- ecoding=utf-8 -*-
// Name		:x-lib 
// Version	:0.0.4 
// Author	:ruanyu@live.com 
// Date		:2017-04-17

define("src/core",["require","exports"],function(require,exports){"use strict";var x={type:function(a){try{return void 0===a?"undefined":null===a?"null":/\[object ([A-Za-z]+)\]/.exec(Object.prototype.toString.call(a))[1].toLowerCase()}catch(a){if(a instanceof RangeError)return"...";throw a}},isArray:function(a){return"array"===x.type(a)},isFunction:function(a){return"function"===x.type(a)},isString:function(a){return"string"===x.type(a)},isNumber:function(a){return"number"===x.type(a)},isUndefined:function(a){return"undefined"===x.type(a)},scriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",jsonFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,quickExpr:/^[^<]*(<(.|\s)+>)[^>]*$|^#([\w-]+)$/,isSimple:/^.[^:#\[\.,]*$/,noop:function(){},register:function(a){for(var b=a.split("."),c=window,d=0;d<b.length;d++)x.isUndefined(c[b[d]])&&(c[b[d]]={}),c=c[b[d]];return c},ext:function(a,b){var c=arguments[0]||{};if(arguments.length>1)for(var d=1;d<arguments.length;d++)for(var e in arguments[d])c[e]=arguments[d][e];return c},clone:function(a){return x.ext({},a)},invoke:function(a,b){var c=Array.prototype.slice.call(arguments).slice(2);return b.apply(a,c)},call:function(anything){if(!x.isUndefined(anything))try{if(x.isFunction(anything)){var args=Array.prototype.slice.call(arguments).slice(1);return anything.apply(this,args)}if("string"===x.type(anything)&&""!==anything)return eval(anything)}catch(a){console.error(a)}},query:function(a){return 0==x.type(a).indexOf("html")?a:"string"==x.type(a)?document.querySelector(a):void 0},queryAll:function(a){if(0==x.type(a).indexOf("html")){var b=[];return b.push(a),b}if("string"==x.type(a))return document.querySelectorAll(a)},serialize:function(a){var b=[],c=a.length;if(x.isArray(a))for(var d=0;d<c;d++)b.push(a[d].name+"="+encodeURIComponent(a[d].value));else for(var e in a)b.push(e+"="+encodeURIComponent(a[e]));return b.join("&")},each:function(a,b){var c,d=0,e=a.length;if(x.isArray(a))for(var f=a[0];d<e&&0!=b.call(f,d,f);f=a[++d]);else for(c in a)if(!1===b.call(a[c],c,a[c]))break;return a},toJSON:function(a){if("object"===x.type(a))return a;if(!x.isUndefined(a)&&""!==a){var b=arguments[1];try{return JSON?JSON.parse(a):Function("return "+a)()}catch(c){try{return Function("return "+a)()}catch(c){return void(b||x.debug.error('{"method":"x.toJSON(text)", "arguments":{"text":"'+a+'"}'))}}}},toSafeJSON:function(a){for(var b="",c=0;c<a.length;c++){var d=a.substr(c,1);'"'===d||"'"===d||"\\"===d?(b+="\\",b+=d):b+="\b"===d?"\\b":"\f"===d?"\\f":"\n"===d?"\\n":"\t"===d?"\\t":"\r"===d?"\\r":d}return b},toSafeLike:function(a){return a.replace(/\[/g,"[[]").replace(/%/g,"[%]").replace(/_/g,"[_]")},cdata:function(a){return"<![CDATA["+a+"]]>"},camelCase:function(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(a,b){return b.toUpperCase()})},paddingZero:function(a,b){return(Array(b).join("0")+a).slice(-b)},formatNature:function(a){switch(a.toLowerCase()){case"en-us":a="en-us";break;case"zh-cn":default:a="zh-cn"}return a},getFriendlyName:function(a){return x.camelCase(("x-"+a).replace(/[\#\$\.\/\\\:\?\=]/g,"-").replace(/[-]+/g,"-"))},newHashTable:function(){return{innerArray:[],clear:function(){this.innerArray=[]},exist:function(a){for(var b=0;b<this.innerArray.length;b++)if(this.innerArray[b].name===a)return!0;return!1},get:function(a){return this.innerArray[a]},add:function(a,b){if(1===arguments.length)for(var c=a.split(";"),d=0;d<c.length;d++){var e=c[d].split("#");this.innerArray.push({name:e[0],value:e[1]})}else{if(this.exist(a))throw"hashtable aleardy exist same key["+a+"]";this.innerArray.push({name:a,value:b})}},find:function(a){for(var b=0;b<this.innerArray.length;b++)if(this.innerArray[b].name===a)return this.innerArray[b].value;return null},size:function(){return this.innerArray.length}}},newQueue:function(){return{innerArray:[],push:function(a){this.innerArray.push(a)},pop:function(){if(0===this.innerArray.length)return null;for(var a=this.innerArray[0],b=0;b<this.innerArray.length-1;b++)this.innerArray[b]=this.innerArray[b+1];return this.innerArray.length=this.innerArray.length-1,a},peek:function(){return 0===this.innerArray.length?null:this.innerArray[0]},clear:function(){this.innerArray.length=0},size:function(){return this.innerArray.length},isEmpty:function(){return 0===this.innerArray.length}}},newStack:function(){return{innerArray:[],push:function(a){this.innerArray[this.innerArray.length]=a},pop:function(){if(0===this.innerArray.length)return null;var a=this.innerArray[this.innerArray.length-1];return this.innerArray.length--,a},peek:function(){return 0===this.innerArray.length?null:this.innerArray[this.innerArray.length-1]},clear:function(){this.innerArray.length=0},size:function(){return this.innerArray.length},isEmpty:function(){return 0===this.innerArray.length}}},newStringBuilder:function(){return{innerArray:[],append:function(a){this.innerArray[this.innerArray.length]=a},toString:function(){return this.innerArray.join("")}}},timers:{},newTimer:function(interval,callback){var timer={name:"timer$"+Math.ceil(9e8*Math.random()+1e8),interval:1e3*interval,callback:callback,run:function(){this.callback(this)},start:function(){eval("x.timers."+this.name+" = this;"),this.timerId=setInterval("x.timers."+this.name+".run()",this.interval)},stop:function(){clearInterval(this.timerId),eval("x.timers."+this.name+" = null;")}};return timer},event:{getEvent:function(a){return window.event?window.event:a},getTarget:function(a){return window.event?window.event.srcElement:a?a.target:null},getPosition:function(a){var b=document.documentElement,c=document.body||{scrollLeft:0,scrollTop:0};return{x:a.pageX||a.clientX+(b.scrollLeft||c.scrollLeft)-(b.clientLeft||0),y:a.pageY||a.clientY+(b.scrollTop||c.scrollTop)-(b.clientTop||0)}},preventDefault:function(a){a&&a.preventDefault?a.preventDefault():window.event.returnValue=!1},stopPropagation:function(a){return a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0,!1},add:function(a,b,c,d){null!=a&&(a.addEventListener?a.addEventListener(b,c,d):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)},remove:function(a,b,c,d){null!=a&&(a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null)}},guid:{create:function(a,b){var c="";a=(a||"-").toLowerCase();for(var d=0;d<8;d++)c+=(65536*(1+Math.random())|0).toString(16).substring(1),d>0&&d<5&&"-"===a&&(c+="-");return c=b?c.toUpperCase():c.toLowerCase()}},randomText:{create:function(a,b){for(var c="",b="string"==x.type(b)?b:"0123456789abcdefghijklmnopqrstuvwyzx",d=0;d<a;d++)c+=b.charAt(Math.ceil(1e8*Math.random())%b.length);return c}},nonce:function(a){return void 0===a&&(a=6),Number(x.randomText.create(1,"123456789")+x.randomText.create(a-1,"0123456789"))},debug:{log:function(a){x.isUndefined(console)||console.log(a)},warn:function(a){x.isUndefined(console)||console.warn(a)},error:function(a){x.isUndefined(console)||console.error(a)},assert:function(a){x.isUndefined(console)||console.assert(a)},time:function(a){x.isUndefined(console)||console.time(a)},timeEnd:function(a){x.isUndefined(console)||console.timeEnd(a)},timestamp:function(){var a=new Date;return"{yyyy-MM-dd HH:mm:ss.fff}".replace(/yyyy/,a.getFullYear().toString()).replace(/MM/,a.getMonth()+1>9?(a.getMonth()+1).toString():"0"+(a.getMonth()+1)).replace(/dd|DD/,a.getDate()>9?a.getDate().toString():"0"+a.getDate()).replace(/hh|HH/,a.getHours()>9?a.getHours().toString():"0"+a.getHours()).replace(/mm/,a.getMinutes()>9?a.getMinutes().toString():"0"+a.getMinutes()).replace(/ss|SS/,a.getSeconds()>9?a.getSeconds().toString():"0"+a.getSeconds()).replace(/fff/g,a.getMilliseconds()>99?a.getMilliseconds().toString():a.getMilliseconds()>9?"0"+a.getMilliseconds():"00"+a.getMilliseconds())}}};return x}),define("src/color",["require","exports"],function(a,b){"use strict";return{hex:function(a){if(/^(rgb|RGB)/.test(a)){for(var b=a.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),c="#",d=0;d<b.length;d++){var e=Number(b[d]).toString(16);"0"===e&&(e+=e),c+=e}return 7!==c.length&&(c=a),c}if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(a))return a;var b=a.replace(/#/,"").split("");if(6===b.length)return a;if(3===b.length){for(var f="#",d=0;d<b.length;d+=1)f+=b[d]+b[d];return f}},rgb:function(a){var b=a.toLowerCase();if(b&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(b)){if(4===b.length){for(var c="#",d=1;d<4;d+=1)c+=b.slice(d,d+1).concat(b.slice(d,d+1));b=c}for(var e=[],d=1;d<7;d+=2)e.push(parseInt("0x"+b.slice(d,d+2)));return"rgb("+e.join(", ")+")"}return b}}}),define("src/string",["require","exports","src/core"],function(a,b,c){"use strict";var d={stringify:function(a){var b=c.type(a);return"string"!==b&&("number"===b?a+="":a="function"===b?d.stringify(a.call(a)):""),a},trim:function(a,b){return c.isUndefined(b)?a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):d.rtrim(d.ltrim(a,b),b)},ltrim:function(a,b){return c.isUndefined(b)?a.replace(/(^[\s\uFEFF\xA0]+)/g,""):a.replace(RegExp("(^"+b.replace(/\\/g,"\\\\")+")","gi"),"")},rtrim:function(a,b){return c.isUndefined(b)?a.replace(/([\s\uFEFF\xA0]+$)/g,""):a.replace(RegExp("("+b.replace(/\\/g,"\\\\")+"$)","gi"),"")},format:function(a){if(0==arguments.length)return null;for(var a=arguments[0],b=1;b<arguments.length;b++){var c=new RegExp("\\{"+(b-1)+"\\}","gm");a=a.replace(c,arguments[b])}return a},left:function(a,b,c){return 0===a.length?a:a.length>b?a.substr(0,b)+"...":a}};return d}),define("src/encoding",["require","exports","src/core","src/string"],function(a,b,c,d){"use strict";var e={html:{dict:{"&":"&#32;"," ":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;"},encode:function(a){return 0===a.length?"":(a=d.stringify(a),a.replace(/&(?![\w#]+;)|[<>"']/g,function(a){return e.html.dict[a]}))},decode:function(a){if(0===a.length)return"";a=d.stringify(a);var b="";return b=a.replace(/&amp;/g,"&"),b=b.replace(/&lt;/g,"<"),b=b.replace(/&gt;/g,">"),b=b.replace(/&nbsp;/g,"  "),b=b.replace(/&#39;/g,"'"),b=b.replace(/&quot;/g,'"')}},unicode:{encode:function(a,b){if(0===a.length)return"";b=c.isUndefined(b)?"\\u":b,a=d.stringify(a);for(var e="",f=0;f<a.length;f++){var g=a.charCodeAt(f).toString(16);if(g.length<4)for(;g.length<4;)g="0".concat(g);e=e.concat(b+g)}return e.toLowerCase()},decode:function(a,b){if(0===a.length)return"";b=c.isUndefined(b)?"\\u":b,a=d.stringify(a);var e="",f=a.match(/([\w]+)|(\\u([\w]{4}))/g);return null!=f&&f.each(function(a,c){0==a.indexOf(b)?e+=String.fromCharCode(parseInt(a.slice(2,6),16)):e+=a}),e}}};return e}),define("src/time",["require","exports","src/core"],function(a,b,c){"use strict";var d={now:function(){return d.create()},create:function(a){return d.newTime(a)},shortIntervals:{y:"year",q:"quarter",M:"month",w:"week",d:"day",h:"hour",m:"minute",s:"second",ms:"msecond"},formatInterval:function(a){return d.shortIntervals[a]||a},diff:function(a,b,c){var e=d.newTime(a),f=d.newTime(b);return e.diff(d.formatInterval(c),f)},add:function(a,b,c){return d.newTime(a).add(d.formatInterval(b),c)},format:function(a,b){return d.create(a).toString(b)},ago:function(a,b){b=c.ext({minute:"分钟前",hour:"小时前",day:"天前"},b);var e=d.create(a),f=d.create();return e.diff("m",f)<1?"1"+b.minute:e.diff("m",f)<60?e.diff("m",f)+b.minute:e.diff("h",f)<24?e.diff("h",f)+b.hour:e.diff("d",f)<4?e.diff("d",f)+b.day:e.toString("yyyy-MM-dd HH:mm:ss")},newTime:function(a){var b=new Date;if(!c.isUndefined(a))if("date"===c.type(a))b=a;else if(c.isNumber(a))b=new Date(a);else if(c.isArray(a)){for(var e=a,f=0;f<6;f++)e[f]=isNaN(e[f])?f<3?1:0:Number(e[f]);b=new Date(e[0],Number(e[1])-1,e[2],e[3],e[4],e[5])}else if(/\/Date\((-?\d+)\)\//.test(a))b=new Date(Math.floor(a.replace(/\/Date\((-?\d+)\)\//,"$1")));else{for(var e=a.replace(/[-|:|\/| |年|月|日]/g,",").split(","),f=0;f<6;f++)e[f]=isNaN(e[f])?f<3?1:0:Number(e[f]);b=new Date(e[0],Number(e[1])-1,e[2],e[3],e[4],e[5])}return{year:b.getFullYear(),month:b.getMonth(),day:b.getDate(),hour:b.getHours(),minute:b.getMinutes(),second:b.getSeconds(),msecond:b.getMilliseconds(),weekDay:b.getDay(),diff:function(a,b){var c=Number(this.toDate()),e=Number(b.toDate());switch(a=d.formatInterval(a)){case"year":return b.year-this.year;case"quarter":return Math.ceil((12*(b.year-this.year)+(b.month-this.month))/3);case"month":return 12*(b.year-this.year)+(b.month-this.month);case"week":return Math.floor((e-c)/6048e5);case"day":return Math.floor((e-c)/864e5);case"hour":return Math.floor((e-c)/36e5);case"minute":return Math.floor((e-c)/6e4);case"second":return Math.floor((e-c)/1e3);case"msecond":return Math.floor(e-c)}},add:function(a,b){var c=Number(this.toDate()),e=0,f=[31,28,31,30,31,30,31,31,30,31,30,31];switch(a=d.formatInterval(a)){case"year":e=this.year%4!=0||this.year%100==0&&this.year%400!=0||1!=this.month||29!=this.day||(this.year+b)%4==0&&((this.year+b)%100!=0||(this.year+b)%400==0)?Number(new Date(this.year+b,this.month,this.day,this.hour,this.minute,this.second)):Number(new Date(this.year+b,this.month,28,this.hour,this.minute,this.second));break;case"quarter":e=this.year%4!=0||this.year%100==0&&this.year%400!=0||1!=this.month||29!=this.day||(this.year+Math.floor((this.month+3*b)/12))%4==0&&((this.year+Math.floor((this.month+3*b)/12))%100!=0||(this.year+Math.floor((this.month+3*b)/12))%400==0)?this.day==f[this.month]?Number(new Date(this.year,this.month+3*b,f[(this.month+3*b)%12],this.hour,this.minute,this.second)):Number(new Date(this.year,this.month+3*b,this.day,this.hour,this.minute,this.second)):Number(new Date(this.year,this.month+3*b,28,this.hour,this.minute,this.second));break;case"month":e=this.year%4!=0||this.year%100==0&&this.year%400!=0||1!=this.month||29!=this.day||(this.year+Math.floor((this.month+b)/12))%4==0&&((this.year+Math.floor((this.month+b)/12))%100!=0||(this.year+Math.floor((this.month+b)/12))%400==0)?this.day==f[this.month]?Number(new Date(this.year,this.month+b,f[(this.month+b)%12],this.hour,this.minute,this.second)):Number(new Date(this.year,this.month+b,this.day,this.hour,this.minute,this.second)):Number(new Date(this.year,this.month+b,28,this.hour,this.minute,this.second));break;case"week":e=c+6048e5*b;break;case"day":e=c+864e5*b;break;case"hour":e=c+36e5*b;break;case"minute":e=c+6e4*b;break;case"second":e=c+1e3*b;break;case"msecond":e=c+b}return d.create(new Date(e))},getDatePart:function(a){var b=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];switch(a=d.formatInterval(a)){case"year":return this.year;case"quarter":return this.getQuarterOfYear();case"month":return this.month;case"day":return this.day;case"week":return b[this.weekDay];case"W":case"weekOfYear":return this.getWeekOfYear();case"hour":return this.hour;case"minute":return this.minute;case"second":return this.second;default:return"Unkown Interval"}},getMaxDayOfMonth:function(){var a=d.create(this.toString("yyyy-MM-01")),b=d.create(this.add("month",1).toString("yyyy-MM-01"));return a.diff("day",b)},getQuarterOfYear:function(){return Math.ceil(this.month/3)},getWeekOfYear:function(){var a=0,b=this.getDayOfYear();return d.create(this.toString("yyyy-01-01")).weekDay>0&&(b-=7-d.create(this.toString("yyyy-01-01")).weekDay),b>0&&(a=Math.ceil(b/7)),a},getDayOfYear:function(){var a=this.toDate(),b=new Date(a.getFullYear(),0,1);return Math.ceil(Number(Number(a)-Number(b))/864e5)+1},isLeapYear:function(){return this.year%4==0&&(this.year%100!=0||this.year%400==0)},toArray:function(){return[this.year,this.month,this.day,this.hour,this.minute,this.second,this.msecond]},toDate:function(){return new Date(this.year,this.month,this.day,this.hour,this.minute,this.second)},toString:function(a){void 0===a&&(a="yyyy-MM-dd HH:mm:ss");var b=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"];return a.replace(/yyyy|YYYY/g,this.year).replace(/yy|YY/g,c.paddingZero(this.year2%100,2)).replace(/MM/g,c.paddingZero(this.month+1,2)).replace(/M/g,this.month+1).replace(/w|W/g,b[this.weekDay]).replace(/dd|DD/g,c.paddingZero(this.day,2)).replace(/d|D/g,this.day).replace(/hh|HH/g,c.paddingZero(this.hour,2)).replace(/h|H/g,this.hour).replace(/mm/g,c.paddingZero(this.minute,2)).replace(/m/g,this.minute).replace(/ss|SS/g,c.paddingZero(this.second,2)).replace(/s|S/g,this.second).replace(/fff/g,c.paddingZero(this.msecond,3))}}},newTimeSpan:function(a,b){return b=void 0===b?"second":b,"day"!=b&&"d"!=b||(a=24*a*60*60),"hour"!=b&&"h"!=b||(a=60*a*60),"minute"!=b&&"m"!=b||(a*=60),"second"!=b&&"s"!=b||(a*=1e3),{timeSpanValue:a,day:a/864e5,hour:a/36e5,minute:a/6e4,second:a/1e3,millisecond:a%1e3,toString:function(a){var b="";switch(a){case"MM天dd小时mm分钟ss秒fff毫秒":b=c.paddingZero(this.day,2)+"天"+c.paddingZero(this.hour,2)+"小时"+c.paddingZero(this.minute,2)+"分钟"+c.paddingZero(this.second,2)+"秒"+c.paddingZero(this.millisecond,3)+"毫秒";break;case"MM天dd小时mm分钟ss秒":default:b=c.paddingZero(this.day,2)+"天"+c.paddingZero(this.hour,2)+"小时"+c.paddingZero(this.minute,2)+"分钟"+c.paddingZero(this.second,2)+"秒"}return b}}}};return d}),define("x",["require","exports","src/core","src/color","src/encoding","src/string","src/time"],function(a,b,c,d,e,f,g){"use strict";return c.ext(c,{color:d,encoding:e,string:f,time:g})});