//>>built
define("dstore/Csv",["dojo/_base/lang","dojo/_base/declare"],function(r,s){function t(d,k){var l={},b=d.length,a;for(a=0;a<b;a++)l[d[a]]=k[a];return l}var u=/^\s*"([\S\s]*)"\s*$/,v=/""/g,w=/"/g;return s(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(d){var k=[];d=d.split(this.newline);var l=this.fieldNames,b=0,a=[],f="",e="",g,h,c,m,n,p,q;n=0;c=d.length;a:for(;n<c;n++)if(r.trim(d[n])){g=d[n].split(this.delimiter);p=0;for(m=g.length;p<m;p++){h=g[p];q=-1;f+=e+h;for(e="";0<=
(q=h.indexOf('"',q+1));)b++;if(0===b%2){if(0<b)if(b=u.exec(f))a.push(b[1].replace(v,'"'));else{console.warn("Csv: discarding row with invalid value: "+f);a=[];f="";b=0;continue a}else a.push(this.trim||!l?r.trim(f):f);f="";b=0}else e=this.delimiter}0===b?(l?k.push(t(l,a)):l=this.fieldNames=a,a=[]):e=this.newline}return k},toCsv:function(d){return this.stringify(this.data,d)},stringify:function(d,k){k=k||{};var l=k.alwaysQuote,b=this.fieldNames,a=this.delimiter,f=this.newline,e="",g,h,c,m;for(g=-1;g<
d.length;g++){-1<g&&(e+=f);for(h=0;h<b.length;h++){c=0>g?b[h]:d[g][b[h]];if(null===c||void 0===c)c="";"string"!==typeof c&&(c=c.toString());m=l||0<=c.indexOf('"')||0<=c.indexOf(a);e+=(0<h?a:"")+(m?'"'+c.replace(w,'""')+'"':c)}}k.trailingNewline&&(e+=f);return e}})});